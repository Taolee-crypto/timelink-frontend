<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì—…ë¡œë“œ - TimeLink</title>
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', sans-serif;
  background: #f8f9fa;
  color: #1f2937;
  line-height: 1.5;
}

/* ë„¤ë¹„ê²Œì´ì…˜ */
.navbar {
  background: white;
  border-bottom: 1px solid #e5e7eb;
  padding: 0 24px;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 2px 4px rgba(0,0,0,0.02);
}

.logo {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 20px;
  font-weight: 800;
  color: #1f2937;
  text-decoration: none;
}

.logo-icon {
  width: 32px;
  height: 32px;
  background: #10b981;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 16px;
}

.logo span {
  color: #10b981;
}

.nav-right {
  display: flex;
  align-items: center;
  gap: 12px;
}

.balance {
  background: #f3f4f6;
  border-radius: 999px;
  padding: 6px 16px;
  display: flex;
  align-items: center;
  gap: 16px;
}

.balance-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
}

.balance-label {
  color: #6b7280;
  font-weight: 500;
}

.balance-value {
  font-weight: 700;
  color: #10b981;
  font-family: 'Inter', monospace;
}

.car-indicator {
  background: #f3f4f6;
  border-radius: 999px;
  padding: 6px 12px;
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 13px;
  font-weight: 500;
}

.car-indicator.on {
  background: #ffedd5;
  color: #f59e0b;
}

.avatar {
  width: 36px;
  height: 36px;
  background: #10b981;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  cursor: pointer;
  position: relative;
}

.dropdown {
  position: absolute;
  top: 100%;
  right: 0;
  margin-top: 8px;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
  width: 200px;
  display: none;
  z-index: 1000;
}

.dropdown.show {
  display: block;
}

.dropdown-item {
  padding: 12px 16px;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 14px;
}

.dropdown-item:hover {
  background: #f3f4f6;
}

.dropdown-item.danger {
  color: #ef4444;
}

.dropdown-item.danger:hover {
  background: #fee2e2;
}

/* íƒ­ ë©”ë‰´ */
.tabs {
  background: white;
  border-bottom: 1px solid #e5e7eb;
  padding: 0 24px;
  display: flex;
  gap: 4px;
  overflow-x: auto;
  position: sticky;
  top: 64px;
  z-index: 90;
}

.tab {
  padding: 12px 20px;
  font-size: 14px;
  font-weight: 600;
  color: #6b7280;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
  white-space: nowrap;
  text-decoration: none;
}

.tab:hover {
  color: #10b981;
}

.tab.active {
  color: #10b981;
  border-bottom-color: #10b981;
}

/* ë©”ì¸ ì»¨í…ì¸  */
.container {
  max-width: 800px;
  margin: 0 auto;
  padding: 24px;
}

/* ì¹´ë“œ */
.card {
  background: white;
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
  transition: all 0.2s;
  margin-bottom: 20px;
}

.card:hover {
  box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
}

/* ë²„íŠ¼ */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 10px 20px;
  border-radius: 999px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  border: none;
  text-decoration: none;
}

.btn-primary {
  background: #10b981;
  color: white;
  box-shadow: 0 4px 6px -1px rgba(16,185,129,0.2);
}

.btn-primary:hover {
  background: #059669;
  transform: translateY(-1px);
  box-shadow: 0 6px 8px -1px rgba(16,185,129,0.3);
}

.btn-outline {
  background: white;
  color: #1f2937;
  border: 1px solid #e5e7eb;
}

.btn-outline:hover {
  background: #f9fafb;
  border-color: #d1d5db;
}

.btn-sm {
  padding: 6px 14px;
  font-size: 13px;
}

.btn-block {
  width: 100%;
}

/* ê²€ìƒ‰ë°” */
.search-input {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  font-size: 14px;
  outline: none;
  transition: all 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #10b981;
  box-shadow: 0 0 0 3px rgba(16,185,129,0.1);
}

/* ì¹© */
.chip {
  display: inline-block;
  padding: 8px 12px;
  border-radius: 999px;
  border: 1px solid #e5e7eb;
  background: white;
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}

.chip:hover {
  background: #f3f4f6;
}

.chip.active {
  background: #10b981;
  color: white;
  border-color: #10b981;
}

/* ê·¸ë¦¬ë“œ */
.grid-4 {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-bottom: 20px;
}

.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 16px;
}

/* ë“œë¡­ì¡´ */
.dropzone {
  border: 2px dashed #e5e7eb;
  border-radius: 12px;
  padding: 40px;
  text-align: center;
  cursor: pointer;
  background: white;
  margin-bottom: 20px;
  transition: all 0.2s;
}

.dropzone:hover {
  border-color: #10b981;
  background: #f9fafb;
}

.dropzone-icon {
  font-size: 40px;
  margin-bottom: 12px;
}

.dropzone-title {
  font-weight: 600;
  margin-bottom: 4px;
}

.dropzone-sub {
  font-size: 13px;
  color: #6b7280;
}

/* íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° */
.file-preview {
  background: #f3f4f6;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.file-icon {
  font-size: 24px;
}

.file-name {
  font-weight: 600;
  flex: 1;
}

.file-size {
  font-size: 12px;
  color: #6b7280;
}

/* TL ì¶©ì „ ë°•ìŠ¤ */
.tl-box {
  background: #f3f4f6;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 20px;
}

.tl-header {
  font-weight: 600;
  margin-bottom: 12px;
}

.tl-input-group {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
}

.tl-input {
  flex: 1;
  padding: 10px;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  font-size: 14px;
}

.tl-balance {
  font-size: 13px;
}

.tl-balance span {
  font-weight: 700;
  color: #10b981;
  font-family: 'Inter', monospace;
}

/* ë°°ì§€ */
.badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 600;
  background: #d1fae5;
  color: #065f46;
}

/* ìœ í‹¸ë¦¬í‹° */
.hidden { display: none !important; }
.text-green { color: #10b981; }
.text-gray { color: #6b7280; }
.font-mono { font-family: 'Inter', monospace; }
.mb-4 { margin-bottom: 16px; }
.mt-4 { margin-top: 16px; }
.w-full { width: 100%; }
</style>
</head>
<body>
<!-- ë„¤ë¹„ê²Œì´ì…˜ -->
<nav class="navbar">
  <a href="index.html" class="logo">
    <div class="logo-icon">âš¡</div>
    <div>Time<span>Link</span></div>
  </a>
  
  <!-- ë¹„ë¡œê·¸ì¸ ìƒíƒœ -->
  <div class="nav-right" id="nav-guest">
    <a href="login.html" class="btn btn-outline btn-sm">ë¡œê·¸ì¸</a>
    <a href="signup.html" class="btn btn-primary btn-sm">ì‹œì‘í•˜ê¸° â†’</a>
  </div>
  
  <!-- ë¡œê·¸ì¸ ìƒíƒœ -->
  <div class="nav-right hidden" id="nav-auth">
    <div class="balance">
      <div class="balance-item">
        <span class="balance-label">TL</span>
        <span class="balance-value" id="balance-tl">10,000</span>
      </div>
      <div class="balance-item">
        <span class="balance-label">TLC</span>
        <span class="balance-value" id="balance-tlc">0.0000</span>
      </div>
    </div>
    <div class="car-indicator" id="car-indicator">
      <span>ğŸš—</span>
      <span id="car-status">Off</span>
    </div>
    <div class="avatar" onclick="toggleDropdown()">
      <span id="avatar-letter">D</span>
      <div class="dropdown" id="dropdown">
        <div class="dropdown-item" onclick="window.location.href='index.html'">ğŸ’° TL ì¶©ì „</div>
        <div class="dropdown-item" onclick="window.location.href='wallet.html'">ğŸ‘› ì§€ê°‘</div>
        <div class="dropdown-item" onclick="window.location.href='settings.html'">âš™ï¸ ì„¤ì •</div>
        <div class="dropdown-item danger" onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</div>
      </div>
    </div>
  </div>
</nav>

<!-- íƒ­ ë©”ë‰´ -->
<div class="tabs">
  <a href="index.html" class="tab">ğŸ›ï¸ SharePlace</a>
  <a href="index.html?tab=dashboard" class="tab">ğŸ“Š ëŒ€ì‹œë³´ë“œ</a>
  <a href="library.html" class="tab">ğŸ” ë¼ì´ë¸ŒëŸ¬ë¦¬</a>
  <a href="create.html" class="tab active">ğŸ“¤ ì—…ë¡œë“œ</a>
  <a href="player.html" class="tab">ğŸ¬ í”Œë ˆì´ì–´</a>
  <a href="radio.html" class="tab">â˜• ì¹´í˜ë°©ì†¡</a>
  <a href="car.html" class="tab">ğŸš— Car</a>
  <a href="ads.html" class="tab">ğŸ“£ ê´‘ê³ </a>
  <a href="wallet.html" class="tab">ğŸ‘› ì§€ê°‘</a>
</div>

<div class="container">
  <!-- AI ìŒì› ë“±ë¡ -->
  <div class="card">
    <div style="font-weight:700;font-size:20px;margin-bottom:8px">ğŸ¤– AI ìŒì› ë“±ë¡</div>
    <div style="color:#6b7280;margin-bottom:24px">ìœ ë£Œ êµ¬ë… AI í”Œë«í¼ì˜ ìƒì„± ìŒì›ì„ TL íŒŒì¼ë¡œ ë³€í™˜í•˜ì„¸ìš”</div>

    <div class="grid-4">
      <div class="chip active" onclick="selectAI('suno')">ğŸµ Suno</div>
      <div class="chip" onclick="selectAI('udio')">ğŸ¶ Udio</div>
      <div class="chip" onclick="selectAI('mubert')">ğŸŒŠ Mubert</div>
      <div class="chip" onclick="selectAI('aiva')">ğŸ» AIVA</div>
    </div>

    <div style="background:#f3f4f6;border-radius:12px;padding:20px;margin-bottom:20px">
      <div style="font-weight:600;margin-bottom:16px">ğŸ“‹ êµ¬ë… ì¸ì¦ â€” <span id="selected-ai">Suno</span></div>

      <div style="margin-bottom:16px">
        <label style="font-size:12px;font-weight:600;color:#6b7280;margin-bottom:4px;display:block">ìƒì„±ëœ ìŒì› URL *</label>
        <input type="text" class="search-input" id="ai-url" placeholder="https://suno.com/song/...">
      </div>

      <div style="margin-bottom:16px">
        <label style="font-size:12px;font-weight:600;color:#6b7280;margin-bottom:4px;display:block">ìŒì› ìƒì„± í™”ë©´ ìº¡ì²˜</label>
        <div class="dropzone" onclick="document.getElementById('ai-capture').click()">
          <div class="dropzone-icon">ğŸ“¸</div>
          <div class="dropzone-title">í´ë¦­í•˜ì—¬ ì´ë¯¸ì§€ ì—…ë¡œë“œ</div>
          <div class="dropzone-sub">ê³¡ ì œëª© Â· ìƒì„± ë‚ ì§œ Â· ê³„ì •ëª… í¬í•¨</div>
          <input type="file" id="ai-capture" accept="image/*" style="display:none" onchange="handleAICapture(this)">
        </div>
      </div>

      <div class="grid-2">
        <div>
          <label style="font-size:12px;font-weight:600;color:#6b7280;margin-bottom:4px;display:block">êµ¬ë… í”Œëœ</label>
          <select class="search-input" id="ai-plan">
            <option>Pro</option>
            <option>Premier</option>
            <option>Creator</option>
          </select>
        </div>
        <div>
          <label style="font-size:12px;font-weight:600;color:#6b7280;margin-bottom:4px;display:block">êµ¬ë… ì›”</label>
          <input type="month" class="search-input" id="ai-month">
        </div>
      </div>
    </div>

    <button class="btn btn-primary btn-block" onclick="verifyAI()">ğŸ” êµ¬ë… ì¸ì¦ ë° ìŒì› ê°€ì ¸ì˜¤ê¸°</button>
  </div>

  <!-- ì§ì ‘ ì—…ë¡œë“œ -->
  <div class="card">
    <div style="font-weight:700;font-size:20px;margin-bottom:20px">ğŸ“¤ ì§ì ‘ ì—…ë¡œë“œ</div>

    <div class="grid-2">
      <div class="chip active" style="padding:16px;text-align:center" onclick="selectUploadType('audio')">
        <div style="font-size:28px;margin-bottom:8px">ğŸµ</div>
        <div style="font-weight:600">TL3 Audio</div>
        <div style="font-size:12px;color:#6b7280">MP3, WAV, FLAC</div>
      </div>
      <div class="chip" style="padding:16px;text-align:center" onclick="selectUploadType('video')">
        <div style="font-size:28px;margin-bottom:8px">ğŸ¬</div>
        <div style="font-weight:600">TL4 Video</div>
        <div style="font-size:12px;color:#6b7280">MP4, MOV, WebM</div>
      </div>
    </div>

    <div class="dropzone" onclick="document.getElementById('file-input').click()" id="dropzone">
      <div class="dropzone-icon">ğŸ“‚</div>
      <div class="dropzone-title">ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ</div>
      <div class="dropzone-sub">ì˜¤ë””ì˜¤ Â· ì˜ìƒ Â· ìµœëŒ€ 500MB</div>
      <input type="file" id="file-input" accept="audio/*,video/*" style="display:none" onchange="handleFileSelect(this)">
    </div>

    <div id="file-preview" class="file-preview" style="display:none">
      <span class="file-icon" id="file-icon">ğŸµ</span>
      <div class="file-name" id="file-name"></div>
      <div class="file-size" id="file-size"></div>
      <button class="btn btn-outline btn-sm" onclick="clearFile()">âœ•</button>
    </div>

    <div style="margin-bottom:16px">
      <label style="font-size:12px;font-weight:600;color:#6b7280;margin-bottom:4px;display:block">ì œëª© *</label>
      <input type="text" class="search-input" id="upload-title" placeholder="íŠ¸ë™ / ì˜ìƒ ì œëª©">
    </div>

    <div style="margin-bottom:16px">
      <label style="font-size:12px;font-weight:600;color:#6b7280;margin-bottom:4px;display:block">ì¹´í…Œê³ ë¦¬</label>
      <select class="search-input" id="upload-category">
        <optgroup label="ğŸµ ìŒì•…">
          <option value="K-POP">K-POP</option>
          <option value="Electronic">Electronic</option>
          <option value="Hip-Hop">Hip-Hop</option>
          <option value="Jazz">Jazz</option>
        </optgroup>
        <optgroup label="ğŸ¬ ì˜ìƒ">
          <option value="MV">ë®¤ì§ë¹„ë””ì˜¤</option>
          <option value="Lecture">ê°•ì˜</option>
        </optgroup>
      </select>
    </div>

    <div class="tl-box">
      <div class="tl-header">ğŸ’° íŒŒì¼ì— TL ì¶©ì „</div>
      <div class="tl-input-group">
        <input type="number" class="tl-input" id="file-tl" value="1000" min="100">
        <button class="btn btn-outline btn-sm" onclick="document.getElementById('file-tl').value=500">500</button>
        <button class="btn btn-outline btn-sm" onclick="document.getElementById('file-tl').value=1000">1K</button>
        <button class="btn btn-outline btn-sm" onclick="document.getElementById('file-tl').value=5000">5K</button>
      </div>
      <div class="tl-balance">ë‚´ ì”ê³ : <span id="my-tl">10,000</span> TL</div>
    </div>

    <button class="btn btn-primary btn-block" id="upload-btn" onclick="doUpload()" disabled>íŒŒì¼ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</button>
  </div>
</div>

<script>
// =================== ì „ì—­ ìƒíƒœ ===================
const state = {
  user: null,
  wallet: { tl: 10000 },
  myFiles: JSON.parse(localStorage.getItem('tl_myfiles') || '[]')
};

let selectedAI = 'suno';
let uploadType = 'audio';
let selectedFile = null;

// =================== ìœ í‹¸ë¦¬í‹° ===================
function $(id) { return document.getElementById(id); }
function formatNumber(n) { return Math.floor(n).toLocaleString(); }
function showToast(msg, type = 'info') { alert(msg); }

// =================== ì‚¬ìš©ì ì¸ì¦ ===================
function loadUser() {
  state.user = JSON.parse(localStorage.getItem('tl_user') || 'null');
  if (state.user) {
    state.wallet.tl = state.user.tl || 10000;
    
    $('nav-guest').classList.add('hidden');
    $('nav-auth').classList.remove('hidden');
    $('avatar-letter').textContent = state.user.username?.charAt(0).toUpperCase() || 'D';
    
    updateBalances();
  } else {
    state.user = { username: 'Demo', email: 'demo@timelink.digital', tl: 10000 };
    localStorage.setItem('tl_user', JSON.stringify(state.user));
    loadUser();
  }
}

function updateBalances() {
  $('balance-tl').textContent = formatNumber(state.wallet.tl);
  $('my-tl').textContent = formatNumber(state.wallet.tl);
}

function toggleDropdown() {
  $('dropdown').classList.toggle('show');
}

document.addEventListener('click', (e) => {
  if (!e.target.closest('.avatar')) {
    $('dropdown').classList.remove('show');
  }
});

function logout() {
  localStorage.removeItem('tl_token');
  localStorage.removeItem('tl_user');
  window.location.href = 'login.html';
}

// =================== Car Mode ===================
function toggleCar() {
  const carMode = !state.carMode;
  state.carMode = carMode;
  $('car-status').textContent = carMode ? 'ON' : 'Off';
  $('car-indicator').className = 'car-indicator' + (carMode ? ' on' : '');
  localStorage.setItem('tl_car', carMode);
}

// =================== AI ì—…ë¡œë“œ ===================
function selectAI(ai) {
  selectedAI = ai;
  document.querySelectorAll('[onclick*="selectAI"]').forEach(el => el.classList.remove('active'));
  event.target.classList.add('active');
  $('selected-ai').textContent = ai.charAt(0).toUpperCase() + ai.slice(1);
}

function handleAICapture(input) {
  if (input.files[0]) {
    showToast('ìº¡ì²˜ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì™„ë£Œ', 'success');
  }
}

function verifyAI() {
  const url = $('ai-url').value.trim();
  if (!url) { showToast('ìŒì› URLì„ ì…ë ¥í•˜ì„¸ìš”', 'error'); return; }
  
  showToast('AI ì¸ì¦ ì„±ê³µ! ìŒì›ì„ ë³€í™˜í•©ë‹ˆë‹¤', 'success');
  
  const newFile = {
    id: 'ai_' + Date.now(),
    title: 'AI Generated Track',
    artist: state.user.username,
    genre: 'Electronic',
    type: 'audio',
    fileTL: 1000,
    maxFileTL: 1000,
    pulse: 0,
    source: selectedAI,
    url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3',
    shared: false,
    createdAt: Date.now()
  };
  
  state.myFiles.unshift(newFile);
  localStorage.setItem('tl_myfiles', JSON.stringify(state.myFiles));
  
  state.wallet.tl += 1000;
  state.user.tl = state.wallet.tl;
  localStorage.setItem('tl_user', JSON.stringify(state.user));
  updateBalances();
  
  showToast('âœ… AI ìŒì› ë³€í™˜ ì™„ë£Œ! +1,000 TL ë³´ìƒ', 'success');
  setTimeout(() => window.location.href = 'library.html', 1000);
}

// =================== ì§ì ‘ ì—…ë¡œë“œ ===================
function selectUploadType(type) {
  uploadType = type;
  document.querySelectorAll('[onclick*="selectUploadType"]').forEach(el => el.classList.remove('active'));
  event.target.classList.add('active');
}

function handleFileSelect(input) {
  const file = input.files[0];
  if (!file) return;
  if (file.size > 500 * 1024 * 1024) {
    showToast('500MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤', 'error');
    return;
  }
  
  selectedFile = file;
  $('file-icon').textContent = file.type.startsWith('video/') ? 'ğŸ¬' : 'ğŸµ';
  $('file-name').textContent = file.name;
  $('file-size').textContent = (file.size / 1024 / 1024).toFixed(1) + ' MB';
  $('file-preview').style.display = 'flex';
  $('dropzone').style.display = 'none';
  $('upload-btn').disabled = false;
  $('upload-btn').textContent = 'ì—…ë¡œë“œí•˜ê¸°';
}

function clearFile() {
  selectedFile = null;
  $('file-preview').style.display = 'none';
  $('dropzone').style.display = 'block';
  $('upload-btn').disabled = true;
  $('upload-btn').textContent = 'íŒŒì¼ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”';
  $('file-input').value = '';
}

function doUpload() {
  if (!selectedFile) { showToast('íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”', 'error'); return; }
  
  const title = $('upload-title').value.trim();
  if (!title) { showToast('ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”', 'error'); return; }
  
  const fileTL = parseInt($('file-tl').value) || 1000;
  if (fileTL > state.wallet.tl) { showToast('ì”ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤', 'error'); return; }
  
  const newFile = {
    id: 'local_' + Date.now(),
    title: title,
    artist: state.user.username || 'ë‚˜',
    genre: $('upload-category').value,
    type: uploadType,
    fileTL: fileTL,
    maxFileTL: fileTL,
    pulse: 0,
    url: URL.createObjectURL(selectedFile),
    shared: false,
    createdAt: Date.now()
  };
  
  state.myFiles.unshift(newFile);
  localStorage.setItem('tl_myfiles', JSON.stringify(state.myFiles));
  
  state.wallet.tl -= fileTL;
  state.user.tl = state.wallet.tl;
  localStorage.setItem('tl_user', JSON.stringify(state.user));
  updateBalances();
  
  showToast('âœ… ì—…ë¡œë“œ ì™„ë£Œ!', 'success');
  window.location.href = 'library.html';
}

// =================== ì´ˆê¸°í™” ===================
loadUser();

// Car ëª¨ë“œ ìƒíƒœ ë™ê¸°í™”
state.carMode = localStorage.getItem('tl_car') === 'true';
$('car-status').textContent = state.carMode ? 'ON' : 'Off';
$('car-indicator').className = 'car-indicator' + (state.carMode ? ' on' : '');
</script>
</body>
</html>