<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì§€ê°‘ - TimeLink</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Inter', sans-serif; background: #f8f9fa; color: #1f2937; line-height: 1.5; }

/* ë„¤ë¹„ê²Œì´ì…˜ */
.navbar {
  background: white; border-bottom: 1px solid #e5e7eb; padding: 0 24px; height: 64px;
  display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 100;
}
.logo { display: flex; align-items: center; gap: 10px; font-size: 20px; font-weight: 800; color: #1f2937; text-decoration: none; }
.logo-icon { width: 32px; height: 32px; background: #10b981; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 16px; }
.logo span { color: #10b981; }
.nav-right { display: flex; align-items: center; gap: 12px; }
.balance {
  background: #f3f4f6; border-radius: 999px; padding: 6px 16px; display: flex; align-items: center; gap: 16px;
}
.balance-item { display: flex; align-items: center; gap: 6px; font-size: 14px; }
.balance-label { color: #6b7280; font-weight: 500; }
.balance-value { font-weight: 700; color: #10b981; font-family: monospace; }
.car-indicator {
  background: #f3f4f6; border-radius: 999px; padding: 6px 12px; display: flex; align-items: center; gap: 4px; font-size: 13px; font-weight: 500; cursor: pointer;
}
.car-indicator.on { background: #ffedd5; color: #f59e0b; }
.avatar {
  width: 36px; height: 36px; background: #10b981; border-radius: 50%;
  display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; cursor: pointer; position: relative;
}
.dropdown {
  position: absolute; top: 100%; right: 0; margin-top: 8px; background: white; border: 1px solid #e5e7eb; border-radius: 12px;
  box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); width: 200px; display: none; z-index: 1000;
}
.dropdown.show { display: block; }
.dropdown-item { padding: 12px 16px; cursor: pointer; font-size: 14px; color: #1f2937; text-decoration: none; display: block; }
.dropdown-item:hover { background: #f3f4f6; }
.dropdown-item.danger { color: #ef4444; }

/* íƒ­ ë©”ë‰´ */
.tabs {
  background: white; border-bottom: 1px solid #e5e7eb; padding: 0 24px; display: flex; gap: 4px;
  position: sticky; top: 64px; z-index: 90; overflow-x: auto;
}
.tab {
  padding: 12px 20px; font-size: 14px; font-weight: 600; color: #6b7280;
  cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s;
  white-space: nowrap; text-decoration: none;
}
.tab:hover { color: #10b981; }
.tab.active { color: #10b981; border-bottom-color: #10b981; }

/* ë²„íŠ¼ */
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
  padding: 10px 20px; border-radius: 999px; font-weight: 600; font-size: 14px;
  cursor: pointer; transition: all 0.2s; border: none; text-decoration: none;
}
.btn-primary { background: #10b981; color: white; }
.btn-primary:hover { background: #059669; }
.btn-outline { background: white; color: #1f2937; border: 1px solid #e5e7eb; }
.btn-outline:hover { background: #f9fafb; }
.btn-sm { padding: 6px 14px; }
.btn-block { width: 100%; }

/* ì €ì‘ê¶Œ ë°°ë„ˆ */
.creation-rights-banner {
  background: #e0f2fe; border: 1px solid #7dd3fc; border-radius: 12px;
  padding: 12px 20px; margin: 16px 24px; display: flex; align-items: center; gap: 16px;
}

/* í˜ì´ì§€ í‘¸í„° */
.page-footer {
  background: #f9fafb; border-top: 1px solid #e5e7eb; padding: 16px 24px;
  text-align: center; font-size: 12px; color: #6b7280; margin-top: 40px;
}
.footer-links { display: flex; justify-content: center; gap: 24px; margin-bottom: 8px; flex-wrap: wrap; }
.footer-links a { color: #4b5563; text-decoration: none; }
.footer-links a:hover { color: #10b981; }
.footer-links a:last-child { color: #ef4444; }

/* ë©”ì¸ ì»¨í…ì¸  */
.container { max-width: 800px; margin: 0 auto; padding: 24px; }
.card {
  background: white; border-radius: 16px; padding: 24px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
  margin-bottom: 20px;
}

/* ì”ê³  ì¹´ë“œ */
.balance-card {
  background: linear-gradient(135deg, #d1fae5, #ffffff); border-radius: 16px;
  padding: 24px; margin-bottom: 20px;
}
.balance-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;
}
.balance-box {
  background: white; border-radius: 12px; padding: 16px;
}
.balance-label { font-size: 12px; color: #6b7280; margin-bottom: 4px; }
.balance-amount { font-size: 28px; font-weight: 800; font-family: monospace; }
.balance-amount.green { color: #10b981; }
.balance-amount.purple { color: #8b5cf6; }

/* ìˆ˜ìµ í˜„í™© */
.earnings-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;
}
.earning-item {
  background: #f3f4f6; border-radius: 12px; padding: 16px;
}
.earning-label { font-size: 11px; color: #6b7280; text-transform: uppercase; margin-bottom: 4px; }
.earning-value { font-size: 16px; font-weight: 700; font-family: monospace; }
.earning-value.green { color: #10b981; }
.earning-value.orange { color: #f59e0b; }

/* í™˜ìœ¨ ì •ë³´ */
.rate-info {
  background: #e0f2fe; border-radius: 10px; padding: 12px; margin: 16px 0;
  display: flex; align-items: center; justify-content: space-between;
}
.rate-edit {
  display: flex; align-items: center; gap: 8px;
}
.rate-edit input {
  width: 80px; padding: 6px; border: 1px solid #7dd3fc; border-radius: 6px; text-align: center;
}

/* ê²°ì œ ë°©ë²• */
.payment-methods {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0;
}
.payment-method {
  border: 2px solid #e5e7eb; border-radius: 12px; padding: 16px; text-align: center; cursor: pointer;
  transition: all 0.2s;
}
.payment-method:hover { border-color: #fee500; }
.payment-method.selected { border-color: #10b981; background: #f0fdf4; }
.payment-method.kakao:hover { border-color: #fee500; }
.payment-method.naver:hover { border-color: #03c75a; }
.payment-method.bank:hover { border-color: #1428a0; }
.payment-icon { font-size: 32px; margin-bottom: 8px; }
.payment-name { font-weight: 600; font-size: 14px; }

/* ê³„ì¢Œ ì…ë ¥ */
.account-input {
  margin: 16px 0; padding: 16px; background: #f8fafc; border-radius: 12px; display: none;
}
.account-input.show { display: block; }
.account-field {
  margin-bottom: 12px;
}
.account-field label { display: block; font-size: 12px; font-weight: 600; color: #4b5563; margin-bottom: 4px; }
.account-field input, .account-field select {
  width: 100%; padding: 10px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px;
}

/* ê±°ë˜ ë‚´ì—­ */
.transaction-item {
  display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #e5e7eb;
}
.transaction-info { flex: 1; }
.transaction-title { font-weight: 600; font-size: 14px; margin-bottom: 2px; }
.transaction-meta { font-size: 12px; color: #6b7280; }
.transaction-amount { font-weight: 700; font-size: 16px; font-family: monospace; }
.transaction-amount.plus { color: #10b981; }
.transaction-amount.minus { color: #ef4444; }

/* ëª¨ë‹¬ */
.modal-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none;
  align-items: center; justify-content: center; z-index: 1000;
}
.modal-overlay.show { display: flex; }
.modal {
  background: white; border-radius: 24px; padding: 32px; width: 90%; max-width: 400px;
}
.modal-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; }
.modal-title { font-weight: 700; font-size: 18px; }
.modal-close { background: none; border: none; font-size: 20px; cursor: pointer; color: #6b7280; }

.hidden { display: none !important; }
.text-green { color: #10b981; }
</style>
</head>
<body>
<div class="creation-rights-banner">
  <div style="font-size: 22px;">ğŸ¨</div>
  <div style="flex: 1;">
    <div style="font-weight: 700; margin-bottom: 2px;">ì°½ì‘ê¶Œ ë³´í˜¸ ì •ì±…</div>
    <div style="font-size: 12px;">ëª¨ë“  íŒŒì¼ì˜ ì°½ì‘ê¶Œì€ ì°½ì‘ìì—ê²Œ ìˆìŠµë‹ˆë‹¤.</div>
  </div>
  <a href="#" style="color: #0284c7; font-weight: 600;">ìì„¸íˆ</a>
</div>

<nav class="navbar">
  <a href="index.html" class="logo"><div class="logo-icon">âš¡</div><div>Time<span>Link</span></div></a>
  <div class="nav-right" id="nav-guest">
    <a href="login.html" class="btn btn-outline btn-sm">ë¡œê·¸ì¸</a>
    <a href="signup.html" class="btn btn-primary btn-sm">ì‹œì‘í•˜ê¸° â†’</a>
  </div>
  <div class="nav-right hidden" id="nav-auth">
    <div class="balance">
      <div class="balance-item"><span class="balance-label">TL</span><span class="balance-value" id="balance-tl">10,000</span></div>
      <div class="balance-item"><span class="balance-label">TLC</span><span class="balance-value" id="balance-tlc">0.0000</span></div>
    </div>
    <div class="car-indicator" id="car-indicator" onclick="window.location.href='car.html'">
      <span>ğŸš—</span><span id="car-status">Off</span>
    </div>
    <div class="avatar" onclick="toggleDropdown()">
      <span id="avatar-letter">U</span>
      <div class="dropdown" id="dropdown">
        <a href="wallet.html" class="dropdown-item">ğŸ‘› ë‚´ ì§€ê°‘</a>
        <a href="library.html" class="dropdown-item">ğŸ” ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬</a>
        <a href="create.html" class="dropdown-item">ğŸ“¤ ì—…ë¡œë“œ</a>
        <a href="settings.html" class="dropdown-item">âš™ï¸ ì„¤ì •</a>
        <div class="dropdown-item danger" onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</div>
      </div>
    </div>
  </div>
</nav>

<div class="tabs">
  <a href="index.html" class="tab">ğŸ  í™ˆ</a>
  <a href="shareplace.html" class="tab">ğŸ›ï¸ SharePlace</a>
  <a href="library.html" class="tab">ğŸ” ë¼ì´ë¸ŒëŸ¬ë¦¬</a>
  <a href="create.html" class="tab">ğŸ“¤ ì—…ë¡œë“œ</a>
  <a href="player.html" class="tab">ğŸ¬ í”Œë ˆì´ì–´</a>
  <a href="radio.html" class="tab">â˜• ì¹´í˜ë°©ì†¡</a>
  <a href="car.html" class="tab">ğŸš— Car</a>
  <a href="ads.html" class="tab">ğŸ“£ ê´‘ê³ </a>
  <a href="wallet.html" class="tab active">ğŸ‘› ì§€ê°‘</a>
</div>

<div class="container">
  <!-- ì”ê³  ì¹´ë“œ -->
  <div class="balance-card">
    <div style="font-size: 12px; font-weight: 600; color: #10b981; letter-spacing: 1px; margin-bottom: 12px;">MY WALLET</div>
    <div class="balance-grid">
      <div class="balance-box">
        <div class="balance-label">TL ì”ê³ </div>
        <div class="balance-amount green" id="wallet-tl">10,000</div>
      </div>
      <div class="balance-box">
        <div class="balance-label">TLC ì”ê³ </div>
        <div class="balance-amount purple" id="wallet-tlc">0.0000</div>
      </div>
    </div>
    <div style="display: flex; gap: 8px;">
      <button class="btn btn-primary btn-sm" onclick="openModal('recharge-modal')">+ TL ì¶©ì „</button>
      <button class="btn btn-outline btn-sm" onclick="openExchange()">ğŸ’± í™˜ì „í•˜ê¸°</button>
    </div>
  </div>

  <!-- ìˆ˜ìµ í˜„í™© -->
  <div class="card">
    <div style="font-weight: 700; margin-bottom: 16px;">ğŸ’° ìˆ˜ìµ í˜„í™©</div>
    <div class="earnings-grid">
      <div class="earning-item"><div class="earning-label">ì´ ìˆ˜ìµ</div><div class="earning-value green" id="total-earned">3,200 TL</div></div>
      <div class="earning-item"><div class="earning-label">ëˆ„ì  í™˜ì „</div><div class="earning-value orange" id="total-exchanged">0 TL</div></div>
      <div class="earning-item"><div class="earning-label">í™˜ì „ ê°€ëŠ¥</div><div class="earning-value green" id="exchangeable">1,600 TL</div></div>
      <div class="earning-item"><div class="earning-label">ì „í™˜ìœ¨</div><div class="earning-value" id="exchange-rate">1 TL = 10ì›</div></div>
    </div>
  </div>

  <!-- í™˜ì „ ì„¹ì…˜ (ì²˜ìŒì—” ìˆ¨ê¹€) -->
  <div id="exchange-section" class="card" style="display: none;">
    <div style="font-weight: 700; font-size: 18px; margin-bottom: 16px;">ğŸ’± TL í™˜ì „í•˜ê¸°</div>
    
    <!-- í™˜ìœ¨ ì •ë³´ (ìˆ˜ì • ê°€ëŠ¥) -->
    <div class="rate-info">
      <div><strong>í˜„ì¬ í™˜ìœ¨</strong> <span id="display-rate">1 TL = 10ì›</span></div>
      <div class="rate-edit">
        <input type="number" id="rate-input" value="10" min="1" step="0.1" style="width: 70px;"> ì›/TL
        <button class="btn btn-sm btn-outline" onclick="updateRate()">ì ìš©</button>
      </div>
    </div>

    <!-- ê²°ì œ ë°©ë²• ì„ íƒ -->
    <div style="font-weight: 600; margin-bottom: 12px;">ê²°ì œ ë°©ë²• ì„ íƒ</div>
    <div class="payment-methods">
      <div class="payment-method kakao" onclick="selectPayment('kakao')">
        <div class="payment-icon">ğŸ’›</div>
        <div class="payment-name">ì¹´ì¹´ì˜¤í˜ì´</div>
      </div>
      <div class="payment-method naver" onclick="selectPayment('naver')">
        <div class="payment-icon">ğŸ’š</div>
        <div class="payment-name">ë„¤ì´ë²„í˜ì´</div>
      </div>
      <div class="payment-method bank" onclick="selectPayment('bank')">
        <div class="payment-icon">ğŸ¦</div>
        <div class="payment-name">ê³„ì¢Œì´ì²´</div>
      </div>
    </div>

    <!-- ê³„ì¢Œ ì…ë ¥ í•„ë“œ (ê³„ì¢Œì´ì²´ ì„ íƒì‹œ) -->
    <div id="bank-account" class="account-input">
      <div class="account-field">
        <label>ì€í–‰ ì„ íƒ</label>
        <select id="bank-select">
          <option>êµ­ë¯¼ì€í–‰</option>
          <option>ì‹ í•œì€í–‰</option>
          <option>ìš°ë¦¬ì€í–‰</option>
          <option>í•˜ë‚˜ì€í–‰</option>
          <option>ë†í˜‘</option>
          <option>ì¹´ì¹´ì˜¤ë±…í¬</option>
          <option>í† ìŠ¤ë±…í¬</option>
        </select>
      </div>
      <div class="account-field">
        <label>ê³„ì¢Œë²ˆí˜¸</label>
        <input type="text" id="account-number" placeholder="'-' ì—†ì´ ì…ë ¥">
      </div>
      <div class="account-field">
        <label>ì˜ˆê¸ˆì£¼</label>
        <input type="text" id="account-holder" placeholder="ì˜ˆê¸ˆì£¼ëª…">
      </div>
    </div>

    <!-- í™˜ì „ ê¸ˆì•¡ ì…ë ¥ -->
    <div style="margin: 20px 0;">
      <label style="display: block; font-weight: 600; margin-bottom: 8px;">í™˜ì „í•  TL</label>
      <div style="display: flex; gap: 10px; align-items: center;">
        <input type="number" id="exchange-amount" value="1000" min="100" step="100" style="flex: 1; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px;">
        <span>TL</span>
      </div>
      <div style="margin-top: 8px; text-align: right; font-size: 14px;">
        ì˜ˆìƒ ìˆ˜ë ¹ì•¡: <strong id="expected-amount">10,000ì›</strong>
      </div>
    </div>

    <button class="btn btn-primary btn-block" onclick="processExchange()">í™˜ì „ ìš”ì²­í•˜ê¸°</button>
  </div>

  <!-- ê±°ë˜ ë‚´ì—­ -->
  <div class="card">
    <div style="font-weight: 700; margin-bottom: 16px;">ğŸ“‹ ê±°ë˜ ë‚´ì—­</div>
    <div id="transaction-list">
      <!-- ë™ì  ìƒì„± -->
    </div>
  </div>
</div>

<!-- ì¶©ì „ ëª¨ë‹¬ -->
<div id="recharge-modal" class="modal-overlay">
  <div class="modal">
    <div class="modal-header"><div class="modal-title">ğŸ’° TL ì¶©ì „</div><button class="modal-close" onclick="closeModal('recharge-modal')">âœ•</button></div>
    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
      <button class="btn btn-outline btn-sm" onclick="document.getElementById('recharge-amount').value=1000">1,000</button>
      <button class="btn btn-outline btn-sm" onclick="document.getElementById('recharge-amount').value=5000">5,000</button>
      <button class="btn btn-outline btn-sm" onclick="document.getElementById('recharge-amount').value=10000">10,000</button>
    </div>
    <input type="number" id="recharge-amount" value="1000" style="width:100%; padding:12px; border:1px solid #e5e7eb; border-radius:8px; margin-bottom:16px;">
    <button class="btn btn-primary btn-block" onclick="doRecharge()">ì¶©ì „í•˜ê¸°</button>
  </div>
</div>

<footer class="page-footer">
  <div class="footer-links">
    <a href="#">ì €ì‘ê¶Œ ì •ì±…</a>
    <a href="#">ì´ìš©ì•½ê´€</a>
    <a href="#">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
    <a href="#">ì €ì‘ê¶Œ ì¹¨í•´ ì‹ ê³ </a>
  </div>
  <div>âš–ï¸ ëª¨ë“  ë¯¸ì¸ì¦ íŒŒì¼ì˜ ë²•ì  ì±…ì„ì€ ì—…ë¡œë”ì—ê²Œ 100% ìˆìŠµë‹ˆë‹¤.</div>
</footer>

<script>
let currentUser = JSON.parse(localStorage.getItem('tl_user') || 'null');
let carMode = localStorage.getItem('tl_car') === 'true';

// í™˜ì „ ê´€ë ¨ ìƒíƒœ
let exchangeRate = 10; // 1 TL = 10ì› (ê¸°ë³¸ê°’)
let selectedPayment = null;
let exchangeHistory = JSON.parse(localStorage.getItem('exchange_history') || '[]');

function updateNavbar() {
  const navAuth = document.getElementById('nav-auth');
  const navGuest = document.getElementById('nav-guest');
  const balanceTl = document.getElementById('balance-tl');
  const balanceTlc = document.getElementById('balance-tlc');
  const avatarLetter = document.getElementById('avatar-letter');
  const carStatus = document.getElementById('car-status');
  const carIndicator = document.getElementById('car-indicator');

  if (currentUser) {
    navAuth.classList.remove('hidden');
    navGuest.classList.add('hidden');
    if (balanceTl) balanceTl.textContent = Math.floor(currentUser.tl || 0).toLocaleString();
    if (balanceTlc) balanceTlc.textContent = (currentUser.tlc || 0).toFixed(4);
    if (avatarLetter) avatarLetter.textContent = (currentUser.username || 'U').charAt(0).toUpperCase();
    
    // ì§€ê°‘ ì—…ë°ì´íŠ¸
    document.getElementById('wallet-tl').textContent = Math.floor(currentUser.tl || 0).toLocaleString();
    document.getElementById('wallet-tlc').textContent = (currentUser.tlc || 0).toFixed(4);
  } else {
    navAuth.classList.add('hidden');
    navGuest.classList.remove('hidden');
  }
  
  if (carStatus) carStatus.textContent = carMode ? 'ON' : 'Off';
  if (carIndicator) carIndicator.className = 'car-indicator' + (carMode ? ' on' : '');
}

function toggleDropdown() {
  document.getElementById('dropdown').classList.toggle('show');
}

document.addEventListener('click', (e) => {
  if (!e.target.closest('.avatar')) {
    document.getElementById('dropdown').classList.remove('show');
  }
});

function logout() {
  localStorage.removeItem('tl_user');
  window.location.href = 'index.html';
}

// í™˜ì „ ì„¹ì…˜ ì—´ê¸°
function openExchange() {
  document.getElementById('exchange-section').style.display = 'block';
  document.getElementById('display-rate').textContent = `1 TL = ${exchangeRate}ì›`;
  document.getElementById('rate-input').value = exchangeRate;
  updateExpectedAmount();
}

// í™˜ìœ¨ ì—…ë°ì´íŠ¸
function updateRate() {
  const newRate = parseFloat(document.getElementById('rate-input').value);
  if (newRate > 0) {
    exchangeRate = newRate;
    document.getElementById('display-rate').textContent = `1 TL = ${exchangeRate}ì›`;
    updateExpectedAmount();
  }
}

// ê²°ì œ ë°©ë²• ì„ íƒ
function selectPayment(method) {
  selectedPayment = method;
  document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
  event.target.closest('.payment-method').classList.add('selected');
  
  // ê³„ì¢Œ ì…ë ¥ í•„ë“œ í‘œì‹œ/ìˆ¨ê¹€
  document.getElementById('bank-account').classList.toggle('show', method === 'bank');
}

// ì˜ˆìƒ ìˆ˜ë ¹ì•¡ ê³„ì‚°
function updateExpectedAmount() {
  const amount = parseFloat(document.getElementById('exchange-amount').value) || 0;
  const expected = amount * exchangeRate;
  document.getElementById('expected-amount').textContent = expected.toLocaleString() + 'ì›';
}

// í™˜ì „ ê¸ˆì•¡ ë³€ê²½ì‹œ ì˜ˆìƒì•¡ ì—…ë°ì´íŠ¸
document.getElementById('exchange-amount')?.addEventListener('input', updateExpectedAmount);

// í™˜ì „ ì²˜ë¦¬
function processExchange() {
  if (!currentUser) {
    alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
    return;
  }
  
  if (!selectedPayment) {
    alert('ê²°ì œ ë°©ë²•ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
    return;
  }
  
  const amount = parseFloat(document.getElementById('exchange-amount').value);
  if (amount < 100) {
    alert('ìµœì†Œ 100 TL ì´ìƒ í™˜ì „ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
    return;
  }
  
  if (amount > currentUser.tl) {
    alert('ì”ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.');
    return;
  }
  
  // ê³„ì¢Œì´ì²´ì¸ ê²½ìš° ê³„ì¢Œ ì •ë³´ í™•ì¸
  if (selectedPayment === 'bank') {
    const accountNum = document.getElementById('account-number').value;
    const accountHolder = document.getElementById('account-holder').value;
    if (!accountNum || !accountHolder) {
      alert('ê³„ì¢Œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
  }
  
  // í™˜ì „ ì²˜ë¦¬
  const paymentNames = {
    kakao: 'ì¹´ì¹´ì˜¤í˜ì´',
    naver: 'ë„¤ì´ë²„í˜ì´',
    bank: 'ê³„ì¢Œì´ì²´'
  };
  
  const received = amount * exchangeRate;
  
  // TL ì°¨ê°
  currentUser.tl -= amount;
  localStorage.setItem('tl_user', JSON.stringify(currentUser));
  
  // ê±°ë˜ ë‚´ì—­ ì¶”ê°€
  const transaction = {
    id: Date.now(),
    type: 'exchange',
    title: `${paymentNames[selectedPayment]} í™˜ì „`,
    amount: -amount,
    received: received,
    rate: exchangeRate,
    date: new Date().toLocaleDateString('ko-KR')
  };
  
  exchangeHistory.unshift(transaction);
  localStorage.setItem('exchange_history', JSON.stringify(exchangeHistory));
  
  // UI ì—…ë°ì´íŠ¸
  updateNavbar();
  renderTransactions();
  
  // í™˜ì „ ì™„ë£Œ ë©”ì‹œì§€
  alert(`âœ… í™˜ì „ ì™„ë£Œ!\n${amount} TL â†’ ${received.toLocaleString()}ì›\n(${paymentNames[selectedPayment]}ë¡œ ì…ê¸ˆë©ë‹ˆë‹¤)`);
  
  // í™˜ì „ ì„¹ì…˜ ë‹«ê¸°
  document.getElementById('exchange-section').style.display = 'none';
}

// ê±°ë˜ ë‚´ì—­ ë Œë”ë§
function renderTransactions() {
  const list = document.getElementById('transaction-list');
  
  if (exchangeHistory.length === 0) {
    list.innerHTML = '<div style="text-align:center; padding:24px; color:#6b7280;">ê±°ë˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</div>';
    return;
  }
  
  list.innerHTML = exchangeHistory.map(t => `
    <div class="transaction-item">
      <div class="transaction-info">
        <div class="transaction-title">${t.title}</div>
        <div class="transaction-meta">${t.date} Â· 1 TL = ${t.rate}ì›</div>
      </div>
      <div class="transaction-amount minus">-${t.amount.toLocaleString()} TL</div>
    </div>
  `).join('');
}

// ì¶©ì „
function openModal(id) { document.getElementById(id).classList.add('show'); }
function closeModal(id) { document.getElementById(id).classList.remove('show'); }

function doRecharge() {
  const amount = parseInt(document.getElementById('recharge-amount').value) || 0;
  if (amount <= 0) { alert('ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”'); return; }
  
  currentUser.tl += amount;
  localStorage.setItem('tl_user', JSON.stringify(currentUser));
  updateNavbar();
  closeModal('recharge-modal');
  alert(`ğŸ’° ${amount.toLocaleString()} TL ì¶©ì „ ì™„ë£Œ!`);
}

// ì´ˆê¸°í™”
updateNavbar();
renderTransactions();

// ì˜ˆìƒ ê¸ˆì•¡ ì´ˆê¸°í™”
updateExpectedAmount();
</script>
</body>
</html>