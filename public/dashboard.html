<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë‚´ ëŒ€ì‹œë³´ë“œ - TimeLink</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Inter',sans-serif; background:#f8fafc; color:#0f172a; }
.navbar { background:white; border-bottom:1px solid #e2e8f0; padding:0 24px; height:64px; display:flex; align-items:center; justify-content:space-between; }
.logo { display:flex; align-items:center; gap:10px; font-size:20px; font-weight:800; text-decoration:none; color:#0f172a; }
.logo-icon { width:32px; height:32px; background:#8b5cf6; border-radius:8px; display:flex; align-items:center; justify-content:center; color:white; }
.tabs { background:white; border-bottom:1px solid #e2e8f0; padding:0 24px; display:flex; justify-content:center; gap:4px; }
.tab { padding:12px 20px; font-size:14px; font-weight:600; color:#6b7280; text-decoration:none; border-bottom:2px solid transparent; }
.tab:hover { color:#8b5cf6; }
.tab.active { color:#8b5cf6; border-bottom-color:#8b5cf6; }
.container { max-width:1200px; margin:0 auto; padding:40px 24px; }
.poc-card { background:white; border-radius:20px; padding:24px; margin-bottom:24px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1); display:flex; align-items:center; justify-content:space-between; }
.poc-score { font-size:48px; font-weight:800; color:#8b5cf6; }
.chart-row { display:grid; grid-template-columns:1fr 1fr; gap:24px; margin-bottom:40px; }
.chart-container { background:white; border-radius:20px; padding:24px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1); }
.ranking-section { background:white; border-radius:20px; padding:24px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1); }
.ranking-tabs { display:flex; gap:8px; margin:20px 0; }
.rank-tab { padding:8px 16px; border-radius:999px; border:1px solid #e2e8f0; background:white; cursor:pointer; }
.rank-tab.active { background:#8b5cf6; color:white; border-color:#8b5cf6; }
.ranking-table { width:100%; border-collapse:collapse; }
.ranking-table th { text-align:left; padding:12px; background:#f1f5f9; }
.ranking-table td { padding:12px; border-bottom:1px solid #f1f5f9; }
.page-footer { background:#f9fafb; border-top:1px solid #e5e7eb; padding:40px 24px; text-align:center; }
</style>
  <script src="/activity.js"></script>`n</head>
<body>

<nav class="navbar">
  <a href="index.html" class="logo"><div class="logo-icon">âš¡</div><div>Time<span>Link</span></div></a>
  <div class="nav-right"></div>
</nav>

<div class="tabs">
  <a href="index.html" class="tab">ğŸ  í™ˆ</a>
  <a href="shareplace.html" class="tab">ğŸ›ï¸ SharePlace</a>
  <a href="library.html" class="tab">ğŸ” ë¼ì´ë¸ŒëŸ¬ë¦¬</a>
  <a href="create.html" class="tab">ğŸ“¤ ì—…ë¡œë“œ</a>
  <a href="player.html" class="tab">ğŸ¬ í”Œë ˆì´ì–´</a>
  <a href="radio.html" class="tab">â˜• ì¹´í˜ë°©ì†¡</a>
  <a href="wallet.html" class="tab">ğŸ‘› ì§€ê°‘</a>
  <a href="dashboard.html" class="tab active">ğŸ“Š ëŒ€ì‹œë³´ë“œ</a>
</div>

<div class="container">
  <h1 style="margin-bottom:32px;">ğŸ“Š ë‚´ ëŒ€ì‹œë³´ë“œ</h1>
  
  <div class="poc-card">
    <div>
      <h3 style="margin-bottom:8px;">âš¡ ê¸°ì—¬ë„ ì ìˆ˜ (POC)</h3>
      <div style="color:#64748b;">ëˆ„ì  í™œë™ ì ìˆ˜ (ë§ˆì´ë„ˆìŠ¤ ê°€ëŠ¥)</div>
    </div>
    <div class="poc-score" id="poc-score">0</div>
  </div>

  <div class="chart-row">
    <div class="chart-container">
      <h4 style="margin-bottom:16px;">ğŸ“ˆ ì¼ë³„ TLC ì±„êµ´ëŸ‰</h4>
      <canvas id="tlcChart" height="200"></canvas>
    </div>
    <div class="chart-container">
      <h4 style="margin-bottom:16px;">ğŸ“Š ì£¼ê°„ TL ì‚¬ìš©ëŸ‰</h4>
      <canvas id="tlChart" height="200"></canvas>
    </div>
  </div>

  <div class="ranking-section">
    <h3>ğŸ† ì£¼ê°„ ë­í‚¹</h3>
    <div class="ranking-tabs">
      <button class="rank-tab active" onclick="loadRanking('tlc', this)">TLC ì±„êµ´</button>
      <button class="rank-tab" onclick="loadRanking('points', this)">ê¸°ì—¬ë„</button>
    </div>
    <table class="ranking-table">
      <thead><tr><th>ìˆœìœ„</th><th>ì‚¬ìš©ì</th><th>ê°’</th></tr></thead>
      <tbody id="ranking-body"></tbody>
    </table>
  </div>
</div>

<footer class="page-footer">
  <div>âš–ï¸ ëª¨ë“  ì €ì‘ê¶Œì€ ì°½ì‘ìì—ê²Œ ìˆìŠµë‹ˆë‹¤.</div>
</footer>

<script>
const API_BASE = 'https://timelink-api.mununglee.workers.dev';
let user = JSON.parse(localStorage.getItem('tl_user') || 'null');
if (!user) location.href = 'login.html';

async function loadPOC() {
  const res = await fetch(`${API_BASE}/api/user-stats?user_id=${user.id}&period=month`);
  const data = await res.json();
  document.getElementById('poc-score').textContent = data.total_points;
}

function loadCharts() {
  // ìƒ˜í”Œ ë°ì´í„° (ì‹¤ì œë¡œëŠ” APIì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨)
  new Chart(document.getElementById('tlcChart'), {
    type: 'line',
    data: {
      labels: ['ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† ','ì¼'],
      datasets: [{
        label: 'TLC ì±„êµ´',
        data: [12, 19, 3, 5, 2, 3, 10],
        borderColor: '#8b5cf6',
        tension: 0.1
      }]
    }
  });
  new Chart(document.getElementById('tlChart'), {
    type: 'bar',
    data: {
      labels: ['1ì£¼','2ì£¼','3ì£¼','4ì£¼'],
      datasets: [{
        label: 'TL ì‚¬ìš©',
        data: [120, 190, 30, 50],
        backgroundColor: '#8b5cf6'
      }]
    }
  });
}

async function loadRanking(type, btn) {
  document.querySelectorAll('.rank-tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  
  const res = await fetch(`${API_BASE}/api/ranking?type=${type}&period=week&limit=10`);
  const ranks = await res.json();
  let html = '';
  ranks.forEach((item, idx) => {
    html += `<tr><td>${idx+1}</td><td>User ${item.user_id}</td><td>${item.value}</td></tr>`;
  });
  document.getElementById('ranking-body').innerHTML = html;
}

loadPOC();
loadCharts();
loadRanking('tlc', document.querySelector('.rank-tab'));
</script>
</body>
</html>

