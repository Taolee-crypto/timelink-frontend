<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë¡œê·¸ì¸ â€” TimeLink</title>
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
<style>
:root {
  --purple:#8b5cf6; --purple-dark:#7c3aed; --purple-light:#ede9fe;
  --font:'Inter','Noto Sans KR',sans-serif;
  --text:#1f2937; --border:#e5e7eb; --surface:#f9fafb;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:var(--font);background:#f8fafc;color:var(--text);min-height:100vh;display:flex;flex-direction:column;line-height:1.6;}
/* â”€â”€ ë„¤ë¹„ë°” â”€â”€ */
.navbar{background:white;border-bottom:1px solid var(--border);padding:0 24px;height:64px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;}
.logo{display:flex;align-items:center;gap:10px;font-size:20px;font-weight:800;color:var(--text);text-decoration:none;}
.logo-icon{width:32px;height:32px;background:var(--purple);border-radius:8px;display:flex;align-items:center;justify-content:center;color:white;font-size:16px;}
.logo span{color:var(--purple);}
.nav-right{display:flex;align-items:center;gap:12px;}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 20px;border-radius:999px;font-weight:600;font-size:14px;cursor:pointer;transition:all .2s;border:none;text-decoration:none;font-family:var(--font);}
.btn-primary{background:#8b5cf6;color:white;}
.btn-primary:hover{background:#7c3aed;}
.btn-outline{background:white;color:#1f2937;border:1px solid #e5e7eb;}
.btn-outline:hover{background:#f9fafb;}
.btn-sm{padding:6px 14px;font-size:13px;}
.balance{background:#f3f4f6;border-radius:999px;padding:6px 16px;display:flex;align-items:center;gap:16px;}
.balance-item{display:flex;align-items:center;gap:6px;font-size:14px;}
.balance-label{color:#6b7280;font-weight:500;}
.balance-value{font-weight:700;color:var(--purple);}
.avatar{width:36px;height:36px;background:var(--purple);border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:15px;cursor:pointer;position:relative;user-select:none;}
.dropdown{position:absolute;top:calc(100% + 8px);right:0;background:white;border:1px solid var(--border);border-radius:12px;box-shadow:0 10px 15px -3px rgba(0,0,0,.1);width:200px;display:none;z-index:1000;overflow:hidden;}
.dropdown.show{display:block;}
.dropdown-item{padding:12px 16px;cursor:pointer;font-size:14px;color:var(--text);text-decoration:none;display:block;transition:background .15s;}
.dropdown-item:hover{background:#f3f4f6;}
.dropdown-item.danger{color:#ef4444;}
.dropdown-item.charge{color:var(--purple);font-weight:700;}
.dropdown-divider{height:1px;background:var(--border);margin:4px 0;}
.hidden{display:none!important;}
/* â”€â”€ íƒ­ â”€â”€ */
.tabs{background:white;border-bottom:1px solid var(--border);padding:0 24px;display:flex;justify-content:center;gap:4px;position:sticky;top:64px;z-index:90;overflow-x:auto;}
.tab{padding:12px 20px;font-size:14px;font-weight:600;color:#6b7280;text-decoration:none;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap;}
.tab:hover{color:var(--purple);}
.tab.active{color:var(--purple);border-bottom-color:var(--purple);}
#global-controls button{background:rgba(139,92,246,.08)!important;border:1px solid rgba(139,92,246,.2)!important;color:#374151!important;font-family:var(--font);}
#global-controls button:hover{background:rgba(139,92,246,.15)!important;}
/* â”€â”€ ë¡œê·¸ì¸ ì¹´ë“œ â”€â”€ */
.main-content{flex:1;display:flex;align-items:center;justify-content:center;padding:40px 20px;}
.login-card{background:white;border-radius:24px;padding:40px;width:100%;max-width:420px;box-shadow:0 4px 24px rgba(0,0,0,.08);}
.card-title{font-size:28px;font-weight:800;text-align:center;margin-bottom:6px;}
.card-sub{color:#64748b;text-align:center;margin-bottom:28px;font-size:15px;}
.input-group{margin-bottom:16px;}
.input-group label{display:block;font-size:13px;font-weight:600;color:#374151;margin-bottom:6px;}
.input-group input{width:100%;padding:12px 16px;border:1.5px solid var(--border);border-radius:10px;font-size:14px;font-family:var(--font);transition:all .2s;background:white;color:var(--text);}
.input-group input:focus{border-color:var(--purple);outline:none;box-shadow:0 0 0 3px rgba(139,92,246,.1);}
.login-btn{width:100%;padding:14px;background:var(--purple);color:white;border:none;border-radius:10px;font-weight:700;font-size:15px;cursor:pointer;transition:all .2s;font-family:var(--font);margin-top:4px;}
.login-btn:hover{background:var(--purple-dark);transform:translateY(-1px);}
.login-btn:disabled{background:#9ca3af;cursor:not-allowed;transform:none;}
.ton-btn{width:100%;padding:12px;background:white;color:var(--text);border:1.5px solid var(--border);border-radius:10px;font-weight:600;font-size:14px;cursor:pointer;transition:all .2s;font-family:var(--font);}
.ton-btn:hover{background:var(--surface);}
.divider{margin:20px 0;display:flex;align-items:center;gap:12px;color:#9ca3af;font-size:13px;}
.divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--border);}
.alert{padding:12px 16px;border-radius:10px;font-size:13px;margin-bottom:16px;display:none;font-weight:500;}
.alert.show{display:block;}
.alert-error{background:#fee2e2;color:#dc2626;}
.alert-success{background:#d1fae5;color:#059669;}
.footer-link{text-align:center;margin-top:20px;font-size:14px;color:#64748b;}
.footer-link a{color:var(--purple);text-decoration:none;font-weight:600;}
.footer-link a:hover{text-decoration:underline;}
/* â”€â”€ í‘¸í„° â”€â”€ */
.page-footer{background:#f9fafb;border-top:1px solid var(--border);padding:48px 24px 24px;margin-top:auto;}
.footer-grid{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1.5fr 1fr 1fr 1fr;gap:40px;margin-bottom:32px;}
.footer-logo{font-size:18px;font-weight:800;margin-bottom:8px;}
.footer-col-title{font-size:11px;font-weight:700;color:#9ca3af;text-transform:uppercase;letter-spacing:1px;margin-bottom:12px;}
.footer-col a{display:block;font-size:13px;color:#6b7280;text-decoration:none;margin-bottom:8px;transition:color .2s;}
.footer-col a:hover{color:var(--purple);}
.footer-bottom{max-width:1100px;margin:0 auto;border-top:1px solid var(--border);padding-top:20px;font-size:12px;color:#9ca3af;}
@media(max-width:768px){.footer-grid{grid-template-columns:1fr 1fr;gap:24px;}.tabs{justify-content:flex-start;}}
@media(max-width:480px){.login-card{padding:28px 20px;}.footer-grid{grid-template-columns:1fr;}}
</style>
</head>
<body>

<nav class="navbar">
  <a href="index.html" class="logo"><div class="logo-icon">âš¡</div><div>Time<span>Link</span></div></a>
  <div id="global-controls" style="display:flex;align-items:center;gap:6px;margin-left:auto;margin-right:12px;">
    <div id="lang-selector"></div>
    <div id="currency-selector"></div>
  </div>
  <div class="nav-right" id="nav-guest">
    <a href="login.html" class="btn btn-outline btn-sm" data-i18n="nav_login">ë¡œê·¸ì¸</a>
    <a href="signup.html" class="btn btn-primary btn-sm" data-i18n="nav_start">ì‹œì‘í•˜ê¸°</a>
  </div>
  <div class="nav-right hidden" id="nav-auth">
    <div class="balance">
      <div class="balance-item"><span class="balance-label">TL</span><span class="balance-value" id="balance-tl">0</span></div>
      <div class="balance-item"><span class="balance-label">TLC</span><span class="balance-value" id="balance-tlc">0.0000</span></div>
    </div>
    <div class="avatar" onclick="toggleDropdown()">
      <span id="avatar-letter">U</span>
      <div class="dropdown" id="dropdown">
        <a href="wallet.html" class="dropdown-item" data-i18n="tab_wallet">ğŸ‘› ì§€ê°‘</a>
        <a href="library.html" class="dropdown-item" data-i18n="tab_library">ğŸ” ë¼ì´ë¸ŒëŸ¬ë¦¬</a>
        <a href="create.html" class="dropdown-item" data-i18n="tab_upload">ğŸ“¤ ì—…ë¡œë“œ</a>
        <a href="dashboard.html" class="dropdown-item" data-i18n="tab_dashboard">ğŸ“Š ëŒ€ì‹œë³´ë“œ</a>
        <div class="dropdown-divider"></div>
        <a href="charge.html" class="dropdown-item charge">ğŸ’³ TL ì¶©ì „</a>
        <div class="dropdown-divider"></div>
        <div class="dropdown-item danger" onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</div>
      </div>
    </div>
  </div>
</nav>

<div class="tabs">
  <a href="index.html" class="tab" data-i18n="tab_home">ğŸ  í™ˆ</a>
  <a href="shareplace.html" class="tab" data-i18n="tab_shareplace">ğŸ›ï¸ SharePlace</a>
  <a href="library.html" class="tab" data-i18n="tab_library">ğŸ” ë¼ì´ë¸ŒëŸ¬ë¦¬</a>
  <a href="create.html" class="tab" data-i18n="tab_upload">ğŸ“¤ ì—…ë¡œë“œ</a>
  <a href="radio.html" class="tab" data-i18n="tab_radio">â˜• ì¹´í˜ë°©ì†¡</a>
  <a href="car.html" class="tab" data-i18n="tab_car">ğŸ§ Moving Radio</a>
  <a href="ads.html" class="tab" data-i18n="tab_ads">ğŸ“£ ê´‘ê³ </a>
  <a href="wallet.html" class="tab" data-i18n="tab_wallet">ğŸ‘› ì§€ê°‘</a>
  <a href="chart.html" class="tab" data-i18n="tab_chart">ğŸ“Š ì°¨íŠ¸</a>
  <a href="dashboard.html" class="tab" data-i18n="tab_dashboard">ğŸ“Š ëŒ€ì‹œë³´ë“œ</a>
</div>

<div class="main-content">
  <div class="login-card">
    <div class="card-title" data-i18n="login_welcome">ë‹¤ì‹œ ì˜¤ì…¨êµ°ìš”</div>
    <div class="card-sub" data-i18n="login_sub">ê³„ì† Pulseë¥¼ ìŒ“ì•„ë³´ì„¸ìš”</div>

    <div id="alert-error" class="alert alert-error"></div>
    <div id="alert-success" class="alert alert-success"></div>

    <div class="input-group">
      <label for="email">ì´ë©”ì¼</label>
      <input type="email" id="email" placeholder="your@email.com" autocomplete="email">
    </div>
    <div class="input-group">
      <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
      <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password">
    </div>

    <button class="login-btn" id="login-btn" onclick="doLogin()">ë¡œê·¸ì¸</button>

    <div class="divider">ë˜ëŠ”</div>
    <button class="ton-btn" onclick="alert('TON Wallet ë¡œê·¸ì¸ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.')">ğŸ’ TON Walletë¡œ ë¡œê·¸ì¸</button>

    <div class="footer-link">
      <span data-i18n="login_no_account">ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?</span>
      <a href="signup.html" data-i18n="login_free_join"> ë¬´ë£Œ ê°€ì… â†’</a>
    </div>
  </div>
</div>

<footer class="page-footer">
  <div class="footer-grid">
    <div>
      <div class="footer-logo">âš¡ Time<span style="color:var(--purple)">Link</span></div>
      <div style="font-size:13px;color:#9ca3af;" data-i18n="footer_slogan">ì°½ì‘ìë¥¼ ìœ„í•œ ìƒˆë¡œìš´ ìˆ˜ìµ í”Œë«í¼</div>
    </div>
    <div class="footer-col">
      <div class="footer-col-title" data-i18n="footer_service">ì„œë¹„ìŠ¤</div>
      <a href="shareplace.html" data-i18n="footer_shareplace">ğŸ›ï¸ SharePlace</a>
      <a href="creator.html" data-i18n="footer_creator">ğŸµ ì°½ì‘ì í”„ë¡œê·¸ë¨</a>
      <a href="pricing.html" data-i18n="footer_pricing">ğŸ’³ ìš”ê¸ˆì œ</a>
      <a href="ads.html" data-i18n="footer_ads_inquiry">ğŸ“£ ê´‘ê³  ë¬¸ì˜</a>
    </div>
    <div class="footer-col">
      <div class="footer-col-title" data-i18n="footer_company">íšŒì‚¬</div>
      <a href="about.html" data-i18n="footer_about">ğŸ¢ íšŒì‚¬ ì†Œê°œ</a>
      <a href="tokenomics.html" data-i18n="footer_tokenomics">âš¡ í† í° ê²½ì œ</a>
      <a href="roadmap.html" data-i18n="footer_roadmap">ğŸ—ºï¸ ë¡œë“œë§µ</a>
      <a href="faq.html" data-i18n="footer_faq">â“ FAQ</a>
    </div>
    <div class="footer-col">
      <div class="footer-col-title" data-i18n="footer_legal">ë²•ë¬´</div>
      <a href="terms.html" data-i18n="footer_terms">ì´ìš©ì•½ê´€</a>
      <a href="privacy.html" data-i18n="footer_privacy">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
      <a href="copyright.html" data-i18n="footer_copyright">ì €ì‘ê¶Œ ì •ì±…</a>
    </div>
  </div>
  <div class="footer-bottom" data-i18n="footer_copy_full">âš–ï¸ ëª¨ë“  íŒŒì¼ì˜ ì°½ì‘ê¶Œì€ ì°½ì‘ìì—ê²Œ ìˆìŠµë‹ˆë‹¤. Â© 2025 TimeLink. All rights reserved.</div>
</footer>

<script src="i18n.js"></script>
<script src="currency.js"></script>
<script src="tl-economy.js"></script>
<script>
const API = 'https://timelink-backend.mununglee.workers.dev';

async function doLogin() {
  const email    = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;
  const btn      = document.getElementById('login-btn');
  hideAlerts();
  if (!email || !password) { showError('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
  btn.textContent = 'ë¡œê·¸ì¸ ì¤‘...';
  btn.disabled = true;
  try {
    const res = await fetch(API + '/api/v1/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });
    const data = await res.json();
    if (res.ok && (data.success || data.token || data.user)) {
      // í† í° ì €ì¥ (ë‹¤ì–‘í•œ ì‘ë‹µ êµ¬ì¡° ëŒ€ì‘)
      const token = data.token || data.access_token || data.jwt || '';
      localStorage.setItem('auth_token', token);
      // ìœ ì € ì •ë³´ ì •ê·œí™”
      const user = data.user || data.data || {};
      const userLocal = {
        id:           user.id || user.user_id || Date.now(),
        uid:          user.uid || user.id || 'tl_' + Date.now(),
        email:        user.email || email,
        username:     user.username || user.name || email.split('@')[0],
        account_type: user.account_type || 'personal',
        tl:           user.tl ?? user.tl_balance ?? 10000,
        tlc:          user.tlc ?? user.tlc_balance ?? 0,
      };
      localStorage.setItem('tl_user', JSON.stringify(userLocal));
      showSuccess('âœ… ë¡œê·¸ì¸ ì„±ê³µ! ì´ë™ ì¤‘...');
      setTimeout(() => window.location.href = 'index.html', 800);
    } else {
      showError(data.message || data.error || data.msg || 'ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
      btn.textContent = 'ë¡œê·¸ì¸'; btn.disabled = false;
    }
  } catch(e) {
    showError('ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
    console.error('Login error:', e);
    btn.textContent = 'ë¡œê·¸ì¸'; btn.disabled = false;
  }
}

function showError(msg)   { const el=document.getElementById('alert-error');   el.textContent='âŒ '+msg; el.classList.add('show'); }
function showSuccess(msg) { const el=document.getElementById('alert-success'); el.textContent=msg; el.classList.add('show'); }
function hideAlerts()     { document.querySelectorAll('.alert').forEach(el=>el.classList.remove('show')); }

document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('email').addEventListener('keydown', e => { if(e.key==='Enter') document.getElementById('password').focus(); });
  document.getElementById('password').addEventListener('keydown', e => { if(e.key==='Enter') doLogin(); });
});

(function(){
  var u = null;
  try { u = JSON.parse(localStorage.getItem('tl_user')||'null'); } catch(e){}
  window.toggleDropdown = function(){ document.getElementById('dropdown')?.classList.toggle('show'); };
  window.logout = function(){ localStorage.removeItem('tl_user'); localStorage.removeItem('auth_token'); window.location.href='index.html'; };
  document.addEventListener('click', function(e){
    if(!e.target.closest('.avatar')&&!e.target.closest('#dropdown')) document.getElementById('dropdown')?.classList.remove('show');
  });
  document.addEventListener('DOMContentLoaded', function(){
    if(u){ window.location.href='index.html'; return; }
    if(typeof I18N!=='undefined'){ I18N.lang=I18N.detect(); I18N.renderSelector('lang-selector'); I18N.applyAll(); }
    if(typeof CURRENCY!=='undefined'){ CURRENCY.current=CURRENCY.detect(); CURRENCY.renderSelector('currency-selector'); CURRENCY.applyAll(); }
  });
})();
</script>
</body>
</html>
