<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Share Place â€” TimeLink</title>
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#060610;--card:rgba(255,255,255,.04);--card-h:rgba(255,255,255,.07);
  --bd:rgba(255,255,255,.08);--bd-a:rgba(0,245,160,.3);
  --ac:#00f5a0;--ac-d:rgba(0,245,160,.13);--ac-g:0 0 28px rgba(0,245,160,.35);
  --pu:#7b61ff;--pu-d:rgba(123,97,255,.13);
  --ca:#f59e0b;--ca-d:rgba(245,158,11,.11);
  --da:#ff4f4f;
  --t1:#e8e8f5;--t2:#8888aa;--t3:#44445a;
  --rf:999px;--rl:20px;--rm:14px;--rs:8px;
  --tr:all .2s cubic-bezier(.4,0,.2,1);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:'Syne',sans-serif;background:var(--bg);color:var(--t1);min-height:100vh;-webkit-font-smoothing:antialiased;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background:radial-gradient(ellipse 80% 50% at 20% 10%,rgba(0,245,160,.05) 0%,transparent 60%),
             radial-gradient(ellipse 60% 40% at 80% 80%,rgba(123,97,255,.05) 0%,transparent 60%)}
.navbar{position:sticky;top:0;z-index:200;height:64px;padding:0 24px;display:flex;align-items:center;justify-content:space-between;background:rgba(6,6,16,.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--bd)}
.logo{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--t1)}
.logo-icon{width:32px;height:32px;border-radius:8px;background:var(--ac);display:flex;align-items:center;justify-content:center;font-size:16px}
.logo-text{font-size:18px;font-weight:800;letter-spacing:-.5px}.logo-text span{color:var(--ac)}
.nav-links{display:flex;align-items:center;gap:4px}
.nav-link{padding:7px 14px;border-radius:var(--rf);font-size:13px;font-weight:700;text-decoration:none;color:var(--t2);transition:var(--tr)}
.nav-link:hover{color:var(--t1);background:var(--card)}.nav-link.active{background:var(--ac);color:#060610}
.bal-row{display:flex;align-items:center;gap:10px;padding:6px 14px;border-radius:var(--rf);background:var(--card);border:1px solid var(--bd)}
.bal-col{display:flex;flex-direction:column;align-items:center}
.bal-lbl{font-size:10px;color:var(--t2);font-weight:700;text-transform:uppercase}
.bal-val{font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:700;color:var(--ac)}
.bal-sep{width:1px;height:20px;background:var(--bd)}
.page{padding:28px 24px 100px;max-width:1100px;margin:0 auto;position:relative;z-index:1}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:7px;padding:9px 20px;border-radius:var(--rf);font-family:'Syne',sans-serif;font-size:14px;font-weight:700;cursor:pointer;transition:var(--tr);border:none;white-space:nowrap}
.btn-primary{background:var(--ac);color:#060610}.btn-primary:hover{transform:translateY(-1px);box-shadow:var(--ac-g)}
.btn-ghost{background:transparent;color:var(--t2);border:1px solid var(--bd)}.btn-ghost:hover{background:var(--card-h);color:var(--t1)}
.btn-outline{background:transparent;color:var(--ac);border:1px solid var(--bd-a)}.btn-outline:hover{background:var(--ac-d)}
.btn-sm{padding:5px 13px;font-size:12px}.w-full{width:100%}
/* SHARE CARDS */
.share-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}
.share-card{background:var(--card);border:1px solid var(--bd);border-radius:var(--rl);padding:0;overflow:hidden;transition:var(--tr);cursor:default}
.share-card:hover{border-color:var(--bd-a);transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,.3)}
.share-art{width:100%;height:80px;display:flex;align-items:center;justify-content:center;font-size:32px;position:relative;overflow:hidden}
.share-art::after{content:'';position:absolute;inset:0;background:linear-gradient(to bottom,transparent 60%,rgba(6,6,16,.6))}
.share-body{padding:16px}
.share-title{font-weight:800;font-size:15px;margin-bottom:3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.share-artist{font-size:13px;color:var(--t2);margin-bottom:10px}
.share-meta{display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-bottom:12px}
/* CHIPS */
.chips{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:20px}
.chip{padding:5px 14px;border-radius:var(--rf);font-size:12px;font-weight:700;cursor:pointer;transition:var(--tr);border:1px solid var(--bd);background:transparent;color:var(--t2)}
.chip:hover{border-color:var(--bd-a);color:var(--t1)}.chip.active{background:var(--ac);color:#060610;border-color:var(--ac)}
/* SEARCH */
.search-bar{display:flex;gap:10px;margin-bottom:20px}
.search-input{flex:1;background:rgba(255,255,255,.05);border:1px solid var(--bd);border-radius:var(--rf);padding:11px 20px;font-family:'Syne',sans-serif;font-size:14px;color:var(--t1);outline:none;transition:var(--tr)}
.search-input:focus{border-color:var(--ac);box-shadow:0 0 0 3px rgba(0,245,160,.1)}
.search-input::placeholder{color:var(--t3)}
/* TRENDING */
.trending-row{display:flex;align-items:center;gap:12px;padding:12px 16px;border-radius:var(--rm);background:var(--card);border:1px solid var(--bd);transition:var(--tr)}
.trending-row:hover{border-color:var(--bd-a);background:var(--card-h)}
.trend-rank{font-family:'JetBrains Mono',monospace;font-size:18px;font-weight:800;width:32px;text-align:center}
.trend-rank.gold{color:var(--ca)}.trend-rank.silver{color:#94a3b8}.trend-rank.bronze{color:#cd7c5e}
.trend-thumb{width:46px;height:46px;flex-shrink:0;border-radius:var(--rs);display:flex;align-items:center;justify-content:center;font-size:20px}
.trend-info{flex:1;min-width:0}
.trend-title{font-weight:700;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.trend-meta{font-size:12px;color:var(--t2);margin-top:2px}
/* BADGE */
.badge{display:inline-flex;align-items:center;gap:4px;padding:3px 9px;border-radius:var(--rf);font-size:11px;font-weight:700;font-family:'JetBrains Mono',monospace}
.badge-ac{background:var(--ac-d);color:var(--ac);border:1px solid rgba(0,245,160,.2)}
.badge-pu{background:var(--pu-d);color:var(--pu);border:1px solid rgba(123,97,255,.2)}
.badge-ca{background:var(--ca-d);color:var(--ca);border:1px solid rgba(245,158,11,.3)}
/* STATS */
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-bottom:24px}
.stat-card{background:var(--card);border:1px solid var(--bd);border-radius:var(--rl);padding:18px;position:relative;overflow:hidden}
.stat-card::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--ac)}
.stat-lbl{font-size:11px;color:var(--t2);text-transform:uppercase;font-weight:700;letter-spacing:.5px;margin-bottom:6px}
.stat-val{font-family:'JetBrains Mono',monospace;font-size:22px;font-weight:800;color:var(--ac)}
/* MINI PLAYER */
.player-bar{position:fixed;bottom:0;left:0;right:0;height:70px;background:rgba(6,6,16,.97);backdrop-filter:blur(20px);border-top:1px solid var(--bd);display:flex;align-items:center;padding:0 24px;gap:16px;z-index:500}
.pb-prog{position:absolute;bottom:70px;left:0;right:0;height:3px;background:var(--bd)}
.pb-prog-fill{height:100%;background:var(--ac);width:0%}
.pb-thumb{width:44px;height:44px;flex-shrink:0;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:20px}
#toast-box{position:fixed;bottom:84px;right:24px;z-index:9999;display:flex;flex-direction:column;gap:8px;pointer-events:none}
.t{padding:11px 16px;border-radius:var(--rm);font-size:13px;font-weight:600;backdrop-filter:blur(20px);border:1px solid var(--bd);animation:ti .25s ease;max-width:300px}
.t.s{background:rgba(0,245,160,.12);color:var(--ac);border-color:rgba(0,245,160,.3)}
.t.e{background:rgba(255,79,79,.12);color:var(--da);border-color:rgba(255,79,79,.3)}
.t.i{background:rgba(123,97,255,.12);color:var(--pu);border-color:rgba(123,97,255,.3)}
@keyframes ti{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
.hidden{display:none!important}
@media(max-width:600px){.nav-links{display:none}.share-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<audio id="aud" preload="none" style="display:none"></audio>
<div id="toast-box"></div>

<nav class="navbar">
  <a class="logo" href="index.html"><div class="logo-icon">âš¡</div><span class="logo-text">Time<span>Link</span></span></a>
  <div class="nav-links">
    <a href="index.html" class="nav-link">ğŸ“Š Dashboard</a>
    <a href="create.html" class="nav-link">ğŸ“¤ Create</a>
    <a href="library.html" class="nav-link">ğŸ” Library</a>
    <a href="player.html" class="nav-link">ğŸ¬ Player</a>
    <a href="shareplace.html" class="nav-link active">ğŸ”„ Share</a>
    <a href="radio.html" class="nav-link">ğŸ“» Radio</a>
    <a href="car.html" class="nav-link">ğŸš— Car</a>
  </div>
  <div style="display:flex;align-items:center;gap:8px">
    <div class="bal-row">
      <div class="bal-col"><span class="bal-lbl">TL</span><span class="bal-val" id="nb-tl">â€”</span></div>
      <div class="bal-sep"></div>
      <div class="bal-col"><span class="bal-lbl">TLC</span><span class="bal-val" style="color:var(--pu)" id="nb-tlc">â€”</span></div>
    </div>
    <a href="create.html" class="btn btn-primary btn-sm">+ ì—…ë¡œë“œ</a>
  </div>
</nav>

<div class="page">

  <!-- í—¤ë” -->
  <div style="margin-bottom:24px">
    <div style="font-size:26px;font-weight:800;margin-bottom:4px">ğŸ”„ Share Place</div>
    <div style="font-size:14px;color:var(--t2)">ì»¤ë®¤ë‹ˆí‹° ìŒì•… ê³µìœ  Â· ì¬ìƒ ì‹œ ì°½ì‘ìì—ê²Œ TL ìˆ˜ìµ ì§€ê¸‰</div>
  </div>

  <!-- í†µê³„ -->
  <div class="stats-grid">
    <div class="stat-card"><div class="stat-lbl">ê³µìœ ëœ íŠ¸ë™</div><div class="stat-val">127</div></div>
    <div class="stat-card" style="--ac:var(--pu)"><div class="stat-lbl">ì´ Pulse</div><div class="stat-val" style="color:var(--pu)">2.4M</div></div>
    <div class="stat-card" style="--ac:var(--ca)"><div class="stat-lbl">í™œì„± ìœ ì €</div><div class="stat-val" style="color:var(--ca)">342</div></div>
    <div class="stat-card"><div class="stat-lbl">ì˜¤ëŠ˜ ê³µìœ </div><div class="stat-val">18</div></div>
  </div>

  <!-- ê²€ìƒ‰ + í•„í„° -->
  <div class="search-bar">
    <input type="text" id="q" class="search-input" placeholder="íŠ¸ë™, ì•„í‹°ìŠ¤íŠ¸, ì¥ë¥´ë¡œ ê²€ìƒ‰..." onkeydown="if(event.key==='Enter')doSearch()">
    <button class="btn btn-primary" onclick="doSearch()">ê²€ìƒ‰</button>
  </div>
  <div class="chips" id="genre-chips">
    <span class="chip active" data-g="all" onclick="setGenre('all')">ì „ì²´</span>
    <span class="chip" data-g="K-POP" onclick="setGenre('K-POP')">ğŸ‡°ğŸ‡· K-POP</span>
    <span class="chip" data-g="Electronic" onclick="setGenre('Electronic')">âš¡ Electronic</span>
    <span class="chip" data-g="Hip-Hop" onclick="setGenre('Hip-Hop')">ğŸ¤ Hip-Hop</span>
    <span class="chip" data-g="Chill" onclick="setGenre('Chill')">ğŸŒŠ Chill</span>
    <span class="chip" data-g="Jazz" onclick="setGenre('Jazz')">ğŸ· Jazz</span>
    <span class="chip" data-g="Indie" onclick="setGenre('Indie')">ğŸ¸ Indie</span>
    <span class="chip" data-g="R&B" onclick="setGenre('R&B')">ğŸ’œ R&B</span>
    <span class="chip" data-g="Lo-Fi" onclick="setGenre('Lo-Fi')">ğŸ“š Lo-Fi</span>
  </div>

  <!-- ë‘ ì»¬ëŸ¼: ê³µìœ  ì¹´ë“œ + íŠ¸ë Œë”© -->
  <div style="display:grid;grid-template-columns:1fr 340px;gap:24px;align-items:start" id="main-grid">

    <!-- ê³µìœ  ì¹´ë“œ ê·¸ë¦¬ë“œ -->
    <div>
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px">
        <div style="font-size:17px;font-weight:800" id="grid-title">ì»¤ë®¤ë‹ˆí‹° íŠ¸ë™</div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-ghost btn-sm" onclick="renderGrid()">ìƒˆë¡œê³ ì¹¨</button>
        </div>
      </div>
      <div class="share-grid" id="share-grid"></div>
    </div>

    <!-- íŠ¸ë Œë”© ì°¨íŠ¸ -->
    <div>
      <div style="font-size:17px;font-weight:800;margin-bottom:14px">ğŸ”¥ Trending</div>
      <div style="display:flex;flex-direction:column;gap:8px" id="trending-list"></div>

      <!-- ë‚´ ê³µìœ  -->
      <div style="margin-top:24px;font-size:17px;font-weight:800;margin-bottom:14px">ğŸ“¤ ë‚´ ê³µìœ </div>
      <div id="my-share-list">
        <div style="text-align:center;padding:28px;color:var(--t2);background:var(--card);border:1px solid var(--bd);border-radius:var(--rl)">
          <div style="font-size:32px;margin-bottom:10px">ğŸ“¤</div>
          <div style="margin-bottom:12px">ì•„ì§ ê³µìœ ëœ íŠ¸ë™ì´ ì—†ìŠµë‹ˆë‹¤</div>
          <a href="create.html" class="btn btn-primary btn-sm">+ ì—…ë¡œë“œ & ê³µìœ </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MINI PLAYER -->
<div id="pb" class="player-bar hidden">
  <div class="pb-prog"><div class="pb-prog-fill" id="pb-fill"></div></div>
  <div class="pb-thumb" id="pb-icon">ğŸµ</div>
  <div style="flex:1;min-width:0">
    <div style="font-weight:700;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis" id="pb-name">â€”</div>
    <div style="font-size:12px;color:var(--t2)" id="pb-sub">â€”</div>
  </div>
  <div style="display:flex;align-items:center;gap:10px;flex-shrink:0">
    <span class="badge badge-ac">âš¡ <span id="pb-pulse">0</span></span>
    <button id="pb-btn" onclick="togglePlay()" style="background:var(--ac);border:none;color:#060610;border-radius:50%;width:40px;height:40px;font-size:16px;cursor:pointer">â¸</button>
    <a href="player.html" class="btn btn-ghost btn-sm">ì „ì²´í™”ë©´</a>
  </div>
</div>

<script>
const TRACKS=[
  {id:'s1',title:'Midnight Vibe',artist:'Synthwave Studio',genre:'Electronic',icon:'ğŸŒ™',pulse:84200,fileTL:2000,maxFileTL:2000,art:'linear-gradient(135deg,#7b61ff,#060610)',url:'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'},
  {id:'s2',title:'Seoul Nights',artist:'K-Pop Studio',genre:'K-POP',icon:'ğŸ‡°ğŸ‡·',pulse:98700,fileTL:1500,maxFileTL:1500,art:'linear-gradient(135deg,#ff0066,#7b61ff)',url:'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3'},
  {id:'s3',title:'Sunset Groove',artist:'Chill Collective',genre:'Chill',icon:'ğŸŒ…',pulse:42900,fileTL:800,maxFileTL:1000,art:'linear-gradient(135deg,#f59e0b,#ef4444)',url:'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'},
  {id:'s4',title:'Electric Dreams',artist:'Neon Flow',genre:'Electronic',icon:'âš¡',pulse:61500,fileTL:3000,maxFileTL:3000,art:'linear-gradient(135deg,#00f5a0,#7b61ff)',url:'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3'},
  {id:'s5',title:'Dark Matter',artist:'Underground',genre:'Hip-Hop',icon:'ğŸŒ‘',pulse:33100,fileTL:500,maxFileTL:1000,art:'linear-gradient(135deg,#1e1e2e,#7b61ff)',url:'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3'},
  {id:'s6',title:'Golden Hour',artist:'Indie Soul',genre:'Indie',icon:'âœ¨',pulse:52300,fileTL:1200,maxFileTL:1200,art:'linear-gradient(135deg,#f59e0b,#00f5a0)',url:'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'},
  {id:'s7',title:'Jazz After Midnight',artist:'Blue Note',genre:'Jazz',icon:'ğŸ·',pulse:29800,fileTL:900,maxFileTL:900,art:'linear-gradient(135deg,#1e3a5f,#f59e0b)',url:'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3'},
  {id:'s8',title:'Lo-Fi Study Session',artist:'Focus Beats',genre:'Lo-Fi',icon:'ğŸ“š',pulse:71200,fileTL:600,maxFileTL:600,art:'linear-gradient(135deg,#84cc16,#06b6d4)',url:'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3'},
];

let curId=null,isPlaying=false,pulse=0,uiTimer=null,selGenre='all',curQuery='';
const aud=document.getElementById('aud');

function $(i){return document.getElementById(i)}
function fmt(n){return(n||0)>1000?((n/1000).toFixed(1)+'K'):Math.floor(n||0).toString()}
function fmtFull(n){return Math.floor(n||0).toLocaleString()}
function fmtT(s){s=Math.floor(s||0);return`${Math.floor(s/60)}:${String(s%60).padStart(2,'0')}`}
function toast(msg,t='i'){const el=document.createElement('div');el.className=`t ${t}`;el.textContent=msg;$('toast-box').prepend(el);setTimeout(()=>el.remove(),3200)}
function esc(s){return String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]))}

function loadWallet(){
  const u=JSON.parse(localStorage.getItem('tl_user')||'{}');
  if($('nb-tl'))$('nb-tl').textContent=fmtFull(u.tl||10000);
  if($('nb-tlc'))$('nb-tlc').textContent=(u.tlc||0).toFixed(4);
}
function setGenre(g){
  selGenre=g;
  document.querySelectorAll('.chip').forEach(c=>c.classList.toggle('active',c.dataset.g===g));
  renderGrid();
}
function doSearch(){curQuery=$('q').value.trim();renderGrid();}

function getFiltered(){
  let data=TRACKS;
  if(selGenre!=='all')data=data.filter(t=>t.genre===selGenre);
  if(curQuery){const q=curQuery.toLowerCase();data=data.filter(t=>t.title.toLowerCase().includes(q)||t.artist.toLowerCase().includes(q)||t.genre.toLowerCase().includes(q));}
  return data;
}
function renderGrid(){
  const data=getFiltered();
  $('grid-title').textContent=curQuery?`"${esc(curQuery)}" ê²€ìƒ‰ ê²°ê³¼ (${data.length})`:`ì»¤ë®¤ë‹ˆí‹° íŠ¸ë™ (${data.length})`;
  $('share-grid').innerHTML=data.length?data.map(t=>`
    <div class="share-card">
      <div class="share-art" style="background:${t.art}">
        <span style="position:relative;z-index:1;font-size:36px">${t.icon}</span>
      </div>
      <div class="share-body">
        <div class="share-title">${esc(t.title)}</div>
        <div class="share-artist">${esc(t.artist)} Â· ${esc(t.genre)}</div>
        <div class="share-meta">
          <span class="badge badge-ac">âš¡ ${fmt(t.pulse)}</span>
          <span class="badge badge-ca">ğŸ’° ${fmtFull(t.fileTL)} TL</span>
        </div>
        <div style="height:3px;background:rgba(255,255,255,.06);border-radius:2px;overflow:hidden;margin-bottom:12px">
          <div style="height:100%;width:${t.maxFileTL?(t.fileTL/t.maxFileTL*100).toFixed(0):100}%;background:linear-gradient(90deg,var(--ca),var(--ac));border-radius:2px"></div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-outline btn-sm" style="flex:1" onclick="playTrack('${t.id}')">â–¶ ì¬ìƒ</button>
          <button class="btn btn-ghost btn-sm" onclick="toast('Phase 2ì—ì„œ ì§€ì›ë©ë‹ˆë‹¤','i')">ğŸ“¥ ë‹´ê¸°</button>
          <button class="btn btn-ghost btn-sm" onclick="shareTrack('${t.id}')">ğŸ”—</button>
        </div>
      </div>
    </div>`).join(''):'<div style="text-align:center;padding:60px;color:var(--t2);grid-column:1/-1"><div style="font-size:40px;margin-bottom:12px">ğŸ”</div>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
}
function renderTrending(){
  const sorted=[...TRACKS].sort((a,b)=>b.pulse-a.pulse).slice(0,5);
  const rankClass=['gold','silver','bronze','',''];
  $('trending-list').innerHTML=sorted.map((t,i)=>`
    <div class="trending-row" onclick="playTrack('${t.id}')">
      <div class="trend-rank ${rankClass[i]||''}">${i+1}</div>
      <div class="trend-thumb" style="background:${t.art}">${t.icon}</div>
      <div class="trend-info">
        <div class="trend-title">${esc(t.title)}</div>
        <div class="trend-meta">âš¡ ${fmt(t.pulse)} Pulse</div>
      </div>
    </div>`).join('');
}

function playTrack(id){
  const t=TRACKS.find(x=>x.id===id);if(!t)return;
  if(t.fileTL<=0){toast('íŒŒì¼ TL ì†Œì§„ â€” Playerì—ì„œ ì¶©ì „í•˜ì„¸ìš”','e');return;}
  curId=id;pulse=0;
  aud.src=t.url;aud.load();aud.volume=.8;
  aud.play().then(()=>{
    setPlaying(true);startTimer();
    $('pb').classList.remove('hidden');
    $('pb-icon').textContent=t.icon;$('pb-icon').style.background=t.art;
    $('pb-name').textContent=t.title;$('pb-sub').textContent=t.artist+' Â· '+t.genre;
    toast(`â–¶ ${t.title} ì¬ìƒ ì¤‘`,'s');
  }).catch(()=>toast('ì¬ìƒ ì˜¤ë¥˜','e'));
}
function togglePlay(){
  if(!curId)return;
  if(isPlaying){aud.pause();setPlaying(false);clearInterval(uiTimer);}
  else{aud.play().then(()=>{setPlaying(true);startTimer();});}
}
function setPlaying(v){isPlaying=v;const b=$('pb-btn');if(b)b.innerHTML=v?'â¸':'â–¶';}
function startTimer(){
  uiTimer=setInterval(()=>{
    if(!isPlaying)return;
    pulse++;
    $('pb-pulse').textContent=fmtFull(pulse);
    if(aud.duration)$('pb-fill').style.width=(aud.currentTime/aud.duration*100).toFixed(1)+'%';
    const t=TRACKS.find(x=>x.id===curId);
    if(t){t.fileTL=Math.max(0,t.fileTL-1);if(t.fileTL<=0){toast('íŒŒì¼ TL ì†Œì§„!','e');aud.pause();setPlaying(false);clearInterval(uiTimer);}}
  },1000);
}
aud.addEventListener('ended',()=>{setPlaying(false);clearInterval(uiTimer);toast('ì¬ìƒ ì™„ë£Œ!','s');});

function shareTrack(id){
  const t=TRACKS.find(x=>x.id===id);
  if(!t)return;
  const url=window.location.origin+'/shareplace.html?track='+id;
  if(navigator.clipboard){navigator.clipboard.writeText(url).then(()=>toast('ë§í¬ ë³µì‚¬ë¨!','s')).catch(()=>toast('ë§í¬: '+url,'i'));}
  else toast('ê³µìœ  ë§í¬: '+url,'i');
}

loadWallet();renderGrid();renderTrending();

// ë°˜ì‘í˜•: ëª¨ë°”ì¼ì—ì„œ 2ì»¬ëŸ¼ â†’ 1ì»¬ëŸ¼
if(window.innerWidth<900){$('main-grid').style.gridTemplateColumns='1fr';}
window.addEventListener('resize',()=>{$('main-grid').style.gridTemplateColumns=window.innerWidth<900?'1fr':'1fr 340px';});
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"1271d078e0ec49ac83bc8dd8b8fac63b","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"1271d078e0ec49ac83bc8dd8b8fac63b","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"1271d078e0ec49ac83bc8dd8b8fac63b","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
