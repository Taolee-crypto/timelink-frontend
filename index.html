<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TimeLink v20.0 - TL3 íŒŒì¼ = ì¶©ì „ í•„ìˆ˜!</title>
    <style>
        /* ===== ì›ë³¸ ë””ìì¸ 100% ì™„ì „ ìœ ì§€ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --danger: linear-gradient(135deg, #f43f5e 0%, #e11d48 100%);
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --shadow: 0 10px 40px rgba(0,0,0,0.1);
            --shadow-lg: 0 20px 60px rgba(0,0,0,0.2);
            --ton: linear-gradient(135deg, #0088CC 0%, #00A8E8 100%);
            --radio: linear-gradient(135deg, #1db954 0%, #1ed760 100%);
            --car: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            --commercial: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark);
        }

        /* ===== ë¡œê·¸ì¸/ê°€ì… ===== */
        .auth-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .auth-box {
            background: white;
            padding: 50px;
            border-radius: 30px;
            box-shadow: var(--shadow-lg);
            max-width: 450px;
            width: 100%;
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo h1 {
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .logo p {
            color: #666;
            font-size: 1.1rem;
        }

        .version-badge {
            background: var(--secondary);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 13px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.3);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            margin-top: 15px;
        }

        .btn-secondary:hover {
            background: #f8f9ff;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
            box-shadow: 0 10px 30px rgba(244, 63, 94, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(244, 63, 94, 0.4);
        }

        .btn-business {
            background: var(--commercial);
            color: white;
            box-shadow: 0 10px 30px rgba(245, 87, 108, 0.3);
        }

        .btn-business:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(245, 87, 108, 0.4);
        }

        /* ===== ë©”ì¸ ì•± ===== */
        .app-container {
            display: none;
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            animation: fadeIn 0.5s ease-in;
        }

        /* í—¤ë” */
        .app-header {
            background: white;
            padding: 25px 40px;
            border-radius: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left h1 {
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2rem;
            font-weight: 800;
        }

        .header-right {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .balance-card {
            text-align: center;
            padding: 10px 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
        }

        .balance-card .label {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .balance-card .amount {
            font-size: 24px;
            font-weight: 800;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .avatar-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 20px;
        }

        .btn-logout {
            background: var(--secondary);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-logout:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(245, 87, 108, 0.3);
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding-bottom: 10px;
            flex-wrap: wrap;
        }

        .tab {
            background: white;
            padding: 18px 30px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
            white-space: nowrap;
            font-size: 15px;
        }

        .tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        /* íƒ­ ì½˜í…ì¸  */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        /* ì¹´ë“œ */
        .card {
            background: white;
            padding: 40px;
            border-radius: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .card h2 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* í†µê³„ ê·¸ë¦¬ë“œ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--primary);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
        }

        .stat-card .icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .stat-card .label {
            font-size: 13px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 2.5rem;
            font-weight: 800;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ===== TL3 íŒŒì¼ ì¹´ë“œ ===== */
        .tl3-badge {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: 700;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin-bottom: 10px;
        }

        .no-tl-badge {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: 700;
            color: white;
            background: var(--danger);
            margin-bottom: 10px;
        }

        .copyright-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 13px;
            border-left: 4px solid #667eea;
        }

        /* ===== íŒŒì¼ ì—…ë¡œë“œ ===== */
        .upload-zone {
            border: 3px dashed #667eea;
            border-radius: 20px;
            padding: 60px 40px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9ff 0%, #e8ecff 100%);
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }

        .upload-zone:hover {
            border-color: #764ba2;
            background: linear-gradient(135deg, #e8ecff 0%, #d8dcff 100%);
            transform: scale(1.02);
        }

        .upload-zone .icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }

        .upload-zone h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #333;
        }

        .upload-zone p {
            color: #666;
            font-size: 14px;
        }

        /* íŒŒì¼ ëª©ë¡ */
        .file-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .file-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border-top: 5px solid #667eea;
        }

        .file-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
        }

        .file-thumbnail {
            height: 180px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: white;
            position: relative;
        }

        .file-info {
            padding: 25px;
        }

        .file-name {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #333;
        }

        .file-artist {
            color: #666;
            font-size: 1rem;
            margin-bottom: 15px;
        }

        .file-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 14px;
            color: #666;
        }

        .tl-progress {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .tl-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .tl-progress-empty {
            height: 100%;
            background: linear-gradient(90deg, #f43f5e, #e11d48);
            width: 100%;
        }

        .file-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-play, .btn-charge, .btn-share, .btn-business-play, .btn-play-disabled {
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-size: 14px;
        }

        .btn-play {
            background: var(--success);
        }

        .btn-play-disabled {
            background: #999;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .btn-charge {
            background: var(--warning);
        }

        .btn-share {
            background: var(--primary);
        }

        .btn-business-play {
            background: var(--commercial);
        }

        .btn-play:hover:not(.btn-play-disabled), .btn-charge:hover, .btn-share:hover, .btn-business-play:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        /* ===== ê³µìœ  í”Œë ˆì´ìŠ¤ ===== */
        .share-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
        }

        .share-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .share-stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .share-stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: #667eea;
        }

        .share-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 12px 24px;
            border: 2px solid #e0e0e0;
            border-radius: 30px;
            background: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            border-color: #667eea;
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: transparent;
        }

        /* ===== ë¼ë””ì˜¤ ===== */
        .radio-header {
            background: var(--radio);
            color: white;
            padding: 40px;
            border-radius: 25px;
            margin-bottom: 30px;
        }

        .radio-channel-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .channel-header {
            background: var(--radio);
            color: white;
            padding: 20px;
        }

        .channel-playlist {
            padding: 20px;
        }

        .now-playing {
            background: #f0f9ff;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #1db954;
        }

        /* ===== ìƒì—…ë°©ì†¡ ===== */
        .commercial-header {
            background: var(--commercial);
            color: white;
            padding: 40px;
            border-radius: 25px;
            margin-bottom: 30px;
        }

        .commercial-channel-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .commercial-channel-header {
            background: var(--commercial);
            color: white;
            padding: 20px;
        }

        .business-badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: 600;
        }

        /* ===== ì°¨ëŸ‰ ë“±ë¡ ===== */
        .car-contribution-box {
            background: var(--car);
            color: white;
            padding: 40px;
            border-radius: 25px;
            margin-bottom: 30px;
        }

        /* ===== ê¸ˆ ë¦¬ì €ë¸Œ ===== */
        .gold-reserve-card {
            background: linear-gradient(135deg, #f7b731 0%, #ffda79 100%);
            padding: 40px;
            border-radius: 25px;
            color: white;
            margin-bottom: 30px;
        }

        /* ===== TON TLC ===== */
        .ton-card {
            background: var(--ton);
            color: white;
            padding: 40px;
            border-radius: 25px;
            margin-bottom: 30px;
        }

        .ton-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 30px;
            display: inline-block;
        }

        /* ===== ì±„êµ´ ===== */
        .mining-limit-box {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border-left: 8px solid #ff9800;
        }

        .mining-progress {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            margin: 15px 0;
        }

        .mining-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ffa500);
            transition: width 0.3s ease;
        }

        /* ===== ì¶©ì „ ì˜µì…˜ ===== */
        .charge-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .charge-card {
            background: white;
            border: 3px solid #e0e0e0;
            border-radius: 20px;
            padding: 35px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .charge-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);
        }

        .charge-card .icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .charge-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #333;
        }

        .charge-card .amount {
            font-size: 2rem;
            font-weight: 800;
            background: var(--success);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }

        /* ===== ê´‘ê³  ëª¨ë‹¬ ===== */
        .ad-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease-in;
        }

        .ad-content {
            background: white;
            padding: 50px;
            border-radius: 30px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            animation: slideUp 0.4s ease-out;
        }

        .ad-video {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
        }

        .ad-timer {
            font-size: 2rem;
            font-weight: 800;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
        }

        /* ===== í”Œë ˆì´ì–´ ëª¨ë‹¬ ===== */
        .player-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease-in;
        }

        .player-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            max-width: 550px;
            width: 90%;
            text-align: center;
        }

        .player-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #333;
        }

        .player-artist {
            color: #666;
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        .player-copyright {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 25px;
            font-size: 14px;
            color: #555;
            text-align: left;
            border-left: 4px solid #667eea;
        }

        .player-tl-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .player-tl-amount {
            font-size: 2.5rem;
            font-weight: 800;
            color: #667eea;
        }

        .player-progress {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .player-progress-fill {
            height: 100%;
            background: var(--success);
            width: 0%;
            transition: width 0.3s ease;
        }

        .player-time {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            color: #666;
            font-size: 14px;
        }

        .player-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .audio-element {
            display: none;
        }

        /* ===== ì¶©ì „ ëª¨ë‹¬ ===== */
        .charge-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1500;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease-in;
        }

        .charge-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            animation: slideUp 0.4s ease-out;
        }

        /* ===== í† ìŠ¤íŠ¸ ===== */
        .toast {
            position: fixed;
            top: 30px;
            right: 30px;
            background: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: var(--shadow-lg);
            display: none;
            z-index: 3000;
            min-width: 350px;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .toast.success { border-left: 5px solid #4CAF50; }
        .toast.error { border-left: 5px solid #f44336; }
        .toast.warning { border-left: 5px solid #ff9800; }
        .toast.info { border-left: 5px solid #2196F3; }

        /* ===== ë°˜ì‘í˜• ===== */
        @media (max-width: 768px) {
            .app-header {
                flex-direction: column;
                gap: 20px;
            }

            .header-right {
                flex-direction: column;
                width: 100%;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
            
            .share-stats {
                grid-template-columns: 1fr;
            }
            
            .share-filter {
                justify-content: center;
            }
        }

        /* ===== ì¶©ì „ í•„ìˆ˜ ê²½ê³  ===== */
        .charge-warning {
            background: #fff3cd;
            border-left: 8px solid #ff9800;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .charge-warning-icon {
            font-size: 2.5rem;
        }

        .charge-warning-text {
            color: #856404;
            font-weight: 700;
        }
    </style>
</head>
<body>

    <!-- í† ìŠ¤íŠ¸ -->
    <div id="toast" class="toast"></div>

    <!-- ìˆ¨ê²¨ì§„ ì˜¤ë””ì˜¤ ì—˜ë¦¬ë¨¼íŠ¸ (ì‹¤ì œ ì¬ìƒìš©) -->
    <audio id="audioPlayer" class="audio-element"></audio>

    <!-- í”Œë ˆì´ì–´ ëª¨ë‹¬ -->
    <div id="playerModal" class="player-modal">
        <div class="player-content">
            <div class="player-title" id="playerTitle">Now Playing</div>
            <div class="player-artist" id="playerArtist">Artist</div>
            
            <div class="player-copyright" id="playerCopyright">
                <strong>ğŸ“‹ TL3 íŒŒì¼ ì •ë³´</strong><br>
                <span id="copyrightOwner">ì €ì‘ê¶Œì: </span><br>
                <span id="contractType">ê³„ì•½ ìœ í˜•: </span><br>
                <span id="miningRight">ì±„êµ´ê¶Œ: </span>
            </div>
            
            <div class="player-tl-info">
                <div style="color: #666; margin-bottom: 10px;">â³ ì¶©ì „ëœ TL (ì¬ìƒ ê°€ëŠ¥ ì‹œê°„)</div>
                <div class="player-tl-amount" id="playerTL">0 TL</div>
                <div style="color: #999; font-size: 13px; margin-top: 8px;" id="playerTimeRemaining">ì•½ 0ë¶„ 0ì´ˆ ë‚¨ìŒ</div>
            </div>
            
            <div class="player-progress">
                <div class="player-progress-fill" id="playerProgress"></div>
            </div>
            
            <div class="player-time">
                <span id="playerCurrentTime">0:00</span>
                <span id="playerTotalTime">0:00</span>
            </div>
            
            <div class="player-controls">
                <button class="btn btn-primary" onclick="togglePlayPause()" id="playPauseBtn">â¸ï¸ ì¼ì‹œì •ì§€</button>
                <button class="btn btn-secondary" onclick="closePlayer()">â¹ï¸ ì¬ìƒ ì¢…ë£Œ</button>
                <button class="btn btn-warning" onclick="openChargeModal()" style="background: var(--warning); color: white;">ğŸ’° TL ì¶©ì „</button>
            </div>
        </div>
    </div>

    <!-- ===== TL3 íŒŒì¼ ì¶©ì „ ëª¨ë‹¬ ===== -->
    <div id="chargeModal" class="charge-modal">
        <div class="charge-content">
            <h2 style="margin-bottom: 30px; background: var(--primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">ğŸ’° TL3 íŒŒì¼ ì¶©ì „</h2>
            <div class="form-group">
                <label>ì¶©ì „í•  TL ì–‘ (1ì´ˆ = 1TL)</label>
                <input type="number" id="chargeAmount" placeholder="1000" min="100" step="100" style="width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 15px; font-size: 16px;">
                <p style="color: #666; font-size: 14px; margin-top: 10px;">
                    í˜„ì¬ ë‚´ ì§€ê°‘: <strong id="currentTLBalance">0</strong> TL<br>
                    1,000 TL ì¶©ì „ ì‹œ ì•½ 16ë¶„ 40ì´ˆ ì¬ìƒ ê°€ëŠ¥
                </p>
            </div>
            <div style="display: flex; gap: 15px;">
                <button class="btn btn-primary" onclick="chargeFile()" style="flex: 1;">âš¡ ì¶©ì „í•˜ê¸°</button>
                <button class="btn btn-secondary" onclick="closeChargeModal()" style="flex: 1;">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <!-- ===== ë¡œê·¸ì¸/íšŒì›ê°€ì… ===== -->
    <div id="authContainer" class="auth-container">
        <div class="auth-box">
            <div class="logo">
                <h1>â° TimeLink</h1>
                <p>TL3 íŒŒì¼ - ì¶©ì „í•´ì•¼ ì¬ìƒ ê°€ëŠ¥!</p>
            </div>
            <div class="version-badge">
                ğŸš€ v20.0 - TL3 íŒŒì¼ = ë¬´ì¡°ê±´ TL ì¶©ì „ í›„ ì¬ìƒ! (ë¯¸ë¦¬ë“£ê¸° ì—†ìŒ)
            </div>
            
            <div id="signupForm">
                <div class="form-group">
                    <label>ì‚¬ìš©ìëª…</label>
                    <input type="text" id="signupUsername" placeholder="ì˜ˆ: timelink_creator">
                </div>
                <div class="form-group">
                    <label>ì´ë©”ì¼</label>
                    <input type="email" id="signupEmail" placeholder="email@example.com">
                </div>
                <div class="form-group">
                    <label>ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="signupPassword" placeholder="6ì ì´ìƒ">
                </div>
                <div class="form-group">
                    <label>íšŒì› ìœ í˜•</label>
                    <select id="signupUserType">
                        <option value="individual">ê°œì¸ í¬ë¦¬ì—ì´í„°</option>
                        <option value="business">ì‚¬ì—…ì (ìƒì—…ë°©ì†¡ ì‹ ì²­ ê°€ëŠ¥)</option>
                    </select>
                </div>
                <div class="form-group" id="businessNumberGroup" style="display: none;">
                    <label>ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸</label>
                    <input type="text" id="businessNumber" placeholder="000-00-00000">
                </div>
                <button class="btn btn-primary" onclick="signup()">ğŸš€ íšŒì›ê°€ì… (10,000 TL ì§€ê¸‰)</button>
                <button class="btn btn-secondary" onclick="showLogin()">ğŸ” ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”?</button>
            </div>
            
            <div id="loginForm" style="display: none;">
                <div class="form-group">
                    <label>ì´ë©”ì¼</label>
                    <input type="email" id="loginEmail" placeholder="email@example.com">
                </div>
                <div class="form-group">
                    <label>ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸">
                </div>
                <button class="btn btn-primary" onclick="login()">ğŸ” ë¡œê·¸ì¸</button>
                <button class="btn btn-secondary" onclick="showSignup()">ğŸ“ ê³„ì • ë§Œë“¤ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ===== ë©”ì¸ ì•± ===== -->
    <div id="appContainer" class="app-container">
        <!-- í—¤ë” -->
        <div class="app-header">
            <div class="header-left">
                <h1>â° TimeLink</h1>
            </div>
            <div class="header-right">
                <div class="balance-card">
                    <div class="label">ğŸ’° ë‚´ ì§€ê°‘</div>
                    <div class="amount" id="tlBalance">0</div>
                </div>
                <div class="balance-card">
                    <div class="label">ğŸª™ ë³´ìœ  TLC</div>
                    <div class="amount" id="tlcBalance">0.00</div>
                </div>
                <div class="balance-card">
                    <div class="label">ğŸ“Š ê¸°ì—¬ì§€ìˆ˜</div>
                    <div class="amount" id="contributionIndex">1.00</div>
                </div>
                <div class="user-profile">
                    <div class="avatar-circle" id="userAvatar">U</div>
                    <div>
                        <div style="font-weight: 700;" id="currentUsername">User</div>
                        <div style="font-size: 12px; color: #666;" id="userStatus">ì¼ë°˜ íšŒì›</div>
                    </div>
                </div>
                <button class="btn-logout" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </div>

        <!-- ===== íƒ­ ë„¤ë¹„ê²Œì´ì…˜ ===== -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</div>
            <div class="tab" onclick="switchTab('upload')">ğŸ“¤ TL3 ìƒì„±</div>
            <div class="tab" onclick="switchTab('library')">ğŸµ ë‚´ TL3 íŒŒì¼</div>
            <div class="tab" onclick="switchTab('shareplace')">ğŸ”„ ê³µìœ  í”Œë ˆì´ìŠ¤</div>
            <div class="tab" onclick="switchTab('radio')">ğŸ“» ë¼ë””ì˜¤</div>
            <div class="tab" onclick="switchTab('commercial')">ğŸ“º ìƒì—…ë°©ì†¡</div>
            <div class="tab" onclick="switchTab('charge')">ğŸ’° ì§€ê°‘ ì¶©ì „</div>
            <div class="tab" onclick="switchTab('mining')">â›ï¸ TLC ì±„êµ´</div>
            <div class="tab" onclick="switchTab('car')">ğŸš— ì°¨ëŸ‰</div>
            <div class="tab" onclick="switchTab('gold')">ğŸ† ê¸ˆë¦¬ì €ë¸Œ</div>
            <div class="tab" onclick="switchTab('ton')">â¬¡ TON TLC</div>
        </div>

        <!-- ===== 1. ëŒ€ì‹œë³´ë“œ ===== -->
        <div id="tabDashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="icon">ğŸ’°</div>
                    <div class="label">ë‚´ ì§€ê°‘</div>
                    <div class="value" id="dashTL">0</div>
                </div>
                <div class="stat-card">
                    <div class="icon">ğŸª™</div>
                    <div class="label">ë³´ìœ  TLC</div>
                    <div class="value" id="dashTLC">0.00</div>
                </div>
                <div class="stat-card">
                    <div class="icon">ğŸ“Š</div>
                    <div class="label">ê¸°ì—¬ì§€ìˆ˜</div>
                    <div class="value" id="dashIndex">1.00</div>
                </div>
                <div class="stat-card">
                    <div class="icon">â›ï¸</div>
                    <div class="label">ì±„êµ´ í•œë„</div>
                    <div class="value" id="dashMiningLimit">0 TL</div>
                </div>
            </div>
            
            <!-- TL3 íŒŒì¼ í•„ìˆ˜ ì¶©ì „ ì•ˆë‚´ -->
            <div class="charge-warning">
                <div class="charge-warning-icon">âš ï¸</div>
                <div class="charge-warning-text">
                    <h3 style="color: #856404; margin-bottom: 5px;">TL3 íŒŒì¼ = ì¶©ì „ í•„ìˆ˜!</h3>
                    <p style="color: #856404;">ì¬ìƒí•˜ë ¤ë©´ ë°˜ë“œì‹œ TLì„ ì¶©ì „í•´ì•¼ í•©ë‹ˆë‹¤. ì¶©ì „ ì—†ì´ëŠ” ì¬ìƒ ë²„íŠ¼ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.</p>
                </div>
            </div>
            
            <!-- TL3 íŒŒì¼ ì„¤ëª… -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 20px; color: white; margin-bottom: 30px;">
                <h2 style="color: white; margin-bottom: 20px;">ğŸµ TL3 íŒŒì¼ì´ë€?</h2>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; text-align: center;">
                    <div>
                        <div style="font-size: 2.5rem;">ğŸµ</div>
                        <div style="font-weight: 700;">ìŒì›</div>
                        <div style="font-size: 0.9rem; color: #ffd700;">MP3/WAV íŒŒì¼</div>
                    </div>
                    <div>
                        <div style="font-size: 2.5rem;">â±ï¸</div>
                        <div style="font-weight: 700;">ì‹œê°„</div>
                        <div style="font-size: 0.9rem; color: #ffd700;">ì¶©ì „ëœ TL = ì¬ìƒ ì‹œê°„</div>
                        <div style="font-size: 0.8rem; color: #ffd700; margin-top: 5px;">(1ì´ˆ = 1TL)</div>
                    </div>
                    <div>
                        <div style="font-size: 2.5rem;">ğŸ“‹</div>
                        <div style="font-weight: 700;">ì €ì‘ê¶Œ</div>
                        <div style="font-size: 0.9rem; color: #ffd700;">ì†Œìœ ì/ê³„ì•½/ì±„êµ´ê¶Œ</div>
                    </div>
                </div>
                <div style="margin-top: 30px; background: rgba(255,255,255,0.2); padding: 20px; border-radius: 15px; text-align: center;">
                    <p style="color: white; font-weight: 700; font-size: 1.2rem;">
                        âš¡ TLì´ 0ì¸ íŒŒì¼ì€ ì¬ìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤! ë°˜ë“œì‹œ ì¶©ì „ í›„ ì¬ìƒí•˜ì„¸ìš”!
                    </p>
                </div>
            </div>
        </div>

        <!-- ===== 2. TL3 íŒŒì¼ ìƒì„± (ì—…ë¡œë“œ) - ë¬´ë£Œ! ===== -->
        <div id="tabUpload" class="tab-content">
            <div class="card">
                <h2>ğŸ“¤ TL3 íŒŒì¼ ìƒì„±</h2>
                <div style="background: #e8f5e9; padding: 15px; border-radius: 15px; margin-bottom: 20px;">
                    <p style="color: #2e7d32; font-weight: 700;">âœ… TL3 íŒŒì¼ ìƒì„±ì€ ë¬´ë£Œì…ë‹ˆë‹¤! ìŒì› + ì €ì‘ê¶Œ ì •ë³´ + TL ì¶©ì „</p>
                </div>
                <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
                    <div class="icon">â˜ï¸</div>
                    <h3>í´ë¦­í•˜ì—¬ ìŒì•… íŒŒì¼ ì„ íƒ</h3>
                    <p>MP3, WAV, FLAC (ìµœëŒ€ 100MB)</p>
                </div>
                <input type="file" id="fileInput" style="display: none;" accept="audio/*">
                
                <div id="uploadForm" style="display: none; margin-top: 30px;">
                    <div class="form-group">
                        <label>ê³¡ ì œëª©</label>
                        <input type="text" id="songTitle" placeholder="ë…¸ë˜ ì œëª©">
                    </div>
                    <div class="form-group">
                        <label>ì•„í‹°ìŠ¤íŠ¸</label>
                        <input type="text" id="songArtist" placeholder="ì•„í‹°ìŠ¤íŠ¸ ì´ë¦„">
                    </div>
                    <div class="form-group">
                        <label>ì¥ë¥´</label>
                        <select id="songGenre">
                            <option value="pop">íŒ</option>
                            <option value="rock">ë¡</option>
                            <option value="hiphop">í™í•©</option>
                            <option value="jazz">ì¬ì¦ˆ</option>
                            <option value="classical">í´ë˜ì‹</option>
                            <option value="electronic">ì¼ë ‰íŠ¸ë¡œë‹‰</option>
                            <option value="rnb">R&B</option>
                            <option value="ballad">ë°œë¼ë“œ</option>
                        </select>
                    </div>
                    
                    <div style="background: #f0f4ff; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                        <h3 style="margin-bottom: 15px; color: #667eea;">ğŸ“‹ ì €ì‘ê¶Œ ì •ë³´</h3>
                        <div class="form-group">
                            <label>ì €ì‘ê¶Œì</label>
                            <input type="text" id="copyrightOwner" value="" placeholder="ì €ì‘ê¶Œì ì´ë¦„">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ìµ ë¶„ë°° ê³„ì•½</label>
                            <select id="revenueShare">
                                <option value="73">7:3 ê³„ì•½ (í¬ë¦¬ì—ì´í„° 70% / í”Œë«í¼ 30%) - ì±„êµ´ê¶Œ ì—†ìŒ</option>
                                <option value="55">5:5 ê³„ì•½ (í¬ë¦¬ì—ì´í„° 50% / í”Œë«í¼ 50%) - ì±„êµ´ê¶Œ ìˆìŒ â›ï¸</option>
                            </select>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="uploadFile()">âœ¨ TL3 íŒŒì¼ ìƒì„± (ë¬´ë£Œ)</button>
                </div>
            </div>
        </div>

        <!-- ===== 3. ğŸ”¥ ë‚´ TL3 íŒŒì¼ (ë¼ì´ë¸ŒëŸ¬ë¦¬) - ì¶©ì „ í•„ìˆ˜! ===== -->
        <div id="tabLibrary" class="tab-content">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h2>ğŸµ ë‚´ TL3 íŒŒì¼</h2>
                    <div>
                        <span style="background: #4facfe; color: white; padding: 8px 16px; border-radius: 30px;">5:5 = ì±„êµ´ê°€ëŠ¥</span>
                        <span style="background: #fa709a; color: white; padding: 8px 16px; border-radius: 30px; margin-left: 10px;">7:3 = ì±„êµ´ë¶ˆê°€</span>
                    </div>
                </div>
                
                <!-- ì¶©ì „ ê²½ê³  -->
                <div style="background: #fff3cd; padding: 15px; border-radius: 15px; margin-bottom: 30px;">
                    <p style="color: #856404; font-weight: 700; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.5rem;">âš ï¸</span>
                        TLì´ 0ì¸ íŒŒì¼ì€ ì¬ìƒ ë²„íŠ¼ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤. ì¶©ì „ í›„ ì¬ìƒí•˜ì„¸ìš”!
                    </p>
                </div>
                
                <div id="fileList" class="file-list"></div>
                <div id="emptyLibrary" style="text-align: center; padding: 60px; color: #999; display: none;">
                    <div style="font-size: 4rem;">ğŸµ</div>
                    <h3>ìƒì„±í•œ TL3 íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                    <p style="margin-top: 10px;">ìŒì•… íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ TL3 íŒŒì¼ì„ ìƒì„±í•˜ì„¸ìš”!</p>
                    <button class="btn btn-primary" onclick="switchTab('upload')" style="margin-top: 20px;">ì²« TL3 íŒŒì¼ ìƒì„±</button>
                </div>
            </div>
        </div>

        <!-- ===== 4. ğŸ”¥ ê³µìœ  í”Œë ˆì´ìŠ¤ - ì¶©ì „ í•„ìˆ˜! ===== -->
        <div id="tabShareplace" class="tab-content">
            <div class="share-header">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2 style="color: white; margin-bottom: 15px;">ğŸ”„ ê³µìœ  í”Œë ˆì´ìŠ¤</h2>
                        <p style="color: rgba(255,255,255,0.9);">
                            ë‹¤ë¥¸ í¬ë¦¬ì—ì´í„°ì˜ TL3 íŒŒì¼ì„ ê°ìƒí•˜ì„¸ìš”!<br>
                            <strong>ğŸ§ ì¬ìƒ ì‹œ TL3 íŒŒì¼ì— ì¶©ì „ëœ TL ì†Œëª¨ (1ì´ˆ = 1TL)</strong>
                        </p>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px 25px; border-radius: 30px;">
                        <span id="sharedCount">0</span>ê°œ ê³µìœ ëœ TL3 íŒŒì¼
                    </div>
                </div>
                <div style="margin-top: 20px; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">
                    <p style="color: white;">ğŸ’° ë‚´ TL3 íŒŒì¼ ê³µìœ  ì‹œ <strong style="font-size: 1.3rem;">5,000 TL</strong> ì°¨ê° (ë‚´ ì§€ê°‘ â†’ í”Œë«í¼ ìˆ˜ìµ)</p>
                </div>
                <div style="margin-top: 15px; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">
                    <p style="color: white; font-weight: 700;">âš ï¸ TLì´ 0ì¸ íŒŒì¼ì€ ì¬ìƒ ë²„íŠ¼ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.</p>
                </div>
            </div>

            <div class="share-stats">
                <div class="share-stat-card">
                    <div style="color: #666;">ì „ì²´ ê³µìœ </div>
                    <div class="share-stat-value" id="totalSharedCount">0</div>
                </div>
                <div class="share-stat-card">
                    <div style="color: #666;">7:3 ê³„ì•½</div>
                    <div class="share-stat-value" id="shared73Count">0</div>
                </div>
                <div class="share-stat-card">
                    <div style="color: #666;">5:5 ê³„ì•½</div>
                    <div class="share-stat-value" id="shared55Count">0</div>
                </div>
            </div>

            <div class="share-filter">
                <button class="filter-btn active" onclick="filterSharePlace('all')">ì „ì²´</button>
                <button class="filter-btn" onclick="filterSharePlace('73')">7:3 ê³„ì•½</button>
                <button class="filter-btn" onclick="filterSharePlace('55')">5:5 ê³„ì•½</button>
                <button class="filter-btn" onclick="filterSharePlace('mining')">ì±„êµ´ ê°€ëŠ¥</button>
            </div>

            <div id="sharedMusicList" class="file-list"></div>
            <div id="emptyShared" style="text-align: center; padding: 60px; color: #999; display: none;">
                <div style="font-size: 4rem;">ğŸ”„</div>
                <h3>ê³µìœ ëœ TL3 íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤</h3>
            </div>
        </div>

        <!-- ===== 5. ë¼ë””ì˜¤ ===== -->
        <div id="tabRadio" class="tab-content">
            <div class="radio-header">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2 style="color: white; font-size: 2rem; margin-bottom: 10px;">ğŸ“» TimeLink Radio</h2>
                        <p style="color: rgba(255,255,255,0.9);">ê³µìœ  í”Œë ˆì´ìŠ¤ì˜ TL3 íŒŒì¼ 24ì‹œê°„ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°</p>
                        <p style="color: rgba(255,255,255,0.9); margin-top: 10px;">
                            <strong>ğŸ§ 1ì´ˆ ì¬ìƒ = ë‚´ ì§€ê°‘ì—ì„œ 1TL ì†Œëª¨</strong>
                        </p>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px 30px; border-radius: 40px;">
                        ğŸ”´ LIVE 24/7
                    </div>
                </div>
            </div>
            <div id="radioChannels" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px;"></div>
        </div>

        <!-- ===== 6. ìƒì—…ë°©ì†¡ ===== -->
        <div id="tabCommercial" class="tab-content">
            <div class="commercial-header">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2 style="color: white; font-size: 2rem; margin-bottom: 10px;">ğŸ“º TimeLink Commercial</h2>
                        <p style="color: rgba(255,255,255,0.9);">ì‚¬ì—…ì ë“±ë¡ í¬ë¦¬ì—ì´í„° ì „ìš©</p>
                        <p style="color: rgba(255,255,255,0.9); margin-top: 10px;">
                            <strong>ğŸ§ 1ì´ˆ ì¬ìƒ = ë‚´ ì§€ê°‘ì—ì„œ 1TL ì†Œëª¨</strong>
                        </p>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px 30px; border-radius: 40px;">
                        ğŸ’° BUSINESS ONLY
                    </div>
                </div>
            </div>
            <div id="commercialChannels" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px;"></div>
            
            <div id="businessApplySection" class="card" style="text-align: center;">
                <h3>ì‚¬ì—…ì ë“±ë¡í•˜ê¸°</h3>
                <p style="color: #666; margin: 20px 0;">ìƒì—…ë°©ì†¡ì„ ì´ìš©í•˜ë ¤ë©´ ì‚¬ì—…ì ë“±ë¡ì´ í•„ìš”í•©ë‹ˆë‹¤</p>
                <button class="btn btn-business" onclick="applyForBusiness()" style="width: auto; padding: 15px 40px;">ì‚¬ì—…ì ì‹ ì²­</button>
            </div>
        </div>

        <!-- ===== 7. ì§€ê°‘ ì¶©ì „ ===== -->
        <div id="tabCharge" class="tab-content">
            <div class="card">
                <h2>ğŸ’° ë‚´ ì§€ê°‘ ì¶©ì „</h2>
                <p style="color: #666; margin-bottom: 20px;">TL3 íŒŒì¼ì— ì¶©ì „í•  TLì„ ë‚´ ì§€ê°‘ì— ì¶”ê°€í•˜ì„¸ìš”!</p>
                <div class="charge-options">
                    <div class="charge-card" onclick="watchAd()">
                        <div class="icon">ğŸ“º</div>
                        <h3>ê´‘ê³  ì‹œì²­</h3>
                        <div class="amount">+10 TL</div>
                        <p>30ì´ˆ ê´‘ê³  ì‹œì²­</p>
                    </div>
                    <div class="charge-card" onclick="chargeTL(1000)">
                        <div class="icon">ğŸ’³</div>
                        <h3>ì†Œì•¡ ì¶©ì „</h3>
                        <div class="amount">+1,000 TL</div>
                        <p>$1.00</p>
                    </div>
                    <div class="charge-card" onclick="chargeTL(5000)">
                        <div class="icon">ğŸ</div>
                        <h3>í”„ë¦¬ë¯¸ì—„ íŒ©</h3>
                        <div class="amount">+5,000 TL</div>
                        <p>$4.00 (20% í• ì¸)</p>
                    </div>
                    <div class="charge-card" onclick="chargeTL(10000)">
                        <div class="icon">ğŸ‘‘</div>
                        <h3>VIP íŒ¨í‚¤ì§€</h3>
                        <div class="amount">+10,000 TL</div>
                        <p>$7.50 (25% í• ì¸)</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== 8. ì±„êµ´ ===== -->
        <div id="tabMining" class="tab-content">
            <div class="card">
                <h2>â›ï¸ TLC ì±„êµ´</h2>
                <div class="mining-limit-box">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 700; font-size: 1.2rem; margin-bottom: 10px;">âš ï¸ ì±„êµ´ í•œë„: ë³´ìœ  TLì˜ 50%</div>
                            <div style="font-size: 2rem; font-weight: 800; color: #ff9800;" id="miningLimitAmount">0 / 0 TL</div>
                        </div>
                        <div>
                            <div style="color: #666; margin-bottom: 5px;">ë‚´ ê¸°ì—¬ì§€ìˆ˜</div>
                            <div style="font-size: 2rem; font-weight: 800; color: #667eea;" id="miningIndexDisplay">1.00</div>
                        </div>
                    </div>
                    <div class="mining-progress">
                        <div class="mining-progress-fill" id="miningProgressFill" style="width: 0%;"></div>
                    </div>
                </div>
                <div id="miningPermissionCheck" style="background: #fff3cd; padding: 20px; border-radius: 15px; margin: 30px 0;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <span style="font-size: 2rem;">â›ï¸</span>
                        <div>
                            <span style="font-weight: 700; color: #856404;" id="miningPermissionMessage">ì±„êµ´ê¶Œ í™•ì¸ì¤‘...</span>
                            <p style="color: #856404; font-size: 14px; margin-top: 5px;" id="miningPermissionDetail">
                                * 5:5 ê³„ì•½ TL3 íŒŒì¼ì„ ë³´ìœ í•´ì•¼ ì±„êµ´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                            </p>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 30px;">
                    <div class="form-group">
                        <label>ì±„êµ´í•  TL ì–‘ (ìµœëŒ€ <span id="maxMiningLabel">0</span> TL)</label>
                        <input type="number" id="miningAmount" placeholder="500" min="1" style="font-size: 18px; padding: 20px; width: 100%;">
                    </div>
                    <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin: 20px 0;">
                        <h3 style="margin-bottom: 15px;">ğŸ“Š ì±„êµ´ ì˜ˆìƒëŸ‰</h3>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>íˆ¬ì… TL:</span>
                            <strong id="previewInput">0 TL</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>ê¸°ì—¬ì§€ìˆ˜:</span>
                            <strong id="previewIndex">1.00x</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>íšë“ TLC:</span>
                            <strong id="previewOutput">0 TLC</strong>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="executeMining()" style="margin-top: 20px; padding: 20px; font-size: 1.2rem; width: 100%;">
                        â›ï¸ TLC ì±„êµ´ ì‹¤í–‰
                    </button>
                </div>
            </div>
        </div>

        <!-- ===== 9. ì°¨ëŸ‰ ===== -->
        <div id="tabCar" class="tab-content">
            <div class="car-contribution-box">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <div>
                        <h2 style="color: white; margin-bottom: 15px;">ğŸš— ì°¨ëŸ‰ ì²­ì·¨</h2>
                        <p style="color: rgba(255,255,255,0.9); font-size: 1.2rem;">
                            <strong style="font-size: 2.5rem;">1ë¶„ = 10 TL</strong> ê¸°ì—¬ë„ (ì¼ë°˜ì˜ 2ë°°!)
                        </p>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; text-align: center;">
                        <div style="font-size: 14px; opacity: 0.9;">ë‚´ ëˆ„ì  ìš´ì „ ì²­ì·¨</div>
                        <div style="font-size: 3rem; font-weight: 800; color: white;" id="userTotalDrivingTime">0ë¶„</div>
                    </div>
                </div>
                
                <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px; margin-bottom: 30px;">
                    <h3 style="color: white; margin-bottom: 20px;">ğŸš˜ ì°¨ëŸ‰ ë“±ë¡</h3>
                    <div style="display: flex; gap: 15px;">
                        <input type="text" id="carModel" placeholder="ì°¨ëŸ‰ ëª¨ë¸ (ì˜ˆ: Tesla Model 3)" style="flex: 2; padding: 15px; border-radius: 10px; border: none;">
                        <input type="text" id="carPlate" placeholder="ë²ˆí˜¸íŒ" style="flex: 1; padding: 15px; border-radius: 10px; border: none;">
                        <button class="btn btn-primary" onclick="registerCar()" style="background: white; color: #3498db; margin: 0; width: auto; padding: 15px 30px;">ğŸš— ë“±ë¡</button>
                    </div>
                    <div id="carList" style="margin-top: 20px; color: white;"></div>
                </div>
                
                <div style="display: flex; gap: 20px;">
                    <button class="btn btn-primary" onclick="addDrivingMinutes(10)" style="background: white; color: #3498db; flex: 1; padding: 20px; font-size: 1.2rem;">
                        ğŸš— +10ë¶„ (100 TL)
                    </button>
                    <button class="btn btn-primary" onclick="addDrivingMinutes(30)" style="background: white; color: #3498db; flex: 1; padding: 20px; font-size: 1.2rem;">
                        ğŸš— +30ë¶„ (300 TL)
                    </button>
                    <button class="btn btn-primary" onclick="addDrivingMinutes(60)" style="background: white; color: #3498db; flex: 1; padding: 20px; font-size: 1.2rem;">
                        ğŸš— +60ë¶„ (600 TL)
                    </button>
                </div>
            </div>
        </div>

        <!-- ===== 10. ê¸ˆë¦¬ì €ë¸Œ ===== -->
        <div id="tabGold" class="tab-content">
            <div class="gold-reserve-card">
                <h2 style="color: white;">ğŸ† ê¸ˆ ë‹´ë³´ ë¦¬ì €ë¸Œ</h2>
                <p style="color: rgba(255,255,255,0.95);">í”Œë«í¼ ìˆ˜ìµì˜ 10%ë¥¼ ì‹¤ë¬¼ ê¸ˆìœ¼ë¡œ êµ¬ë§¤í•˜ì—¬ ì˜êµ¬ ë³´ê´€</p>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="icon">ğŸ†</div>
                    <div class="label">ì´ ê¸ˆ ë³´ìœ ëŸ‰</div>
                    <div class="value">10.24 g</div>
                </div>
                <div class="stat-card">
                    <div class="icon">ğŸ’µ</div>
                    <div class="label">ê¸ˆ ê°€ì¹˜ (USD)</div>
                    <div class="value">$665</div>
                </div>
                <div class="stat-card">
                    <div class="icon">ğŸ“ˆ</div>
                    <div class="label">ê¸ˆ ì‹œì„¸</div>
                    <div class="value">$65/g</div>
                </div>
                <div class="stat-card">
                    <div class="icon">ğŸ”’</div>
                    <div class="label">ë‹´ë³´ ë¹„ìœ¨</div>
                    <div class="value">245%</div>
                </div>
            </div>
        </div>

        <!-- ===== 11. TON TLC ===== -->
        <div id="tabTon" class="tab-content">
            <div class="ton-card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <div>
                        <h2 style="color: white; margin-bottom: 15px;">â¬¡ TON TLC Coin</h2>
                        <p style="color: rgba(255,255,255,0.9);">TON ë¸”ë¡ì²´ì¸ ê¸°ë°˜ TLC ì½”ì¸</p>
                    </div>
                    <span class="ton-badge">TON Testnet</span>
                </div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px;">
                        <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px;">ë‚´ TLC ì”ì•¡</div>
                        <div style="font-size: 3rem; font-weight: 800;" id="tonTLCBalance">0.00</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px;">
                        <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px;">TON ì§€ê°‘</div>
                        <div style="font-size: 1rem; font-family: monospace; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 10px;" id="tonWalletAddress">
                            ì—°ê²°ë˜ì§€ ì•ŠìŒ
                        </div>
                        <button class="btn btn-primary" onclick="connectWallet()" style="margin-top: 20px; background: white; color: #0088CC; width: 100%;">
                            ğŸ”— TON ì§€ê°‘ ì—°ê²°
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ê´‘ê³  ëª¨ë‹¬ -->
    <div id="adModal" class="ad-modal">
        <div class="ad-content">
            <h2 style="margin-bottom: 30px;">ğŸ“º ê´‘ê³  ì‹œì²­ ì¤‘...</h2>
            <div class="ad-video">ğŸ¬</div>
            <div class="ad-timer" id="adTimer">30ì´ˆ</div>
            <p style="color: #666; margin-top: 20px;">ê´‘ê³  ì¢…ë£Œ ì‹œ <strong style="color: #667eea;">10 TL</strong> ë‚´ ì§€ê°‘ì— ì§€ê¸‰</p>
            <button class="btn btn-secondary" onclick="closeAdModal()" style="margin-top: 20px;">ì·¨ì†Œ</button>
        </div>
    </div>

    <script>
        // ============================================================================
        // TimeLink v20.0 - TL3 íŒŒì¼ = ë¬´ì¡°ê±´ TL ì¶©ì „ í›„ ì¬ìƒ! (ë¯¸ë¦¬ë“£ê¸° ì—†ìŒ)
        // 
        // [TL3 íŒŒì¼] = MP3/WAV ìŒì› + ì¶©ì „ëœ TL + ì €ì‘ê¶Œ ì •ë³´ + ìˆ˜ìµ ë¶„ë°° ê³„ì•½
        //
        // 1. ì—…ë¡œë“œ: ìŒì•… íŒŒì¼ ì„ íƒ + ì €ì‘ê¶Œ ì •ë³´ ì…ë ¥ â†’ TL3 íŒŒì¼ ìƒì„± (ë¬´ë£Œ, TL=0)
        // 2. ì¶©ì „: ë‚´ ì§€ê°‘ â†’ TL3 íŒŒì¼ì— TL ì¶©ì „ (1ì´ˆ = 1TL) â†’ âœ… ì¶©ì „ í›„ ì¬ìƒ ê°€ëŠ¥!
        // 3. ì¬ìƒ: TL3 íŒŒì¼ì— TLì´ ìˆì–´ì•¼ë§Œ ì¬ìƒ ë²„íŠ¼ í™œì„±í™”!
        // 4. TL=0ì¸ íŒŒì¼: ì¬ìƒ ë²„íŠ¼ ë¹„í™œì„±í™” + ë¹¨ê°„ìƒ‰ ê²½ê³  ë°°ì§€ í‘œì‹œ
        // 5. ê³µìœ : TL3 íŒŒì¼ ê³µìœ  â†’ ë‚´ ì§€ê°‘ì—ì„œ 5,000TL ì°¨ê°
        // ============================================================================

        // ===== ì „ì—­ ë³€ìˆ˜ =====
        let users = JSON.parse(localStorage.getItem('timelink_users_v20')) || [];
        let tl3Files = JSON.parse(localStorage.getItem('timelink_tl3_files_v20')) || [];
        let sharedFiles = JSON.parse(localStorage.getItem('timelink_shared_v20')) || [];
        let currentUser = null;
        let adInterval = null;
        let currentFilter = 'all';
        let radioInterval = null;
        let commercialInterval = null;
        let playInterval = null;
        let currentPlayTime = 0;
        let currentPlayTotal = 0;
        let currentPlayingFile = null;
        let currentPlayType = null;
        let currentPlayingFileId = null;
        let audioPlayer = null;

        // ===== í˜ì´ì§€ ë¡œë“œ ì‹œ ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ ì´ˆê¸°í™” =====
        document.addEventListener('DOMContentLoaded', function() {
            audioPlayer = document.getElementById('audioPlayer');
        });

        // ===== íšŒì›ê°€ì… - 10,000TL ì§€ê¸‰ =====
        function signup() {
            console.log('íšŒì›ê°€ì… ì‹œì‘');
            
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value.trim();
            const userType = document.getElementById('signupUserType').value;
            const businessNumber = document.getElementById('businessNumber')?.value || '';

            if (!username || !email || !password) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }

            if (password.length < 6) {
                alert('ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤');
                return;
            }

            if (users.find(u => u.email === email)) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤');
                return;
            }

            if (userType === 'business' && !businessNumber) {
                alert('ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }

            const newUser = {
                id: 'user_' + Date.now(),
                username: username,
                email: email,
                password: password,
                userType: userType,
                businessNumber: userType === 'business' ? businessNumber : null,
                isBusiness: userType === 'business',
                tlBalance: 10000,
                tlcBalance: 0,
                totalChargedTL: 10000,
                listenMinutes: 0,
                drivingMinutes: 0,
                contributionTL: 100,
                contributionIndex: 1.10,
                hasMiningRight: false,
                cars: [],
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('timelink_users_v20', JSON.stringify(users));
            
            currentUser = newUser;
            
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            
            document.getElementById('currentUsername').textContent = currentUser.username;
            document.getElementById('userAvatar').textContent = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('tlBalance').textContent = '10,000';
            document.getElementById('dashTL').textContent = '10,000';
            document.getElementById('contributionIndex').textContent = '1.10';
            document.getElementById('dashIndex').textContent = '1.10';
            document.getElementById('currentTLBalance').textContent = '10,000';
            
            if (currentUser.isBusiness) {
                document.getElementById('userStatus').innerHTML = 'ğŸ¢ ì‚¬ì—…ì';
                document.getElementById('userStatus').style.color = '#f5576c';
            } else {
                document.getElementById('userStatus').innerHTML = 'ğŸ‘¤ ê°œì¸';
                document.getElementById('userStatus').style.color = '#666';
            }
            
            loadLibrary();
            loadSharedMusic();
            initRadioChannels();
            initCommercialChannels();
            updateBusinessUI();
            
            alert('ğŸ‰ íšŒì›ê°€ì… ì„±ê³µ! 10,000 TLì´ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ===== ë¡œê·¸ì¸ =====
        function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value.trim();

            const user = users.find(u => u.email === email && u.password === password);

            if (!user) {
                alert('ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤');
                return;
            }

            currentUser = user;
            
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            
            document.getElementById('currentUsername').textContent = currentUser.username;
            document.getElementById('userAvatar').textContent = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('tlBalance').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('tlcBalance').textContent = currentUser.tlcBalance.toFixed(2);
            document.getElementById('contributionIndex').textContent = currentUser.contributionIndex.toFixed(2);
            document.getElementById('dashTL').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('dashTLC').textContent = currentUser.tlcBalance.toFixed(2);
            document.getElementById('dashIndex').textContent = currentUser.contributionIndex.toFixed(2);
            document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
            
            if (currentUser.isBusiness) {
                document.getElementById('userStatus').innerHTML = 'ğŸ¢ ì‚¬ì—…ì';
                document.getElementById('userStatus').style.color = '#f5576c';
            } else {
                document.getElementById('userStatus').innerHTML = 'ğŸ‘¤ ê°œì¸';
                document.getElementById('userStatus').style.color = '#666';
            }
            
            loadLibrary();
            loadSharedMusic();
            initRadioChannels();
            initCommercialChannels();
            checkMiningPermission();
            updateBusinessUI();
            
            alert(`ğŸ” í™˜ì˜í•©ë‹ˆë‹¤, ${user.username}ë‹˜!`);
        }

        // ===== ë¡œê·¸ì•„ì›ƒ =====
        function logout() {
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer.src = '';
            }
            if (radioInterval) clearInterval(radioInterval);
            if (commercialInterval) clearInterval(commercialInterval);
            currentUser = null;
            document.getElementById('authContainer').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';
        }

        // ===== ì‚¬ì—…ì ì‹ ì²­ =====
        function applyForBusiness() {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            if (currentUser.isBusiness) {
                alert('ì´ë¯¸ ì‚¬ì—…ì ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤');
                return;
            }
            
            currentUser.isBusiness = true;
            currentUser.userType = 'business';
            currentUser.businessNumber = '123-45-67890';
            
            localStorage.setItem('timelink_users_v20', JSON.stringify(users));
            
            document.getElementById('userStatus').innerHTML = 'ğŸ¢ ì‚¬ì—…ì';
            document.getElementById('userStatus').style.color = '#f5576c';
            
            alert('âœ… ì‚¬ì—…ì ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ìƒì—…ë°©ì†¡ì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            
            updateBusinessUI();
            initCommercialChannels();
        }

        // ===== ìƒì—…ë°©ì†¡ UI ì—…ë°ì´íŠ¸ =====
        function updateBusinessUI() {
            const businessApplySection = document.getElementById('businessApplySection');
            if (!businessApplySection) return;
            
            if (currentUser && currentUser.isBusiness) {
                businessApplySection.style.display = 'none';
            } else {
                businessApplySection.style.display = 'block';
            }
        }

        // ===== ê¸°ì—¬ë„ ì—…ë°ì´íŠ¸ =====
        function updateContribution() {
            if (!currentUser) return;
            
            const chargeContribution = Math.floor(currentUser.totalChargedTL / 100);
            const listenContribution = (currentUser.listenMinutes || 0) * 5;
            const drivingContribution = (currentUser.drivingMinutes || 0) * 10;
            
            currentUser.contributionTL = chargeContribution + listenContribution + drivingContribution;
            currentUser.contributionIndex = 1 + (currentUser.contributionTL / 1000);
            currentUser.contributionIndex = Math.round(currentUser.contributionIndex * 100) / 100;
            
            localStorage.setItem('timelink_users_v20', JSON.stringify(users));
            
            document.getElementById('contributionIndex').textContent = currentUser.contributionIndex.toFixed(2);
            document.getElementById('dashIndex').textContent = currentUser.contributionIndex.toFixed(2);
            document.getElementById('miningIndexDisplay').textContent = currentUser.contributionIndex.toFixed(2);
        }

        // ===== ê´‘ê³  ì‹œì²­ =====
        function watchAd() {
            if (!currentUser) return;
            
            document.getElementById('adModal').style.display = 'flex';
            let seconds = 30;
            document.getElementById('adTimer').textContent = seconds + 'ì´ˆ';
            
            adInterval = setInterval(() => {
                seconds--;
                document.getElementById('adTimer').textContent = seconds + 'ì´ˆ';
                
                if (seconds <= 0) {
                    clearInterval(adInterval);
                    
                    currentUser.tlBalance += 10;
                    currentUser.totalChargedTL += 10;
                    updateContribution();
                    
                    document.getElementById('adModal').style.display = 'none';
                    document.getElementById('tlBalance').textContent = currentUser.tlBalance.toLocaleString();
                    document.getElementById('dashTL').textContent = currentUser.tlBalance.toLocaleString();
                    document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
                    
                    alert('âœ… 10 TL ì§€ê¸‰ ì™„ë£Œ!');
                }
            }, 1000);
        }

        // ===== TL ì¶©ì „ (ë‚´ ì§€ê°‘) =====
        function chargeTL(amount) {
            if (!currentUser) return;
            
            currentUser.tlBalance += amount;
            currentUser.totalChargedTL += amount;
            updateContribution();
            
            document.getElementById('tlBalance').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('dashTL').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
            
            alert(`âœ… ${amount.toLocaleString()} TL ì§€ê°‘ ì¶©ì „ ì™„ë£Œ!`);
        }

        // ===== TL3 íŒŒì¼ ìƒì„± (ì—…ë¡œë“œ) - ë¬´ë£Œ! =====
        let selectedFile = null;
        let selectedFileData = null;
        
        document.getElementById('fileInput')?.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            selectedFile = file;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                selectedFileData = e.target.result;
                document.getElementById('uploadForm').style.display = 'block';
                document.getElementById('songTitle').value = file.name.replace(/\.[^/.]+$/, "");
                document.getElementById('songArtist').value = currentUser?.username || 'ì•„í‹°ìŠ¤íŠ¸';
                document.getElementById('copyrightOwner').value = currentUser?.username || '';
            };
            reader.readAsDataURL(file);
        });

        function uploadFile() {
            if (!selectedFile || !selectedFileData) {
                alert('íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”');
                return;
            }
            
            if (!currentUser) return;
            
            const title = document.getElementById('songTitle').value;
            const artist = document.getElementById('songArtist').value || currentUser.username;
            const genre = document.getElementById('songGenre').value;
            const revenueShare = document.getElementById('revenueShare').value;
            const copyrightOwner = document.getElementById('copyrightOwner').value || currentUser.username;
            
            if (!title) {
                alert('ê³¡ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }
            
            // âœ… TL3 íŒŒì¼ ìƒì„± - ì´ˆê¸° TL = 0 (ì¶©ì „ í•„ìš”!)
            const newTL3File = {
                id: 'tl3_' + Date.now(),
                title: title,
                artist: artist,
                genre: genre,
                fileName: selectedFile.name,
                fileType: selectedFile.type,
                fileData: selectedFileData,
                fileSize: selectedFile.size,
                revenueShare: revenueShare,
                miningAllowed: revenueShare === '55',
                remainingTL: 0, // âš¡ ì´ˆê¸° TL = 0 (ì¶©ì „ í•„ìˆ˜!)
                totalTL: 0,
                creatorId: currentUser.id,
                creatorName: currentUser.username,
                copyrightOwner: copyrightOwner,
                contractType: revenueShare === '55' ? '5:5 ê³„ì•½' : '7:3 ê³„ì•½',
                createdAt: new Date().toISOString(),
                playCount: 0
            };
            
            tl3Files.push(newTL3File);
            localStorage.setItem('timelink_tl3_files_v20', JSON.stringify(tl3Files));
            
            alert('âœ… TL3 íŒŒì¼ ìƒì„± ì™„ë£Œ! (ë¬´ë£Œ)');
            alert('âš ï¸ ì´ ìŒì•…ì„ ì¬ìƒí•˜ë ¤ë©´ TLì„ ì¶©ì „í•´ì•¼ í•©ë‹ˆë‹¤! ì¶©ì „ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.');
            
            document.getElementById('uploadForm').style.display = 'none';
            selectedFile = null;
            selectedFileData = null;
            
            loadLibrary();
            checkMiningPermission();
        }

        // ===== ğŸ”¥ ë‚´ TL3 íŒŒì¼ ë¡œë“œ - ì¶©ì „ ì—¬ë¶€ì— ë”°ë¼ ì¬ìƒ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™” =====
        function loadLibrary() {
            const container = document.getElementById('fileList');
            const emptyMsg = document.getElementById('emptyLibrary');
            
            if (!container || !currentUser) return;
            
            const myFiles = tl3Files.filter(f => f.creatorId === currentUser.id);
            
            if (myFiles.length === 0) {
                container.innerHTML = '';
                if (emptyMsg) emptyMsg.style.display = 'block';
                return;
            }
            
            if (emptyMsg) emptyMsg.style.display = 'none';
            
            container.innerHTML = myFiles.map(file => {
                const percent = file.totalTL > 0 ? (file.remainingTL / file.totalTL) * 100 : 0;
                const playableMinutes = Math.floor(file.remainingTL / 60);
                const playableSeconds = file.remainingTL % 60;
                const hasTL = file.remainingTL > 0;
                
                return `
                    <div class="file-card">
                        <div class="file-thumbnail">
                            ğŸµ
                            ${!hasTL ? 
                                `<span class="no-tl-badge" style="position: absolute; top: 15px; right: 15px;">âš ï¸ ì¶©ì „ í•„ìš”</span>` : 
                                `<span class="tl3-badge" style="position: absolute; top: 15px; right: 15px; background: ${file.revenueShare === '55' ? '#4facfe' : '#fa709a'};">
                                    ${file.revenueShare === '55' ? '5:5 ì±„êµ´ê°€ëŠ¥' : '7:3 ì±„êµ´ë¶ˆê°€'}
                                </span>`
                            }
                        </div>
                        <div class="file-info">
                            <div class="file-name">${file.title}</div>
                            <div class="file-artist">${file.artist}</div>
                            
                            <div class="copyright-info">
                                <strong>ğŸ“‹ ì €ì‘ê¶Œ ì •ë³´</strong><br>
                                ì €ì‘ê¶Œì: ${file.copyrightOwner}<br>
                                ê³„ì•½: ${file.contractType}<br>
                                ì±„êµ´ê¶Œ: ${file.miningAllowed ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ'}
                            </div>
                            
                            <div class="file-stats">
                                <span>â±ï¸ ì¶©ì „ëœ TL</span>
                                <span style="font-weight: 700; color: ${hasTL ? (file.remainingTL < 60 ? '#ff9800' : '#667eea') : '#f43f5e'};">${file.remainingTL} TL</span>
                            </div>
                            <div class="file-stats">
                                <span>ğŸ§ ì¬ìƒ ê°€ëŠ¥ ì‹œê°„</span>
                                <span>${hasTL ? `${playableMinutes}ë¶„ ${playableSeconds}ì´ˆ` : '0ë¶„ 0ì´ˆ (ì¶©ì „ í•„ìš”)'}</span>
                            </div>
                            
                            <div class="tl-progress">
                                ${hasTL ? 
                                    `<div class="tl-progress-fill" style="width: ${percent}%;"></div>` : 
                                    `<div class="tl-progress-empty" style="width: 100%;"></div>`
                                }
                            </div>
                            
                            <div class="file-actions">
                                ${hasTL ? 
                                    `<button class="btn-play" onclick="playMyMusic('${file.id}')">
                                        â–¶ï¸ ì¬ìƒ (1ì´ˆ = 1TL)
                                    </button>` : 
                                    `<button class="btn-play-disabled" disabled>
                                        âŒ ì¶©ì „ í•„ìš”
                                    </button>`
                                }
                                <button class="btn-charge" onclick="openChargeModal('${file.id}')">
                                    âš¡ TL ì¶©ì „
                                </button>
                                <button class="btn-share" onclick="shareToPlace('${file.id}')" style="grid-column: span 2;">
                                    ğŸ”„ ê³µìœ  (5,000TL)
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ===== ì¶©ì „ ëª¨ë‹¬ ì—´ê¸° =====
        function openChargeModal(fileId) {
            currentPlayingFileId = fileId;
            document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('chargeModal').style.display = 'flex';
        }

        // ===== ì¶©ì „ ëª¨ë‹¬ ë‹«ê¸° =====
        function closeChargeModal() {
            document.getElementById('chargeModal').style.display = 'none';
            document.getElementById('chargeAmount').value = '';
            currentPlayingFileId = null;
        }

        // ===== TL3 íŒŒì¼ì— TL ì¶©ì „ - ì¶©ì „ í›„ ì¬ìƒ ë²„íŠ¼ í™œì„±í™”! =====
        function chargeFile() {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            const amount = parseInt(document.getElementById('chargeAmount').value);
            if (!amount || amount <= 0) {
                alert('ì˜¬ë°”ë¥¸ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }
            
            if (!currentPlayingFileId) {
                alert('íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”');
                return;
            }
            
            const file = tl3Files.find(f => f.id === currentPlayingFileId);
            if (!file) {
                alert('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            if (currentUser.tlBalance < amount) {
                alert('ë‚´ ì§€ê°‘ì— TLì´ ë¶€ì¡±í•©ë‹ˆë‹¤');
                return;
            }
            
            // ë‚´ ì§€ê°‘ì—ì„œ TL ì°¨ê°
            currentUser.tlBalance -= amount;
            
            // TL3 íŒŒì¼ì— TL ì¶©ì „
            file.remainingTL += amount;
            file.totalTL += amount;
            
            localStorage.setItem('timelink_users_v20', JSON.stringify(users));
            localStorage.setItem('timelink_tl3_files_v20', JSON.stringify(tl3Files));
            
            document.getElementById('tlBalance').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('dashTL').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
            
            // ì¶©ì „ ì™„ë£Œ í›„ íŒì—… ì¦‰ì‹œ ì¢…ë£Œ!
            closeChargeModal();
            
            // ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒˆë¡œê³ ì¹¨ (ì¬ìƒ ë²„íŠ¼ í™œì„±í™”!)
            loadLibrary();
            
            alert(`âœ… TL3 íŒŒì¼ì— ${amount} TL ì¶©ì „ ì™„ë£Œ! (${Math.floor(amount/60)}ë¶„ ${amount%60}ì´ˆ ì¬ìƒ ê°€ëŠ¥)`);
            alert(`â–¶ï¸ ì´ì œ ì¬ìƒ ë²„íŠ¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        // ===== ë‚´ TL3 íŒŒì¼ ì¬ìƒ - TLì´ ìˆì–´ì•¼ë§Œ ì‹¤í–‰ë¨ =====
        function playMyMusic(fileId) {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            const file = tl3Files.find(f => f.id === fileId);
            if (!file) {
                alert('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            // âš¡ TL ì²´í¬ - ì—†ìœ¼ë©´ ì¬ìƒ ë¶ˆê°€!
            if (file.remainingTL < 1) {
                alert(`âš ï¸ TLì´ ë¶€ì¡±í•©ë‹ˆë‹¤! ì¶©ì „ í›„ ì¬ìƒí•´ì£¼ì„¸ìš”.`);
                return;
            }
            
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer.src = '';
            }
            
            currentPlayingFile = file;
            currentPlayType = 'library';
            currentPlayTime = 0;
            currentPlayTotal = file.remainingTL;
            
            audioPlayer.src = file.fileData;
            audioPlayer.load();
            audioPlayer.play().catch(e => {
                console.log('ìë™ ì¬ìƒ ì°¨ë‹¨ë¨:', e);
                alert('ì¬ìƒì„ ì‹œì‘í•˜ë ¤ë©´ í™”ë©´ì„ í´ë¦­í•˜ì„¸ìš”');
            });
            
            document.getElementById('playerTitle').textContent = file.title;
            document.getElementById('playerArtist').textContent = file.artist;
            document.getElementById('copyrightOwner').innerHTML = `<strong>ì €ì‘ê¶Œì:</strong> ${file.copyrightOwner}`;
            document.getElementById('contractType').innerHTML = `<strong>ê³„ì•½ ìœ í˜•:</strong> ${file.contractType}`;
            document.getElementById('miningRight').innerHTML = `<strong>ì±„êµ´ê¶Œ:</strong> ${file.miningAllowed ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ'}`;
            document.getElementById('playerTL').textContent = file.remainingTL + ' TL';
            document.getElementById('playerTimeRemaining').textContent = `ì•½ ${Math.floor(file.remainingTL / 60)}ë¶„ ${file.remainingTL % 60}ì´ˆ ë‚¨ìŒ`;
            document.getElementById('playerCurrentTime').textContent = '0:00';
            document.getElementById('playerTotalTime').textContent = formatTime(file.remainingTL);
            document.getElementById('playerProgress').style.width = '0%';
            document.getElementById('playPauseBtn').innerHTML = 'â¸ï¸ ì¼ì‹œì •ì§€';
            document.getElementById('playerModal').style.display = 'flex';
            
            playInterval = setInterval(() => {
                if (!currentPlayingFile || !audioPlayer) {
                    clearInterval(playInterval);
                    return;
                }
                
                currentPlayingFile.remainingTL -= 1;
                currentPlayTime++;
                
                document.getElementById('playerTL').textContent = currentPlayingFile.remainingTL + ' TL';
                document.getElementById('playerTimeRemaining').textContent = `ì•½ ${Math.floor(currentPlayingFile.remainingTL / 60)}ë¶„ ${currentPlayingFile.remainingTL % 60}ì´ˆ ë‚¨ìŒ`;
                document.getElementById('playerCurrentTime').textContent = formatTime(currentPlayTime);
                
                const progressPercent = (currentPlayTime / currentPlayTotal) * 100;
                document.getElementById('playerProgress').style.width = Math.min(progressPercent, 100) + '%';
                
                if (currentPlayTime % 5 === 0) {
                    currentUser.listenMinutes = (currentUser.listenMinutes || 0) + 0.0833;
                    updateContribution();
                }
                
                localStorage.setItem('timelink_tl3_files_v20', JSON.stringify(tl3Files));
                
                if (currentPlayingFile.remainingTL <= 0 || currentPlayTime >= currentPlayTotal) {
                    closePlayer();
                    alert(`ğŸµ ${currentPlayingFile.title} ì¬ìƒ ì™„ë£Œ! (${currentPlayTime}ì´ˆ ì†Œëª¨)`);
                }
            }, 1000);
            
            audioPlayer.onended = function() {
                closePlayer();
            };
        }

        // ===== ì¬ìƒ/ì¼ì‹œì •ì§€ í† ê¸€ =====
        function togglePlayPause() {
            if (!audioPlayer) return;
            
            if (audioPlayer.paused) {
                audioPlayer.play();
                document.getElementById('playPauseBtn').innerHTML = 'â¸ï¸ ì¼ì‹œì •ì§€';
            } else {
                audioPlayer.pause();
                document.getElementById('playPauseBtn').innerHTML = 'â–¶ï¸ ì¬ìƒ';
            }
        }

        // ===== í”Œë ˆì´ì–´ ë‹«ê¸° =====
        function closePlayer() {
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer.src = '';
            }
            currentPlayingFile = null;
            currentPlayType = null;
            currentPlayTime = 0;
            currentPlayingFileId = null;
            document.getElementById('playerModal').style.display = 'none';
            
            loadLibrary();
        }

        // ===== ê³µìœ  í”Œë ˆì´ìŠ¤ì— TL3 íŒŒì¼ ê³µìœ  - 5,000 TL ì°¨ê° =====
        function shareToPlace(fileId) {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            const file = tl3Files.find(f => f.id === fileId);
            if (!file) {
                alert('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            if (sharedFiles.some(f => f.originalId === file.id)) {
                alert('ì´ë¯¸ ê³µìœ ëœ TL3 íŒŒì¼ì…ë‹ˆë‹¤');
                return;
            }
            
            if (currentUser.tlBalance < 5000) {
                alert(`âŒ ë‚´ ì§€ê°‘ì— TLì´ ë¶€ì¡±í•©ë‹ˆë‹¤! ê³µìœ í•˜ë ¤ë©´ 5,000 TLì´ í•„ìš”í•©ë‹ˆë‹¤. (í˜„ì¬: ${currentUser.tlBalance} TL)`);
                return;
            }
            
            currentUser.tlBalance -= 5000;
            document.getElementById('tlBalance').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('dashTL').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
            
            const sharedFile = {
                id: 'shared_' + Date.now(),
                originalId: file.id,
                title: file.title,
                artist: file.artist,
                genre: file.genre,
                creatorId: file.creatorId,
                creatorName: file.creatorName,
                copyrightOwner: file.copyrightOwner,
                revenueShare: file.revenueShare,
                miningAllowed: file.miningAllowed,
                contractType: file.contractType,
                sharedAt: new Date().toISOString(),
                playCount: 0
            };
            
            sharedFiles.push(sharedFile);
            localStorage.setItem('timelink_shared_v20', JSON.stringify(sharedFiles));
            localStorage.setItem('timelink_users_v20', JSON.stringify(users));
            
            alert(`ğŸ”„ ê³µìœ  í”Œë ˆì´ìŠ¤ì— ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤!\nğŸ’° ë‚´ ì§€ê°‘ì—ì„œ 5,000 TL ì°¨ê° ì™„ë£Œ!`);
            
            loadSharedMusic();
        }

        // ===== ğŸ”¥ ê³µìœ  í”Œë ˆì´ìŠ¤ TL3 íŒŒì¼ ë¡œë“œ - ì¶©ì „ ì—¬ë¶€ì— ë”°ë¼ ì¬ìƒ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™” =====
        function loadSharedMusic() {
            const container = document.getElementById('sharedMusicList');
            const emptyMsg = document.getElementById('emptyShared');
            const totalCount = document.getElementById('totalSharedCount');
            const count73 = document.getElementById('shared73Count');
            const count55 = document.getElementById('shared55Count');
            const sharedCount = document.getElementById('sharedCount');
            
            if (!container || !currentUser) return;
            
            const otherSharedFiles = sharedFiles.filter(f => f.creatorId !== currentUser.id);
            
            if (totalCount) totalCount.textContent = otherSharedFiles.length;
            if (count73) count73.textContent = otherSharedFiles.filter(f => f.revenueShare === '73').length;
            if (count55) count55.textContent = otherSharedFiles.filter(f => f.revenueShare === '55').length;
            if (sharedCount) sharedCount.textContent = otherSharedFiles.length;
            
            if (otherSharedFiles.length === 0) {
                container.innerHTML = '';
                if (emptyMsg) emptyMsg.style.display = 'block';
                return;
            }
            
            if (emptyMsg) emptyMsg.style.display = 'none';
            
            let filteredFiles = otherSharedFiles;
            if (currentFilter === '73') {
                filteredFiles = otherSharedFiles.filter(f => f.revenueShare === '73');
            } else if (currentFilter === '55') {
                filteredFiles = otherSharedFiles.filter(f => f.revenueShare === '55');
            } else if (currentFilter === 'mining') {
                filteredFiles = otherSharedFiles.filter(f => f.miningAllowed === true);
            }
            
            container.innerHTML = filteredFiles.map(file => {
                const originalFile = tl3Files.find(f => f.id === file.originalId);
                const remainingTL = originalFile?.remainingTL || 0;
                const playableMinutes = Math.floor(remainingTL / 60);
                const playableSeconds = remainingTL % 60;
                const hasTL = remainingTL > 0;
                
                return `
                    <div class="file-card">
                        <div class="file-thumbnail">ğŸµ</div>
                        <div class="file-info">
                            <div class="file-name">${file.title}</div>
                            <div class="file-artist">${file.artist}</div>
                            
                            <div class="copyright-info">
                                <strong>ğŸ“‹ ì €ì‘ê¶Œ ì •ë³´</strong><br>
                                ì €ì‘ê¶Œì: ${file.copyrightOwner}<br>
                                ê³„ì•½: ${file.contractType}<br>
                                ì±„êµ´ê¶Œ: ${file.miningAllowed ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ'}
                            </div>
                            
                            <div class="file-stats">
                                <span>â±ï¸ ì¶©ì „ëœ TL</span>
                                <span style="font-weight: 700; color: ${hasTL ? (remainingTL < 60 ? '#ff9800' : '#667eea') : '#f43f5e'};">${remainingTL} TL</span>
                            </div>
                            <div class="file-stats">
                                <span>ğŸ§ ì¬ìƒ ê°€ëŠ¥ ì‹œê°„</span>
                                <span>${hasTL ? `${playableMinutes}ë¶„ ${playableSeconds}ì´ˆ` : '0ë¶„ 0ì´ˆ (ì¶©ì „ í•„ìš”)'}</span>
                            </div>
                            <div style="color: #666; font-size: 13px; margin-bottom: 15px;">
                                ğŸ‘¤ ê³µìœ : ${file.creatorName} Â· ì²­ì·¨ ${file.playCount || 0}íšŒ
                            </div>
                            
                            ${hasTL ? 
                                `<button class="btn-play" onclick="playSharedMusic('${file.id}')" style="width: 100%;">
                                    ğŸ§ ì¬ìƒ (1ì´ˆ = 1TL)
                                </button>` : 
                                `<button class="btn-play-disabled" disabled style="width: 100%;">
                                    âŒ ì¶©ì „ í•„ìš” (í¬ë¦¬ì—ì´í„°ê°€ ì¶©ì „í•´ì•¼ í•¨)
                                </button>`
                            }
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ===== ê³µìœ  TL3 íŒŒì¼ ì¬ìƒ - TLì´ ìˆì–´ì•¼ë§Œ ì‹¤í–‰ë¨ =====
        function playSharedMusic(sharedId) {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            const sharedFile = sharedFiles.find(f => f.id === sharedId);
            if (!sharedFile) {
                alert('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            const originalFile = tl3Files.find(f => f.id === sharedFile.originalId);
            if (!originalFile) {
                alert('ì›ë³¸ TL3 íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            // âš¡ TL ì²´í¬ - ì—†ìœ¼ë©´ ì¬ìƒ ë¶ˆê°€!
            if (originalFile.remainingTL < 1) {
                alert(`âš ï¸ ì´ TL3 íŒŒì¼ì— TLì´ ë¶€ì¡±í•©ë‹ˆë‹¤! í¬ë¦¬ì—ì´í„°ê°€ ì¶©ì „í•´ì•¼ í•©ë‹ˆë‹¤.`);
                return;
            }
            
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer.src = '';
            }
            
            currentPlayingFile = originalFile;
            currentPlayType = 'shared';
            currentPlayTime = 0;
            currentPlayTotal = originalFile.remainingTL;
            
            audioPlayer.src = originalFile.fileData;
            audioPlayer.load();
            audioPlayer.play().catch(e => {
                console.log('ìë™ ì¬ìƒ ì°¨ë‹¨ë¨:', e);
            });
            
            document.getElementById('playerTitle').textContent = originalFile.title;
            document.getElementById('playerArtist').textContent = originalFile.artist;
            document.getElementById('copyrightOwner').innerHTML = `<strong>ì €ì‘ê¶Œì:</strong> ${originalFile.copyrightOwner}`;
            document.getElementById('contractType').innerHTML = `<strong>ê³„ì•½ ìœ í˜•:</strong> ${originalFile.contractType}`;
            document.getElementById('miningRight').innerHTML = `<strong>ì±„êµ´ê¶Œ:</strong> ${originalFile.miningAllowed ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ'}`;
            document.getElementById('playerTL').textContent = originalFile.remainingTL + ' TL';
            document.getElementById('playerTimeRemaining').textContent = `ì•½ ${Math.floor(originalFile.remainingTL / 60)}ë¶„ ${originalFile.remainingTL % 60}ì´ˆ ë‚¨ìŒ`;
            document.getElementById('playerCurrentTime').textContent = '0:00';
            document.getElementById('playerTotalTime').textContent = formatTime(originalFile.remainingTL);
            document.getElementById('playerProgress').style.width = '0%';
            document.getElementById('playPauseBtn').innerHTML = 'â¸ï¸ ì¼ì‹œì •ì§€';
            document.getElementById('playerModal').style.display = 'flex';
            
            playInterval = setInterval(() => {
                if (!currentPlayingFile || !audioPlayer) {
                    clearInterval(playInterval);
                    return;
                }
                
                currentPlayingFile.remainingTL -= 1;
                currentPlayTime++;
                
                document.getElementById('playerTL').textContent = currentPlayingFile.remainingTL + ' TL';
                document.getElementById('playerTimeRemaining').textContent = `ì•½ ${Math.floor(currentPlayingFile.remainingTL / 60)}ë¶„ ${currentPlayingFile.remainingTL % 60}ì´ˆ ë‚¨ìŒ`;
                document.getElementById('playerCurrentTime').textContent = formatTime(currentPlayTime);
                
                const progressPercent = (currentPlayTime / currentPlayTotal) * 100;
                document.getElementById('playerProgress').style.width = Math.min(progressPercent, 100) + '%';
                
                if (currentPlayTime % 10 === 0) {
                    sharedFile.playCount = (sharedFile.playCount || 0) + 1;
                    localStorage.setItem('timelink_shared_v20', JSON.stringify(sharedFiles));
                }
                
                if (currentPlayTime % 5 === 0) {
                    currentUser.listenMinutes = (currentUser.listenMinutes || 0) + 0.0833;
                    updateContribution();
                }
                
                localStorage.setItem('timelink_tl3_files_v20', JSON.stringify(tl3Files));
                
                if (currentPlayingFile.remainingTL <= 0 || currentPlayTime >= currentPlayTotal) {
                    closePlayer();
                    alert(`ğŸµ ${currentPlayingFile.title} ì¬ìƒ ì™„ë£Œ! (${currentPlayTime}ì´ˆ ì†Œëª¨)`);
                }
            }, 1000);
            
            audioPlayer.onended = function() {
                closePlayer();
            };
        }

        // ===== ê³µìœ  í”Œë ˆì´ìŠ¤ í•„í„° =====
        function filterSharePlace(filter) {
            currentFilter = filter;
            
            const btns = document.querySelectorAll('.filter-btn');
            btns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            loadSharedMusic();
        }

        // ===== ë¼ë””ì˜¤ ì±„ë„ ì´ˆê¸°í™” =====
        function initRadioChannels() {
            const container = document.getElementById('radioChannels');
            if (!container) return;
            
            const channels = [
                { name: 'TimeLink Pop', genre: 'pop', freq: '107.7', listeners: 1234 },
                { name: 'TimeLink Rock', genre: 'rock', freq: '107.9', listeners: 892 },
                { name: 'TimeLink Hip-Hop', genre: 'hiphop', freq: '108.1', listeners: 1567 },
                { name: 'TimeLink Jazz', genre: 'jazz', freq: '108.3', listeners: 645 },
                { name: 'TimeLink Classical', genre: 'classical', freq: '108.5', listeners: 423 },
                { name: 'TimeLink Electronic', genre: 'electronic', freq: '108.7', listeners: 987 }
            ];
            
            container.innerHTML = channels.map(ch => `
                <div class="radio-channel-card">
                    <div class="channel-header">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="color: white;">${ch.name}</h3>
                            <span style="background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 30px;">
                                ğŸ‘¥ ${ch.listeners}ëª… ì²­ì·¨ì¤‘
                            </span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span>FM ${ch.freq} MHz</span>
                            <span>ğŸ”´ LIVE</span>
                        </div>
                    </div>
                    <div class="channel-playlist">
                        <div class="now-playing" id="radio-${ch.genre}-now">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 700; font-size: 1.1rem;" id="radio-${ch.genre}-title">Now Loading...</div>
                                    <div style="color: #666; margin-top: 5px;" id="radio-${ch.genre}-artist"></div>
                                </div>
                                <span style="color: #1db954;">ğŸµ ì¬ìƒì¤‘</span>
                            </div>
                        </div>
                        <button class="btn-play" onclick="playRadio('${ch.genre}')" style="width: 100%;">
                            ğŸ§ ë¼ë””ì˜¤ ì¬ìƒ (1ì´ˆ = ë‚´ TL 1TL ì†Œëª¨)
                        </button>
                    </div>
                </div>
            `).join('');
            
            startRadioStreaming();
        }

        // ===== ë¼ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë° ì‹œì‘ =====
        function startRadioStreaming() {
            if (radioInterval) clearInterval(radioInterval);
            
            radioInterval = setInterval(() => {
                const sharedSongs = sharedFiles.filter(f => f.creatorId !== currentUser?.id);
                
                if (sharedSongs.length > 0) {
                    const genres = ['pop', 'rock', 'hiphop', 'jazz', 'classical', 'electronic'];
                    
                    genres.forEach(genre => {
                        const genreSongs = sharedSongs.filter(s => {
                            return s.genre === genre;
                        });
                        
                        if (genreSongs.length > 0) {
                            const randomSong = genreSongs[Math.floor(Math.random() * genreSongs.length)];
                            const titleEl = document.getElementById(`radio-${genre}-title`);
                            const artistEl = document.getElementById(`radio-${genre}-artist`);
                            
                            if (titleEl) titleEl.textContent = randomSong.title;
                            if (artistEl) artistEl.textContent = randomSong.artist;
                        }
                    });
                }
            }, 10000);
        }

        // ===== ë¼ë””ì˜¤ ì¬ìƒ =====
        function playRadio(genre) {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            if (currentUser.tlBalance < 1) {
                alert(`âš ï¸ ë‚´ ì§€ê°‘ì— TLì´ ë¶€ì¡±í•©ë‹ˆë‹¤! ì¶©ì „ì´ í•„ìš”í•©ë‹ˆë‹¤. (ë³´ìœ : ${currentUser.tlBalance} TL)`);
                return;
            }
            
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer.src = '';
            }
            
            currentPlayType = 'radio';
            currentPlayTime = 0;
            currentPlayTotal = Math.min(currentUser.tlBalance, 3600);
            
            const titleEl = document.getElementById(`radio-${genre}-title`);
            const artistEl = document.getElementById(`radio-${genre}-artist`);
            const currentTitle = titleEl ? titleEl.textContent : 'TimeLink Radio';
            const currentArtist = artistEl ? artistEl.textContent : 'Various Artists';
            
            document.getElementById('playerTitle').textContent = currentTitle;
            document.getElementById('playerArtist').textContent = currentArtist;
            document.getElementById('copyrightOwner').innerHTML = '<strong>ì €ì‘ê¶Œì:</strong> TimeLink Radio';
            document.getElementById('contractType').innerHTML = '<strong>ê³„ì•½ ìœ í˜•:</strong> ë¼ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë°';
            document.getElementById('miningRight').innerHTML = '<strong>ì±„êµ´ê¶Œ:</strong> í•´ë‹¹ ì—†ìŒ';
            document.getElementById('playerTL').textContent = currentUser.tlBalance + ' TL';
            document.getElementById('playerTimeRemaining').textContent = `ì•½ ${Math.floor(currentUser.tlBalance / 60)}ë¶„ ${currentUser.tlBalance % 60}ì´ˆ ë‚¨ìŒ`;
            document.getElementById('playerCurrentTime').textContent = '0:00';
            document.getElementById('playerTotalTime').textContent = formatTime(currentPlayTotal);
            document.getElementById('playerProgress').style.width = '0%';
            document.getElementById('playPauseBtn').innerHTML = 'â¸ï¸ ì¼ì‹œì •ì§€';
            document.getElementById('playerModal').style.display = 'flex';
            
            playInterval = setInterval(() => {
                if (!currentUser) {
                    clearInterval(playInterval);
                    return;
                }
                
                currentUser.tlBalance -= 1;
                currentPlayTime++;
                
                document.getElementById('playerTL').textContent = currentUser.tlBalance + ' TL';
                document.getElementById('playerTimeRemaining').textContent = `ì•½ ${Math.floor(currentUser.tlBalance / 60)}ë¶„ ${currentUser.tlBalance % 60}ì´ˆ ë‚¨ìŒ`;
                document.getElementById('playerCurrentTime').textContent = formatTime(currentPlayTime);
                document.getElementById('tlBalance').textContent = currentUser.tlBalance.toLocaleString();
                document.getElementById('dashTL').textContent = currentUser.tlBalance.toLocaleString();
                document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
                
                const progressPercent = (currentPlayTime / currentPlayTotal) * 100;
                document.getElementById('playerProgress').style.width = Math.min(progressPercent, 100) + '%';
                
                if (currentPlayTime % 5 === 0) {
                    currentUser.listenMinutes = (currentUser.listenMinutes || 0) + 0.0833;
                    updateContribution();
                }
                
                localStorage.setItem('timelink_users_v20', JSON.stringify(users));
                
                if (currentUser.tlBalance <= 0 || currentPlayTime >= currentPlayTotal) {
                    closePlayer();
                    alert(`ğŸ“» ë¼ë””ì˜¤ ì¬ìƒ ì™„ë£Œ! (${currentPlayTime}ì´ˆ ì†Œëª¨)`);
                }
            }, 1000);
        }

        // ===== ìƒì—…ë°©ì†¡ ì±„ë„ ì´ˆê¸°í™” =====
        function initCommercialChannels() {
            const container = document.getElementById('commercialChannels');
            if (!container) return;
            
            const channels = [
                { name: 'TimeLink Business 1', freq: '109.1', listeners: 567, revenue: 12340 },
                { name: 'TimeLink Business 2', freq: '109.3', listeners: 432, revenue: 9870 },
                { name: 'TimeLink Business 3', freq: '109.5', listeners: 345, revenue: 7650 }
            ];
            
            container.innerHTML = channels.map(ch => `
                <div class="commercial-channel-card">
                    <div class="commercial-channel-header">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="color: white;">${ch.name}</h3>
                            <span class="business-badge">ğŸ¢ BUSINESS</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span>FM ${ch.freq} MHz</span>
                            <span>ğŸ‘¥ ${ch.listeners}ëª… ì²­ì·¨ì¤‘</span>
                        </div>
                    </div>
                    <div class="channel-playlist">
                        <div class="now-playing" style="border-left-color: #f5576c;" id="commercial-${ch.freq}-now">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 700; font-size: 1.1rem;" id="commercial-${ch.freq}-title">Now Playing...</div>
                                    <div style="color: #666; margin-top: 5px;" id="commercial-${ch.freq}-artist"></div>
                                </div>
                                <span style="color: #f5576c;">ğŸ“º ê´‘ê³  ì§€ì›</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <span style="background: #f8f9fa; padding: 8px 16px; border-radius: 30px; font-size: 13px;">
                                ğŸ’° í¬ë¦¬ì—ì´í„° ìˆ˜ìµ: ${ch.revenue} TL
                            </span>
                        </div>
                        <button class="btn-business-play" onclick="playCommercial('${ch.freq}')" style="width: 100%;">
                            ğŸ§ ìƒì—…ë°©ì†¡ ì¬ìƒ (1ì´ˆ = ë‚´ TL 1TL ì†Œëª¨)
                        </button>
                    </div>
                </div>
            `).join('');
            
            startCommercialStreaming();
        }

        // ===== ìƒì—…ë°©ì†¡ ìŠ¤íŠ¸ë¦¬ë° ì‹œì‘ =====
        function startCommercialStreaming() {
            if (commercialInterval) clearInterval(commercialInterval);
            
            commercialInterval = setInterval(() => {
                const sharedSongs = sharedFiles.filter(f => f.creatorId !== currentUser?.id);
                
                if (sharedSongs.length > 0) {
                    const freqs = ['109.1', '109.3', '109.5'];
                    
                    freqs.forEach(freq => {
                        const randomSong = sharedSongs[Math.floor(Math.random() * sharedSongs.length)];
                        const titleEl = document.getElementById(`commercial-${freq}-title`);
                        const artistEl = document.getElementById(`commercial-${freq}-artist`);
                        
                        if (titleEl) titleEl.textContent = randomSong.title;
                        if (artistEl) artistEl.textContent = randomSong.artist;
                    });
                }
            }, 15000);
        }

        // ===== ìƒì—…ë°©ì†¡ ì¬ìƒ =====
        function playCommercial(freq) {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            if (!currentUser.isBusiness) {
                alert('ğŸ“º ìƒì—…ë°©ì†¡ì€ ì‚¬ì—…ì ë“±ë¡ í¬ë¦¬ì—ì´í„°ë§Œ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤');
                return;
            }
            
            if (currentUser.tlBalance < 1) {
                alert(`âš ï¸ ë‚´ ì§€ê°‘ì— TLì´ ë¶€ì¡±í•©ë‹ˆë‹¤! ì¶©ì „ì´ í•„ìš”í•©ë‹ˆë‹¤. (ë³´ìœ : ${currentUser.tlBalance} TL)`);
                return;
            }
            
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer.src = '';
            }
            
            currentPlayType = 'commercial';
            currentPlayTime = 0;
            currentPlayTotal = Math.min(currentUser.tlBalance, 3600);
            
            const titleEl = document.getElementById(`commercial-${freq}-title`);
            const artistEl = document.getElementById(`commercial-${freq}-artist`);
            const currentTitle = titleEl ? titleEl.textContent : 'TimeLink Commercial';
            const currentArtist = artistEl ? artistEl.textContent : 'Various Artists';
            
            document.getElementById('playerTitle').textContent = currentTitle;
            document.getElementById('playerArtist').textContent = currentArtist;
            document.getElementById('copyrightOwner').innerHTML = '<strong>ì €ì‘ê¶Œì:</strong> TimeLink Commercial';
            document.getElementById('contractType').innerHTML = '<strong>ê³„ì•½ ìœ í˜•:</strong> ìƒì—…ë°©ì†¡';
            document.getElementById('miningRight').innerHTML = '<strong>ì±„êµ´ê¶Œ:</strong> í•´ë‹¹ ì—†ìŒ';
            document.getElementById('playerTL').textContent = currentUser.tlBalance + ' TL';
            document.getElementById('playerTimeRemaining').textContent = `ì•½ ${Math.floor(currentUser.tlBalance / 60)}ë¶„ ${currentUser.tlBalance % 60}ì´ˆ ë‚¨ìŒ`;
            document.getElementById('playerCurrentTime').textContent = '0:00';
            document.getElementById('playerTotalTime').textContent = formatTime(currentPlayTotal);
            document.getElementById('playerProgress').style.width = '0%';
            document.getElementById('playPauseBtn').innerHTML = 'â¸ï¸ ì¼ì‹œì •ì§€';
            document.getElementById('playerModal').style.display = 'flex';
            
            playInterval = setInterval(() => {
                if (!currentUser) {
                    clearInterval(playInterval);
                    return;
                }
                
                currentUser.tlBalance -= 1;
                currentPlayTime++;
                
                document.getElementById('playerTL').textContent = currentUser.tlBalance + ' TL';
                document.getElementById('playerTimeRemaining').textContent = `ì•½ ${Math.floor(currentUser.tlBalance / 60)}ë¶„ ${currentUser.tlBalance % 60}ì´ˆ ë‚¨ìŒ`;
                document.getElementById('playerCurrentTime').textContent = formatTime(currentPlayTime);
                document.getElementById('tlBalance').textContent = currentUser.tlBalance.toLocaleString();
                document.getElementById('dashTL').textContent = currentUser.tlBalance.toLocaleString();
                document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
                
                const progressPercent = (currentPlayTime / currentPlayTotal) * 100;
                document.getElementById('playerProgress').style.width = Math.min(progressPercent, 100) + '%';
                
                if (currentPlayTime % 5 === 0) {
                    currentUser.listenMinutes = (currentUser.listenMinutes || 0) + 0.0833;
                    updateContribution();
                }
                
                localStorage.setItem('timelink_users_v20', JSON.stringify(users));
                
                if (currentUser.tlBalance <= 0 || currentPlayTime >= currentPlayTotal) {
                    closePlayer();
                    alert(`ğŸ“º ìƒì—…ë°©ì†¡ ì¬ìƒ ì™„ë£Œ! (${currentPlayTime}ì´ˆ ì†Œëª¨)`);
                }
            }, 1000);
        }

        // ===== ì‹œê°„ í¬ë§· =====
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // ===== ì±„êµ´ê¶Œ í™•ì¸ =====
        function checkMiningPermission() {
            if (!currentUser) return false;
            
            const has55Contract = tl3Files.some(f => f.creatorId === currentUser.id && f.revenueShare === '55');
            currentUser.hasMiningRight = has55Contract;
            
            const msg = document.getElementById('miningPermissionMessage');
            if (msg) {
                msg.innerHTML = has55Contract ? 
                    'âœ… ì±„êµ´ê¶Œ ìˆìŠµë‹ˆë‹¤! (5:5 ê³„ì•½ TL3 íŒŒì¼ ë³´ìœ ì¤‘)' : 
                    'â›” ì±„êµ´ê¶Œ ì—†ìŠµë‹ˆë‹¤ (5:5 ê³„ì•½ìœ¼ë¡œ TL3 íŒŒì¼ ìƒì„± í•„ìš”)';
                msg.style.color = has55Contract ? '#10b981' : '#856404';
            }
            
            return has55Contract;
        }

        // ===== ì±„êµ´ ì‹¤í–‰ =====
        function executeMining() {
            if (!currentUser) return;
            
            if (!checkMiningPermission()) {
                alert('â›” ì±„êµ´ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. 5:5 ê³„ì•½ìœ¼ë¡œ TL3 íŒŒì¼ì„ ìƒì„±í•˜ì„¸ìš”');
                return;
            }
            
            const amount = parseInt(document.getElementById('miningAmount').value) || 0;
            
            if (!amount || amount <= 0) {
                alert('ì±„êµ´í•  TL ì–‘ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }
            
            if (amount > currentUser.tlBalance) {
                alert('ë‚´ ì§€ê°‘ì— TLì´ ë¶€ì¡±í•©ë‹ˆë‹¤');
                return;
            }
            
            const maxMining = Math.floor(currentUser.tlBalance * 0.5);
            if (amount > maxMining) {
                alert(`ì±„êµ´ í•œë„ëŠ” ë³´ìœ  TLì˜ 50% (${maxMining} TL)ì…ë‹ˆë‹¤`);
                return;
            }
            
            const tlcAmount = amount * 0.1 * currentUser.contributionIndex;
            
            currentUser.tlBalance -= amount;
            currentUser.tlcBalance += tlcAmount;
            
            localStorage.setItem('timelink_users_v20', JSON.stringify(users));
            
            document.getElementById('tlBalance').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('tlcBalance').textContent = currentUser.tlcBalance.toFixed(2);
            document.getElementById('dashTL').textContent = currentUser.tlBalance.toLocaleString();
            document.getElementById('dashTLC').textContent = currentUser.tlcBalance.toFixed(2);
            document.getElementById('miningLimitAmount').textContent = Math.floor(currentUser.tlBalance * 0.5) + ' / ' + currentUser.tlBalance + ' TL';
            document.getElementById('currentTLBalance').textContent = currentUser.tlBalance.toLocaleString();
            
            alert(`âœ… ì±„êµ´ ì„±ê³µ! ${tlcAmount.toFixed(2)} TLC íšë“! (ê¸°ì—¬ì§€ìˆ˜ ${currentUser.contributionIndex}x)`);
        }

        // ===== ì±„êµ´ ë¯¸ë¦¬ë³´ê¸° =====
        document.addEventListener('input', function(e) {
            if (e.target.id === 'miningAmount') {
                updateMiningPreview();
            }
        });

        function updateMiningPreview() {
            if (!currentUser) return;
            
            const amount = parseInt(document.getElementById('miningAmount')?.value) || 0;
            const maxMining = Math.floor(currentUser.tlBalance * 0.5);
            
            if (amount > 0 && amount <= maxMining) {
                const tlcAmount = amount * 0.1 * currentUser.contributionIndex;
                
                document.getElementById('previewInput').textContent = amount.toLocaleString() + ' TL';
                document.getElementById('previewIndex').textContent = currentUser.contributionIndex.toFixed(2) + 'x';
                document.getElementById('previewOutput').textContent = tlcAmount.toFixed(2) + ' TLC';
            } else {
                document.getElementById('previewInput').textContent = '0 TL';
                document.getElementById('previewOutput').textContent = '0 TLC';
            }
        }

        // ===== ì°¨ëŸ‰ ë“±ë¡ =====
        function registerCar() {
            if (!currentUser) return;
            
            const model = document.getElementById('carModel').value;
            const plate = document.getElementById('carPlate').value;
            
            if (!model) {
                alert('ì°¨ëŸ‰ ëª¨ë¸ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }
            
            if (!currentUser.cars) currentUser.cars = [];
            
            currentUser.cars.push({
                model: model,
                plate: plate || 'ë¯¸ë“±ë¡',
                registeredAt: new Date().toISOString()
            });
            
            localStorage.setItem('timelink_users_v20', JSON.stringify(users));
            
            alert('ğŸš— ì°¨ëŸ‰ ë“±ë¡ ì™„ë£Œ! (ìš´ì „ ì²­ì·¨ 2ë°° ê¸°ì—¬ë„)');
            
            const carList = document.getElementById('carList');
            if (carList) {
                carList.innerHTML = currentUser.cars.map(car => 
                    `<p style="color: white; margin: 5px 0;">ğŸš˜ ${car.model} (${car.plate})</p>`
                ).join('');
            }
            
            document.getElementById('userTotalDrivingTime').textContent = (currentUser.drivingMinutes || 0) + 'ë¶„';
        }

        // ===== ì°¨ëŸ‰ ì²­ì·¨ =====
        function addDrivingMinutes(minutes) {
            if (!currentUser) return;
            
            if (!currentUser.cars || currentUser.cars.length === 0) {
                alert('ì°¨ëŸ‰ì„ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”');
                return;
            }
            
            currentUser.drivingMinutes = (currentUser.drivingMinutes || 0) + minutes;
            updateContribution();
            
            document.getElementById('userTotalDrivingTime').textContent = currentUser.drivingMinutes + 'ë¶„';
            
            alert(`ğŸš— ìš´ì „ ì²­ì·¨ ${minutes}ë¶„ ì™„ë£Œ! (+${minutes * 10} TL ê¸°ì—¬ë„)`);
        }

        // ===== TON ì§€ê°‘ ì—°ê²° =====
        function connectWallet() {
            alert('TON ì§€ê°‘ ì—°ê²° ê¸°ëŠ¥ì€ í…ŒìŠ¤íŠ¸ë„·ì—ì„œ ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤');
            document.getElementById('tonWalletAddress').innerHTML = 'EQD...x5Lp7vK (í…ŒìŠ¤íŠ¸ ì§€ê°‘)';
        }

        // ===== ê´‘ê³  ëª¨ë‹¬ ë‹«ê¸° =====
        function closeAdModal() {
            if (adInterval) clearInterval(adInterval);
            document.getElementById('adModal').style.display = 'none';
        }

        // ===== íƒ­ ì „í™˜ =====
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).classList.add('active');
            
            if (tabName === 'library') loadLibrary();
            if (tabName === 'shareplace') loadSharedMusic();
            if (tabName === 'radio') initRadioChannels();
            if (tabName === 'commercial') {
                initCommercialChannels();
                updateBusinessUI();
            }
            if (tabName === 'mining') {
                checkMiningPermission();
                const maxMining = currentUser ? Math.floor(currentUser.tlBalance * 0.5) : 0;
                document.getElementById('miningLimitAmount').textContent = maxMining + ' / ' + (currentUser?.tlBalance || 0) + ' TL';
                document.getElementById('maxMiningLabel').textContent = maxMining;
                document.getElementById('miningIndexDisplay').textContent = currentUser?.contributionIndex.toFixed(2) || '1.00';
            }
            if (tabName === 'car') {
                if (currentUser) {
                    document.getElementById('userTotalDrivingTime').textContent = (currentUser.drivingMinutes || 0) + 'ë¶„';
                }
            }
        }

        // ===== í™”ë©´ ì „í™˜ =====
        function showSignup() {
            document.getElementById('signupForm').style.display = 'block';
            document.getElementById('loginForm').style.display = 'none';
        }

        function showLogin() {
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
        }

        // ===== ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸ ì…ë ¥ í•„ë“œ í‘œì‹œ =====
        document.getElementById('signupUserType')?.addEventListener('change', function(e) {
            const businessGroup = document.getElementById('businessNumberGroup');
            if (businessGroup) {
                businessGroup.style.display = e.target.value === 'business' ? 'block' : 'none';
            }
        });

        // ===== í˜ì´ì§€ ë¡œë“œ =====
        window.onload = function() {
            console.log('ğŸš€ TimeLink v20.0 - TL3 íŒŒì¼ = ë¬´ì¡°ê±´ TL ì¶©ì „ í›„ ì¬ìƒ!');
            
            audioPlayer = document.getElementById('audioPlayer');
            
            if (users.length === 0) {
                const testUser1 = {
                    id: 'user_test_1',
                    username: 'ì•„ë¯¸',
                    email: 'army@test.com',
                    password: '123456',
                    userType: 'business',
                    isBusiness: true,
                    businessNumber: '123-45-67890',
                    tlBalance: 25000,
                    tlcBalance: 1250.75,
                    totalChargedTL: 30000,
                    listenMinutes: 450,
                    drivingMinutes: 120,
                    contributionTL: 3750,
                    contributionIndex: 4.75,
                    hasMiningRight: true,
                    cars: [{ model: 'Hyundai Ioniq 5', plate: '123ê°€ 4567' }],
                    createdAt: new Date().toISOString()
                };
                
                const testUser2 = {
                    id: 'user_test_2',
                    username: 'ì£¼ê°„ì•„ì´ëŒ',
                    email: 'weekly@test.com',
                    password: '123456',
                    userType: 'individual',
                    isBusiness: false,
                    businessNumber: null,
                    tlBalance: 18500,
                    tlcBalance: 890.25,
                    totalChargedTL: 20000,
                    listenMinutes: 320,
                    drivingMinutes: 85,
                    contributionTL: 2650,
                    contributionIndex: 3.65,
                    hasMiningRight: false,
                    cars: [{ model: 'Tesla Model 3', plate: '567ë‚˜ 8901' }],
                    createdAt: new Date().toISOString()
                };
                
                users.push(testUser1, testUser2);
                localStorage.setItem('timelink_users_v20', JSON.stringify(users));
            }
            
            if (tl3Files.length === 0 && users.length >= 2) {
                const dummyAudioData = 'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAA8AAAGQAApCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJD/+5REAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA';
                
                tl3Files.push({
                    id: 'tl3_1',
                    title: 'Dynamite - BTS',
                    artist: 'BTS',
                    genre: 'pop',
                    fileName: 'dynamite.mp3',
                    fileType: 'audio/mp3',
                    fileData: dummyAudioData,
                    fileSize: 1024,
                    revenueShare: '55',
                    miningAllowed: true,
                    remainingTL: 5000,
                    totalTL: 5000,
                    creatorId: users[0].id,
                    creatorName: users[0].username,
                    copyrightOwner: users[0].username,
                    contractType: '5:5 ê³„ì•½',
                    createdAt: new Date().toISOString(),
                    playCount: 1240
                });
                
                tl3Files.push({
                    id: 'tl3_2',
                    title: 'Butter - BTS',
                    artist: 'BTS',
                    genre: 'pop',
                    fileName: 'butter.mp3',
                    fileType: 'audio/mp3',
                    fileData: dummyAudioData,
                    fileSize: 1024,
                    revenueShare: '55',
                    miningAllowed: true,
                    remainingTL: 0, // âš¡ TLì´ 0ì¸ íŒŒì¼ (ì¶©ì „ í•„ìš”!)
                    totalTL: 0,
                    creatorId: users[0].id,
                    creatorName: users[0].username,
                    copyrightOwner: users[0].username,
                    contractType: '5:5 ê³„ì•½',
                    createdAt: new Date().toISOString(),
                    playCount: 0
                });
                
                tl3Files.push({
                    id: 'tl3_3',
                    title: 'Blinding Lights - The Weeknd',
                    artist: 'The Weeknd',
                    genre: 'pop',
                    fileName: 'blinding_lights.mp3',
                    fileType: 'audio/mp3',
                    fileData: dummyAudioData,
                    fileSize: 1024,
                    revenueShare: '73',
                    miningAllowed: false,
                    remainingTL: 2000,
                    totalTL: 2000,
                    creatorId: users[1].id,
                    creatorName: users[1].username,
                    copyrightOwner: users[1].username,
                    contractType: '7:3 ê³„ì•½',
                    createdAt: new Date().toISOString(),
                    playCount: 2340
                });
                
                localStorage.setItem('timelink_tl3_files_v20', JSON.stringify(tl3Files));
            }
            
            if (sharedFiles.length === 0 && users.length >= 2 && tl3Files.length >= 3) {
                sharedFiles.push({
                    id: 'shared_1',
                    originalId: tl3Files[0].id,
                    title: tl3Files[0].title,
                    artist: tl3Files[0].artist,
                    genre: tl3Files[0].genre,
                    creatorId: tl3Files[0].creatorId,
                    creatorName: tl3Files[0].creatorName,
                    copyrightOwner: tl3Files[0].copyrightOwner,
                    revenueShare: tl3Files[0].revenueShare,
                    miningAllowed: tl3Files[0].miningAllowed,
                    contractType: tl3Files[0].contractType,
                    sharedAt: new Date().toISOString(),
                    playCount: 1240
                });
                
                sharedFiles.push({
                    id: 'shared_2',
                    originalId: tl3Files[1].id,
                    title: tl3Files[1].title,
                    artist: tl3Files[1].artist,
                    genre: tl3Files[1].genre,
                    creatorId: tl3Files[1].creatorId,
                    creatorName: tl3Files[1].creatorName,
                    copyrightOwner: tl3Files[1].copyrightOwner,
                    revenueShare: tl3Files[1].revenueShare,
                    miningAllowed: tl3Files[1].miningAllowed,
                    contractType: tl3Files[1].contractType,
                    sharedAt: new Date().toISOString(),
                    playCount: 0
                });
                
                sharedFiles.push({
                    id: 'shared_3',
                    originalId: tl3Files[2].id,
                    title: tl3Files[2].title,
                    artist: tl3Files[2].artist,
                    genre: tl3Files[2].genre,
                    creatorId: tl3Files[2].creatorId,
                    creatorName: tl3Files[2].creatorName,
                    copyrightOwner: tl3Files[2].copyrightOwner,
                    revenueShare: tl3Files[2].revenueShare,
                    miningAllowed: tl3Files[2].miningAllowed,
                    contractType: tl3Files[2].contractType,
                    sharedAt: new Date().toISOString(),
                    playCount: 2340
                });
                
                localStorage.setItem('timelink_shared_v20', JSON.stringify(sharedFiles));
            }
        };
    </script>
</body>
</html>
