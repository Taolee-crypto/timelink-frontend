<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TimeLink â€” Time-Based Music Economy</title>
  <!-- íŒŒë¹„ì½˜ & PWA -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>â°</text></svg>" type="image/svg+xml">
  <link rel="manifest" href="/manifest.json">
  <!-- CDN ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/@tsparticles/all@3/tsparticles.all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tsparticles/preset-stars@3/tsparticles.preset.stars.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
  <link rel="stylesheet" href="src/css/hero.css">
  <link rel="stylesheet" href="src/css/main.css"> <!-- ë‚˜ì¤‘ì— ë¶„ë¦¬ -->
</head>
<body>
<!-- ìƒˆ íˆì–´ë¡œ ì„¹ì…˜ -->
<section class="hero-fullscreen" id="hero">
  <div class="hero-bg-gradient"></div>
  <div id="particles-js" class="hero-particle-bg"></div>
  <div class="hero-content">
    <div class="hero-badge animate-fade-in">
      <span class="badge-glow">2026 Music Economy Platform</span>
    </div>
    <h1 class="hero-title">
      <span class="text-gradient">TimeLink</span>
    </h1>
    <p class="hero-subtitle animate-slide-up">
      ì‹œê°„ì´ ê³§ ì €ì‘ê¶Œ ìˆ˜ìµì´ ë˜ëŠ” ì„¸ìƒ<br>
      AI ì¸ì¦ Â· ì‹¤ì‹œê°„ ì •ì‚° Â· ê¸ˆ ë‹´ë³´ TLC
    </p>
    <div class="hero-cta">
      <button class="hero-btn hero-btn-primary" onclick="App.switchTab('create')">
        ğŸµ ì§€ê¸ˆ TL3/TL4 ë§Œë“¤ê¸°
      </button>
      <button class="hero-btn hero-btn-secondary" onclick="App.switchTab('player')">
        ğŸ§ í”Œë ˆì´ì–´ ì²´í—˜í•˜ê¸°
      </button>
    </div>
    <div class="hero-stats glass-morph">
      <div class="hero-stat animate-float">
        <div class="hero-stat-value" id="heroFileCount">0</div>
        <div class="hero-stat-label">ì°½ì‘ íŒŒì¼</div>
      </div>
      <div class="hero-stat animate-float" style="animation-delay:0.2s">
        <div class="hero-stat-value" id="heroTlEarned">0</div>
        <div class="hero-stat-label">ëˆ„ì  TL</div>
      </div>
      <div class="hero-stat animate-float" style="animation-delay:0.4s">
        <div class="hero-stat-value" id="heroTlcMined">0.00</div>
        <div class="hero-stat-label">ì±„êµ´ëœ TLC</div>
      </div>
    </div>

  <!-- TL ì”ê³  í™•ì¸ ê¸°ëŠ¥ (ê¸°ì¡´ ì¶©ì „ ê¸°ëŠ¥ í¬í•¨) -->
<div style="margin-top: 40px; text-align: center;">
  <button id="check-balance" style="padding: 14px 32px; font-size: 18px; background: linear-gradient(135deg, #00d4ff, #7c3aed); color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 6px 20px rgba(0,212,255,0.4); margin-right: 10px;">
    TL ì”ê³  í™•ì¸í•˜ê¸°
  </button>

  <input type="number" id="charge-amount" placeholder="ì¶©ì „í•  TL ì–‘" style="padding: 12px; font-size: 16px; width: 180px; border-radius: 8px; border: 1px solid #00d4ff;">
  <button id="charge-tl" style="padding: 14px 24px; font-size: 18px; background: #22c55e; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 6px 20px rgba(34,197,94,0.4);">
    TL ì¶©ì „í•˜ê¸°
  </button>

  <div id="balance-result" style="margin-top: 24px; padding: 24px; background: linear-gradient(135deg, rgba(0,212,255,0.15), rgba(124,58,237,0.15)); border-radius: 16px; border: 1px solid rgba(0,212,255,0.4); max-width: 420px; margin-left: auto; margin-right: auto; display: none; box-shadow: 0 8px 32px rgba(0,0,0,0.3);">
    <h3 style="margin: 0 0 16px 0; color: #00d4ff; text-align: center;">í˜„ì¬ ì”ê³ </h3>
    <div style="font-size: 18px; line-height: 1.6;">
      <strong>ì‚¬ìš©ì:</strong> <span id="user-id">---</span><br>
      <strong>TL ì”ê³ :</strong> <span id="tl-balance">---</span> TL<br>
      <strong>TLC ì”ê³ :</strong> <span id="tlc-balance">---</span>
    </div>
  </div>
</div>

<!-- ìŠ¤í¬ë¦½íŠ¸ (ê¸°ì¡´ main.js ë¡œë“œ ìœ ì§€ + ìƒˆ ê¸°ëŠ¥) -->
<script src="src/js/main.js"></script>

<script>
// ì”ê³  í™•ì¸ ê¸°ëŠ¥ (showLoading = trueì¼ ë•Œ ë¡œë”© ë©”ì‹œì§€ í‘œì‹œ)
function checkBalance(showLoading = true) {
  const resultDiv = document.getElementById('balance-result');
  
  if (showLoading) {
    resultDiv.innerHTML = '<p style="color:#00d4ff; font-weight:bold;">ì”ê³  í™•ì¸ ì¤‘...</p>';
  }
  resultDiv.style.display = 'block';

  fetch('http://localhost:8000/tl/balance')
    .then(response => {
      if (!response.ok) {
        throw new Error(`ì„œë²„ ì˜¤ë¥˜: ${response.status} (${response.statusText})`);
      }
      return response.json();
    })
    .then(data => {
      resultDiv.innerHTML = `
        <strong>ì‚¬ìš©ì:</strong> ${data.user_id || 'ì•Œ ìˆ˜ ì—†ìŒ'}<br>
        <strong>TL ì”ê³ :</strong> ${data.tl_balance || '---'} TL<br>
        <strong>TLC ì”ê³ :</strong> ${data.tlc_balance || '---'}
      `;
    })
    .catch(error => {
      resultDiv.innerHTML = `<p style="color:#ff6b6b; font-weight:bold;">ì—ëŸ¬ ë°œìƒ: ${error.message}</p>
                             <small>ë°±ì—”ë“œ ì„œë²„ê°€ ì¼œì ¸ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”!</small>`;
      console.error('ì”ê³  í™•ì¸ ì‹¤íŒ¨:', error);
    });
}

// ì¶©ì „ ê¸°ëŠ¥
document.getElementById('charge-tl').addEventListener('click', async () => {
  const amountInput = document.getElementById('charge-amount');
  const amount = parseInt(amountInput.value);
  const resultDiv = document.getElementById('balance-result');

  if (!amount || amount <= 0) {
    resultDiv.innerHTML += '<br><span style="color:#ef4444; font-weight:bold;">ì¶©ì „ ê¸ˆì•¡ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”!</span>';
    return;
  }

  resultDiv.innerHTML += '<br><span style="color:#22c55e;">ì¶©ì „ ì¤‘...</span>';

  try {
    const response = await fetch(`http://localhost:8000/tl/charge?amount=${amount}`, {
      method: 'POST'
    });

    if (!response.ok) {
      throw new Error(`ì¶©ì „ ì‹¤íŒ¨: ${response.status} (${response.statusText})`);
    }

    const data = await response.json();

    resultDiv.innerHTML = `
      <strong>ì¶©ì „ ì„±ê³µ!</strong><br>
      ${data.message}<br>
      ìƒˆ ì”ê³ : ${data.new_balance} TL
    `;

    // ì¶©ì „ í›„ ìë™ ì”ê³  í™•ì¸ (ë¡œë”© ë©”ì‹œì§€ ì—†ì´)
    checkBalance(false);

    // ì…ë ¥ì°½ ì´ˆê¸°í™”
    amountInput.value = '';
  } catch (error) {
    resultDiv.innerHTML += `<br><span style="color:#ef4444;">ì—ëŸ¬: ${error.message}</span>`;
    console.error('ì¶©ì „ ì‹¤íŒ¨:', error);
  }
});

// í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì”ê³  í™•ì¸ (ìµœì´ˆ ë¡œë”© ì‹œ ì”ê³  í‘œì‹œ)
window.addEventListener('load', () => {
  checkBalance();
});
</script>
</body>
</html>
